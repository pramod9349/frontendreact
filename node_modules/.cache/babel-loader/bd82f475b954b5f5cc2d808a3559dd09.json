{"ast":null,"code":"import map from './utils/map';\nimport createZip from './utils/create-zip';\nimport IntlService from './services/intl-service';\nimport dateToSerial from './utils/time';\nvar MIME_TYPE = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\nvar DATA_URL_PREFIX = \"data:\" + MIME_TYPE + \";base64,\";\nvar DATA_URL_OPTIONS = {\n  compression: \"DEFLATE\",\n  type: \"base64\"\n};\nvar BLOB_OPTIONS = {\n  compression: \"DEFLATE\",\n  type: \"blob\"\n};\nvar ARRAYBUFFER_OPTIONS = {\n  compression: \"DEFLATE\",\n  type: \"arraybuffer\"\n};\n/* eslint-disable key-spacing, no-arrow-condition, indent, no-nested-ternary, consistent-return */\n\nfunction toDataURI(content) {\n  return DATA_URL_PREFIX + content;\n}\n\nfunction indexOf(thing, array) {\n  return array.indexOf(thing);\n}\n\nvar parseJSON = JSON.parse.bind(JSON);\n\nfunction ESC(val) {\n  return String(val).replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\\\"/g, \"&quot;\").replace(/\\'/g, \"&#39;\");\n}\n\nfunction repeat(count, func) {\n  var str = \"\";\n\n  for (var i = 0; i < count; ++i) {\n    str += func(i);\n  }\n\n  return str;\n}\n\nfunction foreach(arr, func) {\n  var str = \"\";\n\n  if (arr != null) {\n    if (Array.isArray(arr)) {\n      for (var i = 0; i < arr.length; ++i) {\n        str += func(arr[i], i);\n      }\n    } else if (typeof arr == \"object\") {\n      Object.keys(arr).forEach(function (key, i) {\n        str += func(arr[key], key, i);\n      });\n    }\n  }\n\n  return str;\n}\n\nvar XMLHEAD = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r';\nvar RELS = XMLHEAD + \"\\n            <Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n               <Relationship Id=\\\"rId3\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\\\" Target=\\\"docProps/app.xml\\\"/>\\n               <Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\\\" Target=\\\"docProps/core.xml\\\"/>\\n               <Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\\\" Target=\\\"xl/workbook.xml\\\"/>\\n            </Relationships>\";\n\nvar CORE = function (ref) {\n  var creator = ref.creator;\n  var lastModifiedBy = ref.lastModifiedBy;\n  var created = ref.created;\n  var modified = ref.modified;\n  return XMLHEAD + \"\\n <cp:coreProperties xmlns:cp=\\\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\\\"\\n   xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:dcterms=\\\"http://purl.org/dc/terms/\\\"\\n   xmlns:dcmitype=\\\"http://purl.org/dc/dcmitype/\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\n   <dc:creator>\" + ESC(creator) + \"</dc:creator>\\n   <cp:lastModifiedBy>\" + ESC(lastModifiedBy) + \"</cp:lastModifiedBy>\\n   <dcterms:created xsi:type=\\\"dcterms:W3CDTF\\\">\" + ESC(created) + \"</dcterms:created>\\n   <dcterms:modified xsi:type=\\\"dcterms:W3CDTF\\\">\" + ESC(modified) + \"</dcterms:modified>\\n</cp:coreProperties>\";\n};\n\nvar APP = function (ref) {\n  var sheets = ref.sheets;\n  return XMLHEAD + \"\\n<Properties xmlns=\\\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\\\" xmlns:vt=\\\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\\\">\\n  <Application>Microsoft Excel</Application>\\n  <DocSecurity>0</DocSecurity>\\n  <ScaleCrop>false</ScaleCrop>\\n  <HeadingPairs>\\n    <vt:vector size=\\\"2\\\" baseType=\\\"variant\\\">\\n      <vt:variant>\\n        <vt:lpstr>Worksheets</vt:lpstr>\\n      </vt:variant>\\n      <vt:variant>\\n        <vt:i4>\" + sheets.length + \"</vt:i4>\\n      </vt:variant>\\n    </vt:vector>\\n  </HeadingPairs>\\n  <TitlesOfParts>\\n    <vt:vector size=\\\"\" + sheets.length + \"\\\" baseType=\\\"lpstr\\\">\" + foreach(sheets, function (sheet, i) {\n    return sheet.options.title ? \"<vt:lpstr>\" + ESC(sheet.options.title) + \"</vt:lpstr>\" : \"<vt:lpstr>Sheet\" + (i + 1) + \"</vt:lpstr>\";\n  }) + \"</vt:vector>\\n  </TitlesOfParts>\\n  <LinksUpToDate>false</LinksUpToDate>\\n  <SharedDoc>false</SharedDoc>\\n  <HyperlinksChanged>false</HyperlinksChanged>\\n  <AppVersion>14.0300</AppVersion>\\n</Properties>\";\n};\n\nvar CONTENT_TYPES = function (ref) {\n  var sheetCount = ref.sheetCount;\n  var commentFiles = ref.commentFiles;\n  var drawingFiles = ref.drawingFiles;\n  return XMLHEAD + \"\\n<Types xmlns=\\\"http://schemas.openxmlformats.org/package/2006/content-types\\\">\\n  <Default Extension=\\\"png\\\" ContentType=\\\"image/png\\\"/>\\n  <Default Extension=\\\"gif\\\" ContentType=\\\"image/gif\\\"/>\\n  <Default Extension=\\\"jpg\\\" ContentType=\\\"image/jpeg\\\"/>\\n  <Default Extension=\\\"rels\\\" ContentType=\\\"application/vnd.openxmlformats-package.relationships+xml\\\" />\\n  <Default Extension=\\\"xml\\\" ContentType=\\\"application/xml\\\" />\\n  <Default Extension=\\\"vml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.vmlDrawing\\\"/>\\n  <Override PartName=\\\"/xl/workbook.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\\\" />\\n  <Override PartName=\\\"/xl/styles.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\\\"/>\\n  <Override PartName=\\\"/xl/sharedStrings.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\\\"/>\\n  \" + repeat(sheetCount, function (idx) {\n    return \"<Override PartName=\\\"/xl/worksheets/sheet\" + (idx + 1) + \".xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\\\" />\";\n  }) + \"\\n  \" + foreach(commentFiles, function (filename) {\n    return \"<Override PartName=\\\"/xl/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\\\"/>\";\n  }) + \"\\n  \" + foreach(drawingFiles, function (filename) {\n    return \"<Override PartName=\\\"/xl/drawings/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.drawing+xml\\\"/>\";\n  }) + \"\\n  <Override PartName=\\\"/docProps/core.xml\\\" ContentType=\\\"application/vnd.openxmlformats-package.core-properties+xml\\\" />\\n  <Override PartName=\\\"/docProps/app.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.extended-properties+xml\\\" />\\n</Types>\";\n};\n\nvar WORKBOOK = function (ref) {\n  var sheets = ref.sheets;\n  var filterNames = ref.filterNames;\n  var userNames = ref.userNames;\n  return XMLHEAD + \"\\n<workbook xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  <fileVersion appName=\\\"xl\\\" lastEdited=\\\"5\\\" lowestEdited=\\\"5\\\" rupBuild=\\\"9303\\\" />\\n  <workbookPr defaultThemeVersion=\\\"124226\\\" />\\n  <bookViews>\\n    <workbookView xWindow=\\\"240\\\" yWindow=\\\"45\\\" windowWidth=\\\"18195\\\" windowHeight=\\\"7995\\\" />\\n  </bookViews>\\n  <sheets>\\n  \" + foreach(sheets, function (ref, i) {\n    var options = ref.options;\n    var name = options.name || options.title || \"Sheet\" + (i + 1);\n    return \"<sheet name=\\\"\" + ESC(name) + \"\\\" sheetId=\\\"\" + (i + 1) + \"\\\" r:id=\\\"rId\" + (i + 1) + \"\\\" />\";\n  }) + \"\\n  </sheets>\\n  \" + (filterNames.length || userNames.length ? \"\\n    <definedNames>\\n      \" + foreach(filterNames, function (f) {\n    return \"\\n         <definedName name=\\\"_xlnm._FilterDatabase\\\" hidden=\\\"1\\\" localSheetId=\\\"\" + f.localSheetId + \"\\\">\" + ESC(quoteSheet(f.name)) + \"!\" + ESC(f.from) + \":\" + ESC(f.to) + \"</definedName>\";\n  }) + \"\\n      \" + foreach(userNames, function (f) {\n    return \"\\n         <definedName name=\\\"\" + f.name + \"\\\" hidden=\\\"\" + (f.hidden ? 1 : 0) + \"\\\" \" + (f.localSheetId != null ? \"localSheetId=\\\"\" + f.localSheetId + \"\\\"\" : '') + \">\" + ESC(f.value) + \"</definedName>\";\n  }) + \"\\n    </definedNames>\" : '') + \"\\n  <calcPr fullCalcOnLoad=\\\"1\\\" calcId=\\\"145621\\\" />\\n</workbook>\";\n};\n\nvar WORKSHEET = function (ref$1) {\n  var frozenColumns = ref$1.frozenColumns;\n  var frozenRows = ref$1.frozenRows;\n  var columns = ref$1.columns;\n  var defaults = ref$1.defaults;\n  var data = ref$1.data;\n  var index = ref$1.index;\n  var mergeCells = ref$1.mergeCells;\n  var autoFilter = ref$1.autoFilter;\n  var filter = ref$1.filter;\n  var showGridLines = ref$1.showGridLines;\n  var hyperlinks = ref$1.hyperlinks;\n  var validations = ref$1.validations;\n  var defaultCellStyleId = ref$1.defaultCellStyleId;\n  var rtl = ref$1.rtl;\n  var legacyDrawing = ref$1.legacyDrawing;\n  var drawing = ref$1.drawing;\n  var lastRow = ref$1.lastRow;\n  var lastCol = ref$1.lastCol;\n  return XMLHEAD + \"\\n<worksheet xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\" mc:Ignorable=\\\"x14ac\\\">\\n   \" + (lastRow && lastCol ? \"<dimension ref=\\\"A1:\" + ref(lastRow - 1, lastCol - 1) + \"\\\" />\" : \"\") + \"\\n\\n   <sheetViews>\\n     <sheetView \" + (rtl ? 'rightToLeft=\"1\"' : '') + \" \" + (index === 0 ? 'tabSelected=\"1\"' : '') + \" workbookViewId=\\\"0\\\" \" + (showGridLines === false ? 'showGridLines=\"0\"' : '') + \">\\n     \" + (frozenRows || frozenColumns ? \"\\n       <pane state=\\\"frozen\\\"\\n         \" + (frozenColumns ? \"xSplit=\\\"\" + frozenColumns + \"\\\"\" : '') + \"\\n         \" + (frozenRows ? \"ySplit=\\\"\" + frozenRows + \"\\\"\" : '') + \"\\n         topLeftCell=\\\"\" + (String.fromCharCode(65 + (frozenColumns || 0)) + ((frozenRows || 0) + 1)) + \"\\\"\\n       />\" : '') + \"\\n     </sheetView>\\n   </sheetViews>\\n\\n   <sheetFormatPr x14ac:dyDescent=\\\"0.25\\\" \" + (!defaults.skipCustomHeight ? 'customHeight=\"1\"' : '') + \" defaultRowHeight=\\\"\" + (defaults.rowHeight ? defaults.rowHeight * 0.75 : 15) + \"\\\"\\n     \" + (defaults.columnWidth ? \"defaultColWidth=\\\"\" + toWidth(defaults.columnWidth) + \"\\\"\" : '') + \" />\\n\\n   \" + (defaultCellStyleId != null || columns && columns.length > 0 ? \"\\n     <cols>\\n       \" + (!columns || !columns.length ? \"\\n         <col min=\\\"1\\\" max=\\\"16384\\\" style=\\\"\" + defaultCellStyleId + \"\\\"\\n              \" + (defaults.columnWidth ? \"width=\\\"\" + toWidth(defaults.columnWidth) + \"\\\"\" : '') + \" /> \" : '') + \"\\n       \" + foreach(columns, function (column, ci) {\n    var columnIndex = typeof column.index === \"number\" ? column.index + 1 : ci + 1;\n\n    if (column.width === 0) {\n      return \"<col \" + (defaultCellStyleId != null ? \"style=\\\"\" + defaultCellStyleId + \"\\\"\" : '') + \"\\n                        min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" hidden=\\\"1\\\" customWidth=\\\"1\\\" />\";\n    }\n\n    return \"<col \" + (defaultCellStyleId != null ? \"style=\\\"\" + defaultCellStyleId + \"\\\"\" : '') + \"\\n                      min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" customWidth=\\\"1\\\"\\n                      \" + (column.autoWidth ? \"width=\\\"\" + (column.width * 7 + 5) / 7 * 256 / 256 + \"\\\" bestFit=\\\"1\\\"\" : \"width=\\\"\" + toWidth(column.width) + \"\\\"\") + \" />\";\n  }) + \"\\n     </cols>\" : '') + \"\\n\\n   <sheetData>\\n     \" + foreach(data, function (row, ri) {\n    var rowIndex = typeof row.index === \"number\" ? row.index + 1 : ri + 1;\n    return \"\\n         <row r=\\\"\" + rowIndex + \"\\\" x14ac:dyDescent=\\\"0.25\\\"\\n              \" + (row.level ? \"outlineLevel=\\\"\" + row.level + \"\\\"\" : '') + \"\\n              \" + (row.height === 0 ? 'hidden=\"1\"' : row.height ? \"ht=\\\"\" + toHeight(row.height) + \"\\\" customHeight=\\\"1\\\"\" : \"\") + \">\\n           \" + foreach(row.data, function (cell) {\n      return \"\\n             <c r=\\\"\" + cell.ref + \"\\\" \" + (cell.style ? \"s=\\\"\" + cell.style + \"\\\"\" : '') + \" \" + (cell.type ? \"t=\\\"\" + cell.type + \"\\\"\" : '') + \">\\n               \" + (cell.formula != null ? writeFormula(cell.formula) : '') + \"\\n               \" + (cell.value != null ? \"<v>\" + ESC(cell.value) + \"</v>\" : '') + \"\\n             </c>\";\n    }) + \"\\n         </row>\\n       \";\n  }) + \"\\n   </sheetData>\\n\\n   \" + (autoFilter ? \"<autoFilter ref=\\\"\" + autoFilter.from + \":\" + autoFilter.to + \"\\\"/>\" : filter ? spreadsheetFilters(filter) : '') + \"\\n\\n   \" + (mergeCells.length ? \"\\n     <mergeCells count=\\\"\" + mergeCells.length + \"\\\">\\n       \" + foreach(mergeCells, function (ref) {\n    return \"<mergeCell ref=\\\"\" + ref + \"\\\"/>\";\n  }) + \"\\n     </mergeCells>\" : '') + \"\\n\\n   \" + (validations.length ? \"\\n     <dataValidations>\\n       \" + foreach(validations, function (val) {\n    return \"\\n         <dataValidation sqref=\\\"\" + val.sqref.join(\" \") + \"\\\"\\n                         showErrorMessage=\\\"\" + val.showErrorMessage + \"\\\"\\n                         type=\\\"\" + ESC(val.type) + \"\\\"\\n                         \" + (val.type !== \"list\" ? \"operator=\\\"\" + ESC(val.operator) + \"\\\"\" : '') + \"\\n                         allowBlank=\\\"\" + val.allowBlank + \"\\\"\\n                         showDropDown=\\\"\" + val.showDropDown + \"\\\"\\n                         \" + (val.error ? \"error=\\\"\" + ESC(val.error) + \"\\\"\" : '') + \"\\n                         \" + (val.errorTitle ? \"errorTitle=\\\"\" + ESC(val.errorTitle) + \"\\\"\" : '') + \">\\n           \" + (val.formula1 ? \"<formula1>\" + ESC(val.formula1) + \"</formula1>\" : '') + \"\\n           \" + (val.formula2 ? \"<formula2>\" + ESC(val.formula2) + \"</formula2>\" : '') + \"\\n         </dataValidation>\";\n  }) + \"\\n     </dataValidations>\" : '') + \"\\n\\n   \" + (hyperlinks.length ? \"\\n     <hyperlinks>\\n       \" + foreach(hyperlinks, function (link) {\n    return \"\\n         <hyperlink ref=\\\"\" + link.ref + \"\\\" r:id=\\\"\" + link.rId + \"\\\"/>\";\n  }) + \"\\n     </hyperlinks>\" : '') + \"\\n\\n   <pageMargins left=\\\"0.7\\\" right=\\\"0.7\\\" top=\\\"0.75\\\" bottom=\\\"0.75\\\" header=\\\"0.3\\\" footer=\\\"0.3\\\" />\\n   \" + (drawing ? \"<drawing r:id=\\\"\" + drawing + \"\\\"/>\" : '') + \"\\n   \" + (legacyDrawing ? \"<legacyDrawing r:id=\\\"\" + legacyDrawing + \"\\\"/>\" : '') + \"\\n</worksheet>\";\n};\n\nvar WORKBOOK_RELS = function (ref) {\n  var count = ref.count;\n  return XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + repeat(count, function (idx) {\n    return \"\\n    <Relationship Id=\\\"rId\" + (idx + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\\\" Target=\\\"worksheets/sheet\" + (idx + 1) + \".xml\\\" />\";\n  }) + \"\\n  <Relationship Id=\\\"rId\" + (count + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\\\" Target=\\\"styles.xml\\\" />\\n  <Relationship Id=\\\"rId\" + (count + 2) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\\\" Target=\\\"sharedStrings.xml\\\" />\\n</Relationships>\";\n};\n\nvar WORKSHEET_RELS = function (ref) {\n  var hyperlinks = ref.hyperlinks;\n  var comments = ref.comments;\n  var sheetIndex = ref.sheetIndex;\n  var drawings = ref.drawings;\n  return XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + foreach(hyperlinks, function (link) {\n    return \"\\n    <Relationship Id=\\\"\" + link.rId + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\\\" Target=\\\"\" + ESC(link.target) + \"\\\" TargetMode=\\\"External\\\" />\";\n  }) + \"\\n  \" + (!comments.length ? '' : \"\\n    <Relationship Id=\\\"comment\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\\\" Target=\\\"../comments\" + sheetIndex + \".xml\\\"/>\\n    <Relationship Id=\\\"vml\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\\\" Target=\\\"../drawings/vmlDrawing\" + sheetIndex + \".vml\\\"/>\") + \"\\n  \" + (!drawings.length ? '' : \"\\n    <Relationship Id=\\\"drw\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\\\" Target=\\\"../drawings/drawing\" + sheetIndex + \".xml\\\"/>\") + \"\\n</Relationships>\";\n};\n\nvar COMMENTS_XML = function (ref) {\n  var comments = ref.comments;\n  return XMLHEAD + \"\\n<comments xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\">\\n  <authors>\\n    <author></author>\\n  </authors>\\n  <commentList>\\n    \" + foreach(comments, function (comment) {\n    return \"\\n      <comment ref=\\\"\" + comment.ref + \"\\\" authorId=\\\"0\\\">\\n        <text>\\n          <r>\\n            <rPr>\\n              <sz val=\\\"8\\\"/>\\n              <color indexed=\\\"81\\\"/>\\n              <rFont val=\\\"Tahoma\\\"/>\\n              <charset val=\\\"1\\\"/>\\n            </rPr>\\n            <t>\" + ESC(comment.text) + \"</t>\\n          </r>\\n        </text>\\n      </comment>\";\n  }) + \"\\n  </commentList>\\n</comments>\";\n};\n\nvar LEGACY_DRAWING = function (ref) {\n  var comments = ref.comments;\n  return \"<xml xmlns:v=\\\"urn:schemas-microsoft-com:vml\\\"\\n     xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\"\\n     xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\">\\n  <v:shapetype coordsize=\\\"21600,21600\\\" id=\\\"_x0000_t202\\\" path=\\\"m,l,21600r21600,l21600,xe\\\">\\n    <v:stroke joinstyle=\\\"miter\\\"/>\\n    <v:path gradientshapeok=\\\"t\\\" o:connecttype=\\\"rect\\\"/>\\n  </v:shapetype>\\n  \" + foreach(comments, function (comment) {\n    return \"\\n    <v:shape type=\\\"#_x0000_t202\\\" style=\\\"visibility: hidden\\\" fillcolor=\\\"#ffffe1\\\" o:insetmode=\\\"auto\\\">\\n      <v:shadow on=\\\"t\\\" color=\\\"black\\\" obscured=\\\"t\\\"/>\\n      <x:ClientData ObjectType=\\\"Note\\\">\\n        <x:MoveWithCells/>\\n        <x:SizeWithCells/>\\n        <x:Anchor>\" + comment.anchor + \"</x:Anchor>\\n        <x:AutoFill>False</x:AutoFill>\\n        <x:Row>\" + comment.row + \"</x:Row>\\n        <x:Column>\" + comment.col + \"</x:Column>\\n      </x:ClientData>\\n    </v:shape>\";\n  }) + \"\\n</xml>\";\n};\n\nvar DRAWINGS_XML = function (drawings) {\n  return XMLHEAD + \"\\n<xdr:wsDr xmlns:xdr=\\\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\\\"\\n          xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\"\\n          xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  \" + foreach(drawings, function (drawing, index) {\n    return \"\\n    <xdr:oneCellAnchor editAs=\\\"oneCell\\\">\\n      <xdr:from>\\n        <xdr:col>\" + drawing.col + \"</xdr:col>\\n        <xdr:colOff>\" + drawing.colOffset + \"</xdr:colOff>\\n        <xdr:row>\" + drawing.row + \"</xdr:row>\\n        <xdr:rowOff>\" + drawing.rowOffset + \"</xdr:rowOff>\\n      </xdr:from>\\n      <xdr:ext cx=\\\"\" + drawing.width + \"\\\" cy=\\\"\" + drawing.height + \"\\\" />\\n      <xdr:pic>\\n        <xdr:nvPicPr>\\n          <xdr:cNvPr id=\\\"\" + (index + 1) + \"\\\" name=\\\"Picture \" + (index + 1) + \"\\\"/>\\n          <xdr:cNvPicPr/>\\n        </xdr:nvPicPr>\\n        <xdr:blipFill>\\n          <a:blip r:embed=\\\"\" + drawing.imageId + \"\\\"/>\\n          <a:stretch>\\n            <a:fillRect/>\\n          </a:stretch>\\n        </xdr:blipFill>\\n        <xdr:spPr>\\n          <a:prstGeom prst=\\\"rect\\\">\\n            <a:avLst/>\\n          </a:prstGeom>\\n        </xdr:spPr>\\n      </xdr:pic>\\n      <xdr:clientData/>\\n    </xdr:oneCellAnchor>\";\n  }) + \"\\n</xdr:wsDr>\";\n};\n\nvar DRAWINGS_RELS_XML = function (rels) {\n  return XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + foreach(rels, function (rel) {\n    return \"\\n    <Relationship Id=\\\"\" + rel.rId + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\\\" Target=\\\"\" + rel.target + \"\\\"/>\";\n  }) + \"\\n</Relationships>\";\n};\n\nvar SHARED_STRINGS = function (ref) {\n  var count = ref.count;\n  var uniqueCount = ref.uniqueCount;\n  var indexes = ref.indexes;\n  return XMLHEAD + \"\\n<sst xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" count=\\\"\" + count + \"\\\" uniqueCount=\\\"\" + uniqueCount + \"\\\">\\n  \" + foreach(Object.keys(indexes), function (index) {\n    return \"\\n    <si><t xml:space=\\\"preserve\\\">\" + ESC(index.substring(1)) + \"</t></si>\";\n  }) + \"\\n</sst>\";\n};\n\nvar STYLES = function (ref) {\n  var formats = ref.formats;\n  var fonts = ref.fonts;\n  var fills = ref.fills;\n  var borders = ref.borders;\n  var styles = ref.styles;\n  return XMLHEAD + \"\\n<styleSheet\\n    xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\"\\n    xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\"\\n    mc:Ignorable=\\\"x14ac\\\"\\n    xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\">\\n  <numFmts count=\\\"\" + formats.length + \"\\\">\\n  \" + foreach(formats, function (format, fi) {\n    return \"\\n    <numFmt formatCode=\\\"\" + ESC(format.format) + \"\\\" numFmtId=\\\"\" + (165 + fi) + \"\\\" />\";\n  }) + \"\\n  </numFmts>\\n  <fonts count=\\\"\" + (fonts.length + 1) + \"\\\" x14ac:knownFonts=\\\"1\\\">\\n    <font>\\n       <sz val=\\\"11\\\" />\\n       <color theme=\\\"1\\\" />\\n       <name val=\\\"Calibri\\\" />\\n       <family val=\\\"2\\\" />\\n       <scheme val=\\\"minor\\\" />\\n    </font>\\n    \" + foreach(fonts, function (font) {\n    return \"\\n    <font>\\n      \" + (font.bold ? '<b/>' : '') + \"\\n      \" + (font.italic ? '<i/>' : '') + \"\\n      \" + (font.underline ? '<u/>' : '') + \"\\n      <sz val=\\\"\" + (font.fontSize || 11) + \"\\\" />\\n      \" + (font.color ? \"<color rgb=\\\"\" + ESC(font.color) + \"\\\" />\" : '<color theme=\"1\" />') + \"\\n      \" + (font.fontFamily ? \"\\n        <name val=\\\"\" + ESC(font.fontFamily) + \"\\\" />\\n        <family val=\\\"2\\\" />\\n      \" : \"\\n        <name val=\\\"Calibri\\\" />\\n        <family val=\\\"2\\\" />\\n        <scheme val=\\\"minor\\\" />\\n      \") + \"\\n    </font>\";\n  }) + \"\\n  </fonts>\\n  <fills count=\\\"\" + (fills.length + 2) + \"\\\">\\n      <fill><patternFill patternType=\\\"none\\\"/></fill>\\n      <fill><patternFill patternType=\\\"gray125\\\"/></fill>\\n    \" + foreach(fills, function (fill) {\n    return \"\\n      \" + (fill.background ? \"\\n        <fill>\\n          <patternFill patternType=\\\"solid\\\">\\n              <fgColor rgb=\\\"\" + ESC(fill.background) + \"\\\"/>\\n          </patternFill>\\n        </fill>\\n      \" : '');\n  }) + \"\\n  </fills>\\n  <borders count=\\\"\" + (borders.length + 1) + \"\\\">\\n    <border><left/><right/><top/><bottom/><diagonal/></border>\\n    \" + foreach(borders, borderTemplate) + \"\\n  </borders>\\n  <cellStyleXfs count=\\\"1\\\">\\n    <xf borderId=\\\"0\\\" fillId=\\\"0\\\" fontId=\\\"0\\\" />\\n  </cellStyleXfs>\\n  <cellXfs count=\\\"\" + (styles.length + 1) + \"\\\">\\n    <xf numFmtId=\\\"0\\\" fontId=\\\"0\\\" fillId=\\\"0\\\" borderId=\\\"0\\\" xfId=\\\"0\\\" />\\n    \" + foreach(styles, function (style) {\n    return \"\\n      <xf xfId=\\\"0\\\"\\n          \" + (style.fontId ? \"fontId=\\\"\" + style.fontId + \"\\\" applyFont=\\\"1\\\"\" : '') + \"\\n          \" + (style.fillId ? \"fillId=\\\"\" + style.fillId + \"\\\" applyFill=\\\"1\\\"\" : '') + \"\\n          \" + (style.numFmtId ? \"numFmtId=\\\"\" + style.numFmtId + \"\\\" applyNumberFormat=\\\"1\\\"\" : '') + \"\\n          \" + (style.textAlign || style.verticalAlign || style.wrap ? 'applyAlignment=\"1\"' : '') + \"\\n          \" + (style.borderId ? \"borderId=\\\"\" + style.borderId + \"\\\" applyBorder=\\\"1\\\"\" : '') + \">\\n        \" + (style.textAlign || style.verticalAlign || style.wrap ? \"\\n        <alignment\\n          \" + (style.textAlign ? \"horizontal=\\\"\" + ESC(style.textAlign) + \"\\\"\" : '') + \"\\n          \" + (style.verticalAlign ? \"vertical=\\\"\" + ESC(style.verticalAlign) + \"\\\"\" : '') + \"\\n          \" + (style.indent ? \"indent=\\\"\" + ESC(style.indent) + \"\\\"\" : '') + \"\\n          \" + (style.wrap ? 'wrapText=\"1\"' : '') + \" />\\n        \" : '') + \"\\n      </xf>\\n    \";\n  }) + \"\\n  </cellXfs>\\n  <cellStyles count=\\\"1\\\">\\n    <cellStyle name=\\\"Normal\\\" xfId=\\\"0\\\" builtinId=\\\"0\\\"/>\\n  </cellStyles>\\n  <dxfs count=\\\"0\\\" />\\n  <tableStyles count=\\\"0\\\" defaultTableStyle=\\\"TableStyleMedium2\\\" defaultPivotStyle=\\\"PivotStyleMedium9\\\" />\\n</styleSheet>\";\n};\n\nfunction writeFormula(formula) {\n  if (typeof formula == \"string\") {\n    return \"<f>\" + ESC(formula) + \"</f>\";\n  } // array formulas\n\n\n  return \"<f t=\\\"array\\\" ref=\\\"\" + formula.ref + \"\\\">\" + ESC(formula.src) + \"</f>\";\n}\n\nfunction numChar(colIndex) {\n  var letter = Math.floor(colIndex / 26) - 1;\n  return (letter >= 0 ? numChar(letter) : \"\") + String.fromCharCode(65 + colIndex % 26);\n}\n\nfunction ref(rowIndex, colIndex) {\n  return numChar(colIndex) + (rowIndex + 1);\n}\n\nfunction $ref(rowIndex, colIndex) {\n  return \"$\" + numChar(colIndex) + \"$\" + (rowIndex + 1);\n}\n\nfunction filterRowIndex(options) {\n  var frozenRows = options.frozenRows || (options.freezePane || {}).rowSplit || 1;\n  return frozenRows - 1;\n}\n\nfunction toWidth(px) {\n  var maximumDigitWidth = 7;\n  return px / maximumDigitWidth - Math.floor(128 / maximumDigitWidth) / 256;\n}\n\nfunction toHeight(px) {\n  return px * 0.75;\n}\n\nfunction stripFunnyChars(value) {\n  return String(value).replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g, \"\") // leave CRLF in\n  .replace(/\\r?\\n/g, \"\\r\\n\"); // make sure LF is preceded by CR\n}\n\nvar Worksheet = function Worksheet(options, sharedStrings, styles, borders) {\n  this.options = options;\n  this._strings = sharedStrings;\n  this._styles = styles;\n  this._borders = borders;\n  this._validations = {};\n  this._comments = [];\n  this._drawings = options.drawings || [];\n  this._hyperlinks = (this.options.hyperlinks || []).map(function (link, i) {\n    return Object.assign({}, link, {\n      rId: \"link\" + i\n    });\n  });\n};\n\nWorksheet.prototype.relsToXML = function relsToXML() {\n  var hyperlinks = this._hyperlinks;\n  var comments = this._comments;\n  var drawings = this._drawings;\n\n  if (hyperlinks.length || comments.length || drawings.length) {\n    return WORKSHEET_RELS({\n      hyperlinks: hyperlinks,\n      comments: comments,\n      sheetIndex: this.options.sheetIndex,\n      drawings: drawings\n    });\n  }\n};\n\nWorksheet.prototype.toXML = function toXML(index) {\n  var this$1 = this;\n  var mergeCells = this.options.mergedCells || [];\n  var rows = this.options.rows || [];\n  var data = inflate(rows, mergeCells);\n\n  this._readCells(data);\n\n  var autoFilter = this.options.filter;\n  var filter;\n\n  if (autoFilter && typeof autoFilter.from === \"number\" && typeof autoFilter.to === \"number\") {\n    // Grid enables auto filter\n    autoFilter = {\n      from: ref(filterRowIndex(this.options), autoFilter.from),\n      to: ref(filterRowIndex(this.options), autoFilter.to)\n    };\n  } else if (autoFilter && autoFilter.ref && autoFilter.columns) {\n    // this is probably from the Spreadsheet\n    filter = autoFilter;\n    autoFilter = null;\n  }\n\n  var validations = [];\n\n  for (var i in this$1._validations) {\n    if (Object.prototype.hasOwnProperty.call(this$1._validations, i)) {\n      validations.push(this$1._validations[i]);\n    }\n  }\n\n  var defaultCellStyleId = null;\n\n  if (this.options.defaultCellStyle) {\n    defaultCellStyleId = this._lookupStyle(this.options.defaultCellStyle);\n  }\n\n  var freezePane = this.options.freezePane || {};\n  var defaults = this.options.defaults || {};\n  var lastRow = this.options.rows ? this._getLastRow() : 1;\n  var lastCol = this.options.rows ? this._getLastCol() : 1;\n  return WORKSHEET({\n    frozenColumns: this.options.frozenColumns || freezePane.colSplit,\n    frozenRows: this.options.frozenRows || freezePane.rowSplit,\n    columns: this.options.columns,\n    defaults: defaults,\n    data: data,\n    index: index,\n    mergeCells: mergeCells,\n    autoFilter: autoFilter,\n    filter: filter,\n    showGridLines: this.options.showGridLines,\n    hyperlinks: this._hyperlinks,\n    validations: validations,\n    defaultCellStyleId: defaultCellStyleId,\n    rtl: this.options.rtl !== undefined ? this.options.rtl : defaults.rtl,\n    legacyDrawing: this._comments.length ? \"vml\" + this.options.sheetIndex : null,\n    drawing: this._drawings.length ? \"drw\" + this.options.sheetIndex : null,\n    lastRow: lastRow,\n    lastCol: lastCol\n  });\n};\n\nWorksheet.prototype.commentsXML = function commentsXML() {\n  if (this._comments.length) {\n    return COMMENTS_XML({\n      comments: this._comments\n    });\n  }\n};\n\nWorksheet.prototype.drawingsXML = function drawingsXML(images) {\n  if (this._drawings.length) {\n    var rels = {};\n\n    var main = this._drawings.map(function (drw) {\n      var ref = parseRef(drw.topLeftCell);\n      var img = rels[drw.image];\n\n      if (!img) {\n        img = rels[drw.image] = {\n          rId: \"img\" + drw.image,\n          target: images[drw.image].target\n        };\n      }\n\n      return {\n        col: ref.col,\n        colOffset: pixelsToExcel(drw.offsetX),\n        row: ref.row,\n        rowOffset: pixelsToExcel(drw.offsetY),\n        width: pixelsToExcel(drw.width),\n        height: pixelsToExcel(drw.height),\n        imageId: img.rId\n      };\n    });\n\n    return {\n      main: DRAWINGS_XML(main),\n      rels: DRAWINGS_RELS_XML(rels)\n    };\n  }\n};\n\nWorksheet.prototype.legacyDrawing = function legacyDrawing() {\n  if (this._comments.length) {\n    return LEGACY_DRAWING({\n      comments: this._comments\n    });\n  }\n};\n\nWorksheet.prototype._lookupString = function _lookupString(value) {\n  var key = \"$\" + value;\n  var index = this._strings.indexes[key];\n  var result;\n\n  if (index !== undefined) {\n    result = index;\n  } else {\n    result = this._strings.indexes[key] = this._strings.uniqueCount;\n    this._strings.uniqueCount++;\n  }\n\n  this._strings.count++;\n  return result;\n};\n\nWorksheet.prototype._lookupStyle = function _lookupStyle(style) {\n  var json = JSON.stringify(style);\n\n  if (json === \"{}\") {\n    return 0;\n  }\n\n  var index = indexOf(json, this._styles);\n\n  if (index < 0) {\n    index = this._styles.push(json) - 1;\n  } // There is one default style\n\n\n  return index + 1;\n};\n\nWorksheet.prototype._lookupBorder = function _lookupBorder(border) {\n  var json = JSON.stringify(border);\n\n  if (json === \"{}\") {\n    return;\n  }\n\n  var index = indexOf(json, this._borders);\n\n  if (index < 0) {\n    index = this._borders.push(json) - 1;\n  } // There is one default border\n\n\n  return index + 1;\n};\n\nWorksheet.prototype._readCells = function _readCells(rowData) {\n  var this$1 = this;\n\n  for (var i = 0; i < rowData.length; i++) {\n    var row = rowData[i];\n    var cells = row.cells;\n    row.data = [];\n\n    for (var j = 0; j < cells.length; j++) {\n      var cellData = this$1._cell(cells[j], row.index, j);\n\n      if (cellData) {\n        row.data.push(cellData);\n      }\n    }\n  }\n};\n\nWorksheet.prototype._cell = function _cell(data, rowIndex, cellIndex) {\n  if (!data || data === EMPTY_CELL) {\n    return null;\n  }\n\n  var value = data.value;\n  var border = {};\n\n  if (data.borderLeft) {\n    border.left = data.borderLeft;\n  }\n\n  if (data.borderRight) {\n    border.right = data.borderRight;\n  }\n\n  if (data.borderTop) {\n    border.top = data.borderTop;\n  }\n\n  if (data.borderBottom) {\n    border.bottom = data.borderBottom;\n  }\n\n  border = this._lookupBorder(border);\n  var defStyle = this.options.defaultCellStyle || {};\n  var style = {\n    borderId: border\n  };\n\n  (function (add) {\n    add(\"color\");\n    add(\"background\");\n    add(\"bold\");\n    add(\"italic\");\n    add(\"underline\");\n\n    if (!add(\"fontFamily\")) {\n      add(\"fontName\", \"fontFamily\");\n    }\n\n    add(\"fontSize\");\n    add(\"format\");\n\n    if (!add(\"textAlign\")) {\n      add(\"hAlign\", \"textAlign\");\n    }\n\n    if (!add(\"verticalAlign\")) {\n      add(\"vAlign\", \"verticalAlign\");\n    }\n\n    add(\"wrap\");\n    add(\"indent\");\n  })(function (prop, target) {\n    var val = data[prop];\n\n    if (val === undefined) {\n      val = defStyle[prop];\n    }\n\n    if (val !== undefined) {\n      style[target || prop] = val;\n      return true;\n    }\n  });\n\n  var columns = this.options.columns || [];\n  var column = columns[cellIndex];\n  var type = typeof value;\n\n  if (column && column.autoWidth && (!data.colSpan || data.colSpan === 1)) {\n    var displayValue = value; // XXX: let's not bring kendo.toString in only for this.\n    //    better wait until the spreadsheet engine is available as a separate\n    //    component, then we can use a real Excel-like formatter.\n    //\n\n    if (type === \"number\") {\n      // kendo.toString will not behave exactly like the Excel format\n      // Still, it's the best we have available for estimating the character count.\n      displayValue = IntlService.toString(value, data.format);\n    }\n\n    column.width = Math.max(column.width || 0, String(displayValue).length);\n  }\n\n  if (type === \"string\") {\n    value = stripFunnyChars(value);\n    value = this._lookupString(value);\n    type = \"s\";\n  } else if (type === \"number\") {\n    type = \"n\";\n  } else if (type === \"boolean\") {\n    type = \"b\";\n    value = Number(value);\n  } else if (value && value.getTime) {\n    type = null;\n    value = dateToSerial(value);\n\n    if (!style.format) {\n      style.format = \"mm-dd-yy\";\n    }\n  } else {\n    type = null;\n    value = null;\n  }\n\n  style = this._lookupStyle(style);\n  var cellName = ref(rowIndex, cellIndex);\n\n  if (data.validation) {\n    this._addValidation(data.validation, cellName);\n  }\n\n  if (data.comment) {\n    var anchor = [cellIndex + 1, // start column\n    15, // start column offset\n    rowIndex, // start row\n    10, // start row offset\n    cellIndex + 3, // end column\n    15, // end column offset\n    rowIndex + 3, // end row\n    4 // end row offset\n    ];\n\n    this._comments.push({\n      ref: cellName,\n      text: data.comment,\n      row: rowIndex,\n      col: cellIndex,\n      anchor: anchor.join(\", \")\n    });\n  }\n\n  return {\n    value: value,\n    formula: data.formula,\n    type: type,\n    style: style,\n    ref: cellName\n  };\n};\n\nWorksheet.prototype._addValidation = function _addValidation(v, ref) {\n  var tmp = {\n    showErrorMessage: v.type === \"reject\" ? 1 : 0,\n    formula1: v.from,\n    formula2: v.to,\n    type: MAP_EXCEL_TYPE[v.dataType] || v.dataType,\n    operator: MAP_EXCEL_OPERATOR[v.comparerType] || v.comparerType,\n    allowBlank: v.allowNulls ? 1 : 0,\n    showDropDown: v.showButton ? 0 : 1,\n    // LOL, Excel!\n    error: v.messageTemplate,\n    errorTitle: v.titleTemplate\n  };\n  var json = JSON.stringify(tmp);\n\n  if (!this._validations[json]) {\n    this._validations[json] = tmp;\n    tmp.sqref = [];\n  }\n\n  this._validations[json].sqref.push(ref);\n};\n\nWorksheet.prototype._getLastRow = function _getLastRow() {\n  return countData(this.options.rows);\n};\n\nWorksheet.prototype._getLastCol = function _getLastCol() {\n  var last = 0;\n  this.options.rows.forEach(function (row) {\n    if (row.cells) {\n      last = Math.max(last, countData(row.cells));\n    }\n  });\n  return last;\n};\n\nfunction countData(data) {\n  var last = data.length;\n  data.forEach(function (el) {\n    if (el.index && el.index >= last) {\n      last = el.index + 1;\n    }\n  });\n  return last;\n}\n\nvar MAP_EXCEL_OPERATOR = {\n  // includes only what differs; key is our operator, value is Excel\n  // operator.\n  greaterThanOrEqualTo: \"greaterThanOrEqual\",\n  lessThanOrEqualTo: \"lessThanOrEqual\"\n};\nvar MAP_EXCEL_TYPE = {\n  number: \"decimal\"\n};\nvar defaultFormats = {\n  \"General\": 0,\n  \"0\": 1,\n  \"0.00\": 2,\n  \"#,##0\": 3,\n  \"#,##0.00\": 4,\n  \"0%\": 9,\n  \"0.00%\": 10,\n  \"0.00E+00\": 11,\n  \"# ?/?\": 12,\n  \"# ??/??\": 13,\n  \"mm-dd-yy\": 14,\n  \"d-mmm-yy\": 15,\n  \"d-mmm\": 16,\n  \"mmm-yy\": 17,\n  \"h:mm AM/PM\": 18,\n  \"h:mm:ss AM/PM\": 19,\n  \"h:mm\": 20,\n  \"h:mm:ss\": 21,\n  \"m/d/yy h:mm\": 22,\n  \"#,##0 ;(#,##0)\": 37,\n  \"#,##0 ;[Red](#,##0)\": 38,\n  \"#,##0.00;(#,##0.00)\": 39,\n  \"#,##0.00;[Red](#,##0.00)\": 40,\n  \"mm:ss\": 45,\n  \"[h]:mm:ss\": 46,\n  \"mmss.0\": 47,\n  \"##0.0E+0\": 48,\n  \"@\": 49,\n  \"[$-404]e/m/d\": 27,\n  \"m/d/yy\": 30,\n  \"t0\": 59,\n  \"t0.00\": 60,\n  \"t#,##0\": 61,\n  \"t#,##0.00\": 62,\n  \"t0%\": 67,\n  \"t0.00%\": 68,\n  \"t# ?/?\": 69,\n  \"t# ??/??\": 70\n};\n\nfunction convertColor(value) {\n  var color = value;\n\n  if (color.length < 6) {\n    color = color.replace(/(\\w)/g, function ($0, $1) {\n      return $1 + $1;\n    });\n  }\n\n  color = color.substring(1).toUpperCase();\n\n  if (color.length < 8) {\n    color = \"FF\" + color;\n  }\n\n  return color;\n}\n\nvar Workbook = function Workbook(options) {\n  var this$1 = this;\n  this.options = options || {};\n  this._strings = {\n    indexes: {},\n    count: 0,\n    uniqueCount: 0\n  };\n  this._styles = [];\n  this._borders = [];\n  this._images = this.options.images;\n  this._imgId = 0;\n  this._sheets = map(this.options.sheets || [], function (options, i) {\n    options.defaults = this$1.options;\n    options.sheetIndex = i + 1;\n    return new Worksheet(options, this$1._strings, this$1._styles, this$1._borders);\n  });\n};\n\nWorkbook.prototype.imageFilename = function imageFilename(mimeType) {\n  var id = ++this._imgId;\n\n  switch (mimeType) {\n    case \"image/jpg\":\n    case \"image/jpeg\":\n      return \"image\" + id + \".jpg\";\n\n    case \"image/png\":\n      return \"image\" + id + \".png\";\n\n    case \"image/gif\":\n      return \"image\" + id + \".gif\";\n\n    default:\n      return \"image\" + id + \".bin\";\n    // XXX: anything better to do here?\n  }\n};\n\nWorkbook.prototype.toZIP = function toZIP() {\n  var this$1 = this;\n  var zip = createZip();\n  var docProps = zip.folder(\"docProps\");\n  docProps.file(\"core.xml\", CORE({\n    creator: this.options.creator || \"Kendo UI\",\n    lastModifiedBy: this.options.creator || \"Kendo UI\",\n    created: this.options.date || new Date().toJSON(),\n    modified: this.options.date || new Date().toJSON()\n  }));\n  var sheetCount = this._sheets.length;\n  docProps.file(\"app.xml\", APP({\n    sheets: this._sheets\n  }));\n  var rels = zip.folder(\"_rels\");\n  rels.file(\".rels\", RELS);\n  var xl = zip.folder(\"xl\");\n  var xlRels = xl.folder(\"_rels\");\n  xlRels.file(\"workbook.xml.rels\", WORKBOOK_RELS({\n    count: sheetCount\n  }));\n\n  if (this._images) {\n    var media = xl.folder(\"media\");\n    Object.keys(this._images).forEach(function (id) {\n      var img = this$1._images[id];\n      var filename = this$1.imageFilename(img.type);\n      media.file(filename, img.data);\n      img.target = \"../media/\" + filename;\n    });\n  }\n\n  var sheetIds = {};\n  xl.file(\"workbook.xml\", WORKBOOK({\n    sheets: this._sheets,\n    filterNames: map(this._sheets, function (sheet, index) {\n      var options = sheet.options;\n      var sheetName = options.name || options.title || \"Sheet\" + (index + 1);\n      sheetIds[sheetName.toLowerCase()] = index;\n      var filter = options.filter;\n\n      if (filter) {\n        if (filter.ref) {\n          // spreadsheet provides `ref`\n          var a = filter.ref.split(\":\");\n          var from = parseRef(a[0]);\n          var to = parseRef(a[1]);\n          return {\n            localSheetId: index,\n            name: sheetName,\n            from: $ref(from.row, from.col),\n            to: $ref(to.row, to.col)\n          };\n        } else if (typeof filter.from !== \"undefined\" && typeof filter.to !== \"undefined\") {\n          // grid does this\n          return {\n            localSheetId: index,\n            name: sheetName,\n            from: $ref(filterRowIndex(options), filter.from),\n            to: $ref(filterRowIndex(options), filter.to)\n          };\n        }\n      }\n    }),\n    userNames: map(this.options.names || [], function (def) {\n      return {\n        name: def.localName,\n        localSheetId: def.sheet ? sheetIds[def.sheet.toLowerCase()] : null,\n        value: def.value,\n        hidden: def.hidden\n      };\n    })\n  }));\n  var worksheets = xl.folder(\"worksheets\");\n  var drawings = xl.folder(\"drawings\");\n  var drawingsRels = drawings.folder(\"_rels\");\n  var sheetRels = worksheets.folder(\"_rels\");\n  var commentFiles = [];\n  var drawingFiles = [];\n\n  for (var idx = 0; idx < sheetCount; idx++) {\n    var sheet = this$1._sheets[idx];\n    var sheetName = \"sheet\" + (idx + 1) + \".xml\";\n    var sheetXML = sheet.toXML(idx); // must be called before relsToXML\n\n    var relsXML = sheet.relsToXML();\n    var commentsXML = sheet.commentsXML();\n    var legacyDrawing = sheet.legacyDrawing();\n    var drawingsXML = sheet.drawingsXML(this$1._images);\n\n    if (relsXML) {\n      sheetRels.file(sheetName + \".rels\", relsXML);\n    }\n\n    if (commentsXML) {\n      var name = \"comments\" + sheet.options.sheetIndex + \".xml\";\n      xl.file(name, commentsXML);\n      commentFiles.push(name);\n    }\n\n    if (legacyDrawing) {\n      drawings.file(\"vmlDrawing\" + sheet.options.sheetIndex + \".vml\", legacyDrawing);\n    }\n\n    if (drawingsXML) {\n      var name$1 = \"drawing\" + sheet.options.sheetIndex + \".xml\";\n      drawings.file(name$1, drawingsXML.main);\n      drawingsRels.file(name$1 + \".rels\", drawingsXML.rels);\n      drawingFiles.push(name$1);\n    }\n\n    worksheets.file(sheetName, sheetXML);\n  }\n\n  var borders = map(this._borders, parseJSON);\n  var styles = map(this._styles, parseJSON);\n\n  var hasFont = function (style) {\n    return style.underline || style.bold || style.italic || style.color || style.fontFamily || style.fontSize;\n  };\n\n  var convertFontSize = function (value) {\n    var fontInPx = Number(value);\n    var fontInPt;\n\n    if (fontInPx) {\n      fontInPt = fontInPx * 3 / 4;\n    }\n\n    return fontInPt;\n  };\n\n  var fonts = map(styles, function (style) {\n    if (style.fontSize) {\n      style.fontSize = convertFontSize(style.fontSize);\n    }\n\n    if (style.color) {\n      style.color = convertColor(style.color);\n    }\n\n    if (hasFont(style)) {\n      return style;\n    }\n  });\n  var formats = map(styles, function (style) {\n    if (style.format && defaultFormats[style.format] === undefined) {\n      return style;\n    }\n  });\n  var fills = map(styles, function (style) {\n    if (style.background) {\n      style.background = convertColor(style.background);\n      return style;\n    }\n  });\n  xl.file(\"styles.xml\", STYLES({\n    fonts: fonts,\n    fills: fills,\n    formats: formats,\n    borders: borders,\n    styles: map(styles, function (style) {\n      var result = {};\n\n      if (hasFont(style)) {\n        result.fontId = indexOf(style, fonts) + 1;\n      }\n\n      if (style.background) {\n        result.fillId = indexOf(style, fills) + 2;\n      }\n\n      result.textAlign = style.textAlign;\n      result.indent = style.indent;\n      result.verticalAlign = style.verticalAlign;\n      result.wrap = style.wrap;\n      result.borderId = style.borderId;\n\n      if (style.format) {\n        if (defaultFormats[style.format] !== undefined) {\n          result.numFmtId = defaultFormats[style.format];\n        } else {\n          result.numFmtId = 165 + indexOf(style, formats);\n        }\n      }\n\n      return result;\n    })\n  }));\n  xl.file(\"sharedStrings.xml\", SHARED_STRINGS(this._strings));\n  zip.file(\"[Content_Types].xml\", CONTENT_TYPES({\n    sheetCount: sheetCount,\n    commentFiles: commentFiles,\n    drawingFiles: drawingFiles\n  }));\n  return zip;\n};\n\nWorkbook.prototype.toDataURL = function toDataURL() {\n  var zip = this.toZIP();\n  return zip.generateAsync ? zip.generateAsync(DATA_URL_OPTIONS).then(toDataURI) : toDataURI(zip.generate(DATA_URL_OPTIONS));\n};\n\nWorkbook.prototype.toBlob = function toBlob() {\n  var zip = this.toZIP();\n\n  if (zip.generateAsync) {\n    return zip.generateAsync(BLOB_OPTIONS);\n  }\n\n  return new Blob([zip.generate(ARRAYBUFFER_OPTIONS)], {\n    type: MIME_TYPE\n  });\n};\n\nfunction borderStyle(width) {\n  var alias = \"thin\";\n\n  if (width === 2) {\n    alias = \"medium\";\n  } else if (width === 3) {\n    alias = \"thick\";\n  }\n\n  return alias;\n}\n\nfunction borderSideTemplate(name, style) {\n  var result = \"\";\n\n  if (style) {\n    result += \"<\" + name + \" style=\\\"\" + borderStyle(style.size) + \"\\\">\";\n\n    if (style.color) {\n      result += \"<color rgb=\\\"\" + convertColor(style.color) + \"\\\"/>\";\n    }\n\n    result += \"</\" + name + \">\";\n  }\n\n  return result;\n}\n\nfunction borderTemplate(border) {\n  return \"<border>\" + borderSideTemplate(\"left\", border.left) + borderSideTemplate(\"right\", border.right) + borderSideTemplate(\"top\", border.top) + borderSideTemplate(\"bottom\", border.bottom) + \"</border>\";\n}\n\nvar EMPTY_CELL = {};\n\nfunction inflate(rows, mergedCells) {\n  var rowData = [];\n  var rowsByIndex = [];\n  indexRows(rows, function (row, index) {\n    var data = {\n      _source: row,\n      index: index,\n      height: row.height,\n      level: row.level,\n      cells: []\n    };\n    rowData.push(data);\n    rowsByIndex[index] = data;\n  });\n  var sorted = sortByIndex(rowData).slice(0);\n  var ctx = {\n    rowData: rowData,\n    rowsByIndex: rowsByIndex,\n    mergedCells: mergedCells\n  };\n\n  for (var i = 0; i < sorted.length; i++) {\n    fillCells(sorted[i], ctx);\n    delete sorted[i]._source;\n  }\n\n  return sortByIndex(rowData);\n}\n\nfunction indexRows(rows, callback) {\n  for (var i = 0; i < rows.length; i++) {\n    var row = rows[i];\n\n    if (!row) {\n      continue;\n    }\n\n    var index = row.index;\n\n    if (typeof index !== \"number\") {\n      index = i;\n    }\n\n    callback(row, index);\n  }\n}\n\nfunction sortByIndex(items) {\n  return items.sort(function (a, b) {\n    return a.index - b.index;\n  });\n}\n\nfunction pushUnique(array, el) {\n  if (array.indexOf(el) < 0) {\n    array.push(el);\n  }\n}\n\nfunction getSpan(mergedCells, ref) {\n  for (var i = 0; i < mergedCells.length; ++i) {\n    var range = mergedCells[i];\n    var a = range.split(\":\");\n    var topLeft = a[0];\n\n    if (topLeft === ref) {\n      var bottomRight = a[1];\n      topLeft = parseRef(topLeft);\n      bottomRight = parseRef(bottomRight);\n      return {\n        rowSpan: bottomRight.row - topLeft.row + 1,\n        colSpan: bottomRight.col - topLeft.col + 1\n      };\n    }\n  }\n}\n\nfunction parseRef(ref) {\n  function getcol(str) {\n    var upperStr = str.toUpperCase();\n    var col = 0;\n\n    for (var i = 0; i < upperStr.length; ++i) {\n      col = col * 26 + upperStr.charCodeAt(i) - 64;\n    }\n\n    return col - 1;\n  }\n\n  function getrow(str) {\n    return parseInt(str, 10) - 1;\n  }\n\n  var m = /^([a-z]+)(\\d+)$/i.exec(ref);\n  return {\n    row: getrow(m[2]),\n    col: getcol(m[1])\n  };\n}\n\nfunction pixelsToExcel(px) {\n  return Math.round(px * 9525);\n}\n\nfunction fillCells(data, ctx) {\n  var row = data._source;\n  var rowIndex = data.index;\n  var cells = row.cells;\n  var cellData = data.cells;\n\n  if (!cells) {\n    return;\n  }\n\n  for (var i = 0; i < cells.length; i++) {\n    var cell = cells[i] || EMPTY_CELL;\n    var rowSpan = cell.rowSpan || 1;\n    var colSpan = cell.colSpan || 1;\n    var cellIndex = insertCell(cellData, cell);\n    var topLeftRef = ref(rowIndex, cellIndex);\n\n    if (rowSpan === 1 && colSpan === 1) {\n      // could still be merged: the spreadsheet does not send\n      // rowSpan/colSpan, but mergedCells is already populated.\n      // https://github.com/telerik/kendo-ui-core/issues/2401\n      var tmp = getSpan(ctx.mergedCells, topLeftRef);\n\n      if (tmp) {\n        colSpan = tmp.colSpan;\n        rowSpan = tmp.rowSpan;\n      }\n    }\n\n    spanCell(cell, cellData, cellIndex, colSpan);\n\n    if (rowSpan > 1 || colSpan > 1) {\n      pushUnique(ctx.mergedCells, topLeftRef + \":\" + ref(rowIndex + rowSpan - 1, cellIndex + colSpan - 1));\n    }\n\n    if (rowSpan > 1) {\n      for (var ri = rowIndex + 1; ri < rowIndex + rowSpan; ri++) {\n        var nextRow = ctx.rowsByIndex[ri];\n\n        if (!nextRow) {\n          nextRow = ctx.rowsByIndex[ri] = {\n            index: ri,\n            cells: []\n          };\n          ctx.rowData.push(nextRow);\n        }\n\n        spanCell(cell, nextRow.cells, cellIndex - 1, colSpan + 1);\n      }\n    }\n  }\n}\n\nfunction insertCell(data, cell) {\n  var index;\n\n  if (typeof cell.index === \"number\") {\n    index = cell.index;\n    insertCellAt(data, cell, cell.index);\n  } else {\n    index = appendCell(data, cell);\n  }\n\n  return index;\n}\n\nfunction insertCellAt(data, cell, index) {\n  data[index] = cell;\n}\n\nfunction appendCell(data, cell) {\n  var index = data.length;\n\n  for (var i = 0; i < data.length + 1; i++) {\n    if (!data[i]) {\n      data[i] = cell;\n      index = i;\n      break;\n    }\n  }\n\n  return index;\n}\n\nfunction spanCell(cell, row, startIndex, colSpan) {\n  for (var i = 1; i < colSpan; i++) {\n    var tmp = {\n      borderTop: cell.borderTop,\n      borderRight: cell.borderRight,\n      borderBottom: cell.borderBottom,\n      borderLeft: cell.borderLeft\n    };\n    insertCellAt(row, tmp, startIndex + i);\n  }\n}\n\nvar SPREADSHEET_FILTERS = function (ref$1) {\n  var ref = ref$1.ref;\n  var columns = ref$1.columns;\n  var generators = ref$1.generators;\n  return \"\\n<autoFilter ref=\\\"\" + ref + \"\\\">\\n  \" + foreach(columns, function (col) {\n    return \"\\n    <filterColumn colId=\\\"\" + col.index + \"\\\">\\n      \" + generators[col.filter](col) + \"\\n    </filterColumn>\\n  \";\n  }) + \"\\n</autoFilter>\";\n};\n\nvar SPREADSHEET_CUSTOM_FILTER = function (ref) {\n  var logic = ref.logic;\n  var criteria = ref.criteria;\n  return \"\\n<customFilters \" + (logic === 'and' ? 'and=\"1\"' : '') + \">\\n\" + foreach(criteria, function (f) {\n    var op = spreadsheetFilters.customOperator(f);\n    var val = spreadsheetFilters.customValue(f);\n    return \"<customFilter \" + (op ? \"operator=\\\"\" + op + \"\\\"\" : '') + \" val=\\\"\" + val + \"\\\"/>\";\n  }) + \"\\n</customFilters>\";\n};\n\nvar SPREADSHEET_DYNAMIC_FILTER = function (ref) {\n  var type = ref.type;\n  return \"<dynamicFilter type=\\\"\" + spreadsheetFilters.dynamicFilterType(type) + \"\\\" />\";\n};\n\nvar SPREADSHEET_TOP_FILTER = function (ref) {\n  var type = ref.type;\n  var value = ref.value;\n  return \"<top10 percent=\\\"\" + (/percent$/i.test(type) ? 1 : 0) + \"\\\"\\n       top=\\\"\" + (/^top/i.test(type) ? 1 : 0) + \"\\\"\\n       val=\\\"\" + value + \"\\\" />\";\n};\n\nvar SPREADSHEET_VALUE_FILTER = function (ref) {\n  var blanks = ref.blanks;\n  var values = ref.values;\n  return \"<filters \" + (blanks ? 'blank=\"1\"' : '') + \">\\n    \" + foreach(values, function (value) {\n    return \"\\n      <filter val=\\\"\" + value + \"\\\" />\";\n  }) + \"\\n  </filters>\";\n};\n\nfunction spreadsheetFilters(filter) {\n  return SPREADSHEET_FILTERS({\n    ref: filter.ref,\n    columns: filter.columns,\n    generators: {\n      custom: SPREADSHEET_CUSTOM_FILTER,\n      dynamic: SPREADSHEET_DYNAMIC_FILTER,\n      top: SPREADSHEET_TOP_FILTER,\n      value: SPREADSHEET_VALUE_FILTER\n    }\n  });\n}\n\nspreadsheetFilters.customOperator = function (f) {\n  return {\n    eq: \"equal\",\n    gt: \"greaterThan\",\n    gte: \"greaterThanOrEqual\",\n    lt: \"lessThan\",\n    lte: \"lessThanOrEqual\",\n    ne: \"notEqual\",\n    // These are not in the spec, but seems to be how Excel does\n    // it (see customValue below).  For the non-negated versions,\n    // the operator attribute is missing completely.\n    doesnotstartwith: \"notEqual\",\n    doesnotendwith: \"notEqual\",\n    doesnotcontain: \"notEqual\",\n    doesnotmatch: \"notEqual\"\n  }[f.operator.toLowerCase()];\n};\n\nfunction quoteSheet(name) {\n  if (/^\\'/.test(name)) {\n    // assume already quoted, the Spreadsheet does it.\n    return name;\n  }\n\n  if (/^[a-z_][a-z0-9_]*$/i.test(name)) {\n    return name; // no need to quote it\n  }\n\n  return \"'\" + name.replace(/\\x27/g, \"\\\\'\") + \"'\";\n}\n\nspreadsheetFilters.customValue = function (f) {\n  function esc(str) {\n    return str.replace(/([*?])/g, \"~$1\");\n  }\n\n  switch (f.operator.toLowerCase()) {\n    case \"startswith\":\n    case \"doesnotstartwith\":\n      return esc(f.value) + \"*\";\n\n    case \"endswith\":\n    case \"doesnotendwith\":\n      return \"*\" + esc(f.value);\n\n    case \"contains\":\n    case \"doesnotcontain\":\n      return \"*\" + esc(f.value) + \"*\";\n\n    default:\n      return f.value;\n  }\n};\n\nspreadsheetFilters.dynamicFilterType = function (type) {\n  return {\n    quarter1: \"Q1\",\n    quarter2: \"Q2\",\n    quarter3: \"Q3\",\n    quarter4: \"Q4\",\n    january: \"M1\",\n    february: \"M2\",\n    march: \"M3\",\n    april: \"M4\",\n    may: \"M5\",\n    june: \"M6\",\n    july: \"M7\",\n    august: \"M8\",\n    september: \"M9\",\n    october: \"M10\",\n    november: \"M11\",\n    december: \"M12\"\n  }[type.toLowerCase()] || type;\n};\n\nexport { Workbook, Worksheet };","map":{"version":3,"sources":["C:/Users/pramod.katiyar/Documents/Project-git-download/nodeReactfrontend-main/node_modules/@progress/kendo-ooxml/dist/es/ooxml.js"],"names":["map","createZip","IntlService","dateToSerial","MIME_TYPE","DATA_URL_PREFIX","DATA_URL_OPTIONS","compression","type","BLOB_OPTIONS","ARRAYBUFFER_OPTIONS","toDataURI","content","indexOf","thing","array","parseJSON","JSON","parse","bind","ESC","val","String","replace","repeat","count","func","str","i","foreach","arr","Array","isArray","length","Object","keys","forEach","key","XMLHEAD","RELS","CORE","ref","creator","lastModifiedBy","created","modified","APP","sheets","sheet","options","title","CONTENT_TYPES","sheetCount","commentFiles","drawingFiles","idx","filename","WORKBOOK","filterNames","userNames","name","f","localSheetId","quoteSheet","from","to","hidden","value","WORKSHEET","ref$1","frozenColumns","frozenRows","columns","defaults","data","index","mergeCells","autoFilter","filter","showGridLines","hyperlinks","validations","defaultCellStyleId","rtl","legacyDrawing","drawing","lastRow","lastCol","fromCharCode","skipCustomHeight","rowHeight","columnWidth","toWidth","column","ci","columnIndex","width","autoWidth","row","ri","rowIndex","level","height","toHeight","cell","style","formula","writeFormula","spreadsheetFilters","sqref","join","showErrorMessage","operator","allowBlank","showDropDown","error","errorTitle","formula1","formula2","link","rId","WORKBOOK_RELS","WORKSHEET_RELS","comments","sheetIndex","drawings","target","COMMENTS_XML","comment","text","LEGACY_DRAWING","anchor","col","DRAWINGS_XML","colOffset","rowOffset","imageId","DRAWINGS_RELS_XML","rels","rel","SHARED_STRINGS","uniqueCount","indexes","substring","STYLES","formats","fonts","fills","borders","styles","format","fi","font","bold","italic","underline","fontSize","color","fontFamily","fill","background","borderTemplate","fontId","fillId","numFmtId","textAlign","verticalAlign","wrap","borderId","indent","src","numChar","colIndex","letter","Math","floor","$ref","filterRowIndex","freezePane","rowSplit","px","maximumDigitWidth","stripFunnyChars","Worksheet","sharedStrings","_strings","_styles","_borders","_validations","_comments","_drawings","_hyperlinks","assign","prototype","relsToXML","toXML","this$1","mergedCells","rows","inflate","_readCells","hasOwnProperty","call","push","defaultCellStyle","_lookupStyle","_getLastRow","_getLastCol","colSplit","undefined","commentsXML","drawingsXML","images","main","drw","parseRef","topLeftCell","img","image","pixelsToExcel","offsetX","offsetY","_lookupString","result","json","stringify","_lookupBorder","border","rowData","cells","j","cellData","_cell","cellIndex","EMPTY_CELL","borderLeft","left","borderRight","right","borderTop","top","borderBottom","bottom","defStyle","add","prop","colSpan","displayValue","toString","max","Number","getTime","cellName","validation","_addValidation","v","tmp","MAP_EXCEL_TYPE","dataType","MAP_EXCEL_OPERATOR","comparerType","allowNulls","showButton","messageTemplate","titleTemplate","countData","last","el","greaterThanOrEqualTo","lessThanOrEqualTo","number","defaultFormats","convertColor","$0","$1","toUpperCase","Workbook","_images","_imgId","_sheets","imageFilename","mimeType","id","toZIP","zip","docProps","folder","file","date","Date","toJSON","xl","xlRels","media","sheetIds","sheetName","toLowerCase","a","split","names","def","localName","worksheets","drawingsRels","sheetRels","sheetXML","relsXML","name$1","hasFont","convertFontSize","fontInPx","fontInPt","toDataURL","generateAsync","then","generate","toBlob","Blob","borderStyle","alias","borderSideTemplate","size","rowsByIndex","indexRows","_source","sorted","sortByIndex","slice","ctx","fillCells","callback","items","sort","b","pushUnique","getSpan","range","topLeft","bottomRight","rowSpan","getcol","upperStr","charCodeAt","getrow","parseInt","m","exec","round","insertCell","topLeftRef","spanCell","nextRow","insertCellAt","appendCell","startIndex","SPREADSHEET_FILTERS","generators","SPREADSHEET_CUSTOM_FILTER","logic","criteria","op","customOperator","customValue","SPREADSHEET_DYNAMIC_FILTER","dynamicFilterType","SPREADSHEET_TOP_FILTER","test","SPREADSHEET_VALUE_FILTER","blanks","values","custom","dynamic","eq","gt","gte","lt","lte","ne","doesnotstartwith","doesnotendwith","doesnotcontain","doesnotmatch","esc","quarter1","quarter2","quarter3","quarter4","january","february","march","april","may","june","july","august","september","october","november","december"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,aAAhB;AACA,OAAOC,SAAP,MAAsB,oBAAtB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,OAAOC,YAAP,MAAyB,cAAzB;AAEA,IAAIC,SAAS,GAAG,mEAAhB;AACA,IAAIC,eAAe,GAAG,UAAUD,SAAV,GAAsB,UAA5C;AACA,IAAIE,gBAAgB,GAAG;AAAEC,EAAAA,WAAW,EAAE,SAAf;AAA0BC,EAAAA,IAAI,EAAE;AAAhC,CAAvB;AACA,IAAIC,YAAY,GAAG;AAAEF,EAAAA,WAAW,EAAE,SAAf;AAA0BC,EAAAA,IAAI,EAAE;AAAhC,CAAnB;AACA,IAAIE,mBAAmB,GAAG;AAAEH,EAAAA,WAAW,EAAE,SAAf;AAA0BC,EAAAA,IAAI,EAAE;AAAhC,CAA1B;AAEA;;AAEA,SAASG,SAAT,CAAmBC,OAAnB,EAA4B;AACxB,SAAOP,eAAe,GAAGO,OAAzB;AACH;;AAED,SAASC,OAAT,CAAiBC,KAAjB,EAAwBC,KAAxB,EAA+B;AAC3B,SAAOA,KAAK,CAACF,OAAN,CAAcC,KAAd,CAAP;AACH;;AAED,IAAIE,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAWC,IAAX,CAAgBF,IAAhB,CAAhB;;AAEA,SAASG,GAAT,CAAaC,GAAb,EAAkB;AACd,SAAOC,MAAM,CAACD,GAAD,CAAN,CACFE,OADE,CACM,IADN,EACY,OADZ,EAEFA,OAFE,CAEM,IAFN,EAEY,MAFZ,EAGFA,OAHE,CAGM,IAHN,EAGY,MAHZ,EAIFA,OAJE,CAIM,KAJN,EAIa,QAJb,EAKFA,OALE,CAKM,KALN,EAKa,OALb,CAAP;AAMH;;AAED,SAASC,MAAT,CAAgBC,KAAhB,EAAuBC,IAAvB,EAA6B;AACzB,MAAIC,GAAG,GAAG,EAAV;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,KAApB,EAA2B,EAAEG,CAA7B,EAAgC;AAC5BD,IAAAA,GAAG,IAAID,IAAI,CAACE,CAAD,CAAX;AACH;;AACD,SAAOD,GAAP;AACH;;AAED,SAASE,OAAT,CAAiBC,GAAjB,EAAsBJ,IAAtB,EAA4B;AACxB,MAAIC,GAAG,GAAG,EAAV;;AACA,MAAIG,GAAG,IAAI,IAAX,EAAiB;AACb,QAAIC,KAAK,CAACC,OAAN,CAAcF,GAAd,CAAJ,EAAwB;AACpB,WAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGE,GAAG,CAACG,MAAxB,EAAgC,EAAEL,CAAlC,EAAqC;AACjCD,QAAAA,GAAG,IAAID,IAAI,CAACI,GAAG,CAACF,CAAD,CAAJ,EAASA,CAAT,CAAX;AACH;AACJ,KAJD,MAIO,IAAI,OAAOE,GAAP,IAAc,QAAlB,EAA4B;AAC/BI,MAAAA,MAAM,CAACC,IAAP,CAAYL,GAAZ,EAAiBM,OAAjB,CAAyB,UAAUC,GAAV,EAAeT,CAAf,EAAkB;AACvCD,QAAAA,GAAG,IAAID,IAAI,CAACI,GAAG,CAACO,GAAD,CAAJ,EAAWA,GAAX,EAAgBT,CAAhB,CAAX;AACH,OAFD;AAGH;AACJ;;AACD,SAAOD,GAAP;AACH;;AAED,IAAIW,OAAO,GAAG,2DAAd;AAEA,IAAIC,IAAI,GAAGD,OAAO,GAAG,wnBAArB;;AAEA,IAAIE,IAAI,GAAG,UAAUC,GAAV,EAAe;AACxB,MAAIC,OAAO,GAAGD,GAAG,CAACC,OAAlB;AACA,MAAIC,cAAc,GAAGF,GAAG,CAACE,cAAzB;AACA,MAAIC,OAAO,GAAGH,GAAG,CAACG,OAAlB;AACA,MAAIC,QAAQ,GAAGJ,GAAG,CAACI,QAAnB;AAEA,SAAQP,OAAO,GAAG,wUAAV,GAAsVlB,GAAG,CAACsB,OAAD,CAAzV,GAAsW,uCAAtW,GAAiZtB,GAAG,CAACuB,cAAD,CAApZ,GAAwa,wEAAxa,GAAofvB,GAAG,CAACwB,OAAD,CAAvf,GAAogB,uEAApgB,GAA+kBxB,GAAG,CAACyB,QAAD,CAAllB,GAAgmB,2CAAxmB;AACD,CAPD;;AASA,IAAIC,GAAG,GAAG,UAAUL,GAAV,EAAe;AACvB,MAAIM,MAAM,GAAGN,GAAG,CAACM,MAAjB;AAEA,SAAQT,OAAO,GAAG,8dAAV,GAA4eS,MAAM,CAACd,MAAnf,GAA6f,+GAA7f,GAAgnBc,MAAM,CAACd,MAAvnB,GAAioB,wBAAjoB,GAA6pBJ,OAAO,CAACkB,MAAD,EAAS,UAAUC,KAAV,EAAiBpB,CAAjB,EAAoB;AAAE,WAAOoB,KAAK,CAACC,OAAN,CAAcC,KAAd,GACvsB,eAAgB9B,GAAG,CAAC4B,KAAK,CAACC,OAAN,CAAcC,KAAf,CAAnB,GAA4C,aAD2pB,GAEvsB,qBAAqBtB,CAAC,GAAG,CAAzB,IAA8B,aAFkqB;AAEjpB,GAFknB,CAApqB,GAGC,6MAHT;AAID,CAPD;;AASA,IAAIuB,aAAa,GAAG,UAAUV,GAAV,EAAe;AACjC,MAAIW,UAAU,GAAGX,GAAG,CAACW,UAArB;AACA,MAAIC,YAAY,GAAGZ,GAAG,CAACY,YAAvB;AACA,MAAIC,YAAY,GAAGb,GAAG,CAACa,YAAvB;AAEA,SAAQhB,OAAO,GAAG,q7BAAV,GAAm8Bd,MAAM,CAAC4B,UAAD,EAAa,UAAUG,GAAV,EAAe;AAAE,WAAQ,+CAA+CA,GAAG,GAAG,CAArD,IAA0D,qGAAlE;AAA2K,GAAzM,CAAz8B,GAAupC,MAAvpC,GAAiqC1B,OAAO,CAACwB,YAAD,EAAe,UAAUG,QAAV,EAAoB;AAAE,WAAQ,8BAA8BA,QAA9B,GAAyC,+FAAjD;AAAoJ,GAAzL,CAAxqC,GAAs2C,MAAt2C,GAAg3C3B,OAAO,CAACyB,YAAD,EAAe,UAAUE,QAAV,EAAoB;AAAE,WAAQ,uCAAuCA,QAAvC,GAAkD,gFAA1D;AAA8I,GAAnL,CAAv3C,GAA+iD,4QAAvjD;AACD,CAND;;AAQA,IAAIC,QAAQ,GAAG,UAAUhB,GAAV,EAAe;AAC5B,MAAIM,MAAM,GAAGN,GAAG,CAACM,MAAjB;AACA,MAAIW,WAAW,GAAGjB,GAAG,CAACiB,WAAtB;AACA,MAAIC,SAAS,GAAGlB,GAAG,CAACkB,SAApB;AAEA,SAAQrB,OAAO,GAAG,2bAAV,GAAycT,OAAO,CAACkB,MAAD,EAAS,UAAUN,GAAV,EAAeb,CAAf,EAAkB;AACjf,QAAIqB,OAAO,GAAGR,GAAG,CAACQ,OAAlB;AAEA,QAAIW,IAAI,GAAGX,OAAO,CAACW,IAAR,IAAgBX,OAAO,CAACC,KAAxB,IAAkC,WAAWtB,CAAC,GAAG,CAAf,CAA7C;AACA,WAAQ,mBAAoBR,GAAG,CAACwC,IAAD,CAAvB,GAAiC,eAAjC,IAAoDhC,CAAC,GAAG,CAAxD,IAA6D,eAA7D,IAAgFA,CAAC,GAAG,CAApF,IAAyF,OAAjG;AACD,GALud,CAAhd,GAKF,mBALE,IAKqB8B,WAAW,CAACzB,MAAZ,IAAsB0B,SAAS,CAAC1B,MAAhC,GAA0C,iCAAkCJ,OAAO,CAAC6B,WAAD,EAAc,UAAUG,CAAV,EAAa;AAAE,WAAQ,wFAAyFA,CAAC,CAACC,YAA3F,GAA2G,KAA3G,GAAoH1C,GAAG,CAAC2C,UAAU,CAACF,CAAC,CAACD,IAAH,CAAX,CAAvH,GAA+I,GAA/I,GAAsJxC,GAAG,CAACyC,CAAC,CAACG,IAAH,CAAzJ,GAAqK,GAArK,GAA4K5C,GAAG,CAACyC,CAAC,CAACI,EAAH,CAA/K,GAAyL,gBAAjM;AAAqN,GAAlP,CAAzC,GAAgS,UAAhS,GAA8SpC,OAAO,CAAC8B,SAAD,EAAY,UAAUE,CAAV,EAAa;AAAE,WAAQ,oCAAqCA,CAAC,CAACD,IAAvC,GAA+C,cAA/C,IAAiEC,CAAC,CAACK,MAAF,GAAW,CAAX,GAAe,CAAhF,IAAqF,KAArF,IAA8FL,CAAC,CAACC,YAAF,IAAkB,IAAlB,GAA0B,oBAAqBD,CAAC,CAACC,YAAvB,GAAuC,IAAjE,GAAyE,EAAvK,IAA6K,GAA7K,GAAoL1C,GAAG,CAACyC,CAAC,CAACM,KAAH,CAAvL,GAAoM,gBAA5M;AAAgO,GAA3P,CAArT,GAAqjB,uBAA/lB,GAA0nB,EAL/oB,IAKqpB,oEAL7pB;AAMD,CAXD;;AAaA,IAAIC,SAAS,GAAG,UAAUC,KAAV,EAAiB;AAC/B,MAAIC,aAAa,GAAGD,KAAK,CAACC,aAA1B;AACA,MAAIC,UAAU,GAAGF,KAAK,CAACE,UAAvB;AACA,MAAIC,OAAO,GAAGH,KAAK,CAACG,OAApB;AACA,MAAIC,QAAQ,GAAGJ,KAAK,CAACI,QAArB;AACA,MAAIC,IAAI,GAAGL,KAAK,CAACK,IAAjB;AACA,MAAIC,KAAK,GAAGN,KAAK,CAACM,KAAlB;AACA,MAAIC,UAAU,GAAGP,KAAK,CAACO,UAAvB;AACA,MAAIC,UAAU,GAAGR,KAAK,CAACQ,UAAvB;AACA,MAAIC,MAAM,GAAGT,KAAK,CAACS,MAAnB;AACA,MAAIC,aAAa,GAAGV,KAAK,CAACU,aAA1B;AACA,MAAIC,UAAU,GAAGX,KAAK,CAACW,UAAvB;AACA,MAAIC,WAAW,GAAGZ,KAAK,CAACY,WAAxB;AACA,MAAIC,kBAAkB,GAAGb,KAAK,CAACa,kBAA/B;AACA,MAAIC,GAAG,GAAGd,KAAK,CAACc,GAAhB;AACA,MAAIC,aAAa,GAAGf,KAAK,CAACe,aAA1B;AACA,MAAIC,OAAO,GAAGhB,KAAK,CAACgB,OAApB;AACA,MAAIC,OAAO,GAAGjB,KAAK,CAACiB,OAApB;AACA,MAAIC,OAAO,GAAGlB,KAAK,CAACkB,OAApB;AAEA,SAAQjD,OAAO,GAAG,oVAAV,IAAkWgD,OAAO,IAAIC,OAAX,GAAsB,yBAA0B9C,GAAG,CAAC6C,OAAO,GAAG,CAAX,EAAcC,OAAO,GAAG,CAAxB,CAA7B,GAA2D,OAAjF,GAA4F,EAA9b,IAAoc,uCAApc,IAA+eJ,GAAG,GAAG,iBAAH,GAAuB,EAAzgB,IAA+gB,GAA/gB,IAAshBR,KAAK,KAAK,CAAV,GAAc,iBAAd,GAAkC,EAAxjB,IAA8jB,wBAA9jB,IAA0lBI,aAAa,KAAK,KAAlB,GAA0B,mBAA1B,GAAgD,EAA1oB,IAAgpB,UAAhpB,IAA8pBR,UAAU,IAAID,aAAd,GAA+B,gDAAgDA,aAAa,GAAI,cAAcA,aAAd,GAA8B,IAAlC,GAA0C,EAAvG,IAA6G,aAA7G,IAA8HC,UAAU,GAAI,cAAcA,UAAd,GAA2B,IAA/B,GAAuC,EAA/K,IAAqL,2BAArL,IAAoNjD,MAAM,CAACkE,YAAP,CAAoB,MAAMlB,aAAa,IAAI,CAAvB,CAApB,KAAkD,CAACC,UAAU,IAAI,CAAf,IAAoB,CAAtE,CAApN,IAAgS,eAA/T,GAAkV,EAAh/B,IAAs/B,sFAAt/B,IAAglC,CAACE,QAAQ,CAACgB,gBAAV,GAA6B,kBAA7B,GAAkD,EAAloC,IAAwoC,sBAAxoC,IAAkqChB,QAAQ,CAACiB,SAAT,GAAqBjB,QAAQ,CAACiB,SAAT,GAAqB,IAA1C,GAAiD,EAAntC,IAAytC,WAAztC,IAAwuCjB,QAAQ,CAACkB,WAAT,GAAwB,uBAAwBC,OAAO,CAACnB,QAAQ,CAACkB,WAAV,CAA/B,GAAyD,IAAjF,GAAyF,EAAj0C,IAAu0C,YAAv0C,IAAu1CT,kBAAkB,IAAI,IAAtB,IAA+BV,OAAO,IAAIA,OAAO,CAACvC,MAAR,GAAiB,CAA3D,GAAiE,4BAA4B,CAACuC,OAAD,IAAY,CAACA,OAAO,CAACvC,MAArB,GAA+B,qDAAqDiD,kBAArD,GAA0E,oBAA1E,IAAkGT,QAAQ,CAACkB,WAAT,GAAwB,aAAcC,OAAO,CAACnB,QAAQ,CAACkB,WAAV,CAArB,GAA+C,IAAvE,GAA+E,EAAjL,IAAuL,MAAtN,GAAgO,EAA5P,IAAkQ,WAAlQ,GAAiR9D,OAAO,CAAC2C,OAAD,EAAU,UAAUqB,MAAV,EAAkBC,EAAlB,EAAsB;AACjtD,QAAIC,WAAW,GAAG,OAAOF,MAAM,CAAClB,KAAd,KAAwB,QAAxB,GAAmCkB,MAAM,CAAClB,KAAP,GAAe,CAAlD,GAAuDmB,EAAE,GAAG,CAA9E;;AACA,QAAID,MAAM,CAACG,KAAP,KAAiB,CAArB,EAAwB;AACtB,aAAQ,WAAWd,kBAAkB,IAAI,IAAtB,GAA8B,aAAaA,kBAAb,GAAkC,IAAhE,GAAwE,EAAnF,IAAyF,kCAAzF,GAA8Ha,WAA9H,GAA4I,WAA5I,GAA0JA,WAA1J,GAAwK,sCAAhL;AACD;;AACD,WAAQ,WAAWb,kBAAkB,IAAI,IAAtB,GAA8B,aAAaA,kBAAb,GAAkC,IAAhE,GAAwE,EAAnF,IAAyF,gCAAzF,GAA4Ha,WAA5H,GAA0I,WAA1I,GAAwJA,WAAxJ,GAAsK,8CAAtK,IAAwNF,MAAM,CAACI,SAAP,GAC5M,aAAe,CAACJ,MAAM,CAACG,KAAP,GAAe,CAAf,GAAmB,CAApB,IAAyB,CAAzB,GAA6B,GAA9B,GAAqC,GAAnD,GAA0D,kBADkJ,GAE5M,aAAcJ,OAAO,CAACC,MAAM,CAACG,KAAR,CAArB,GAAuC,IAFnD,IAE4D,KAFpE;AAGD,GARkrD,CAAxR,GAQr5C,gBARo1C,GAQh0C,EARvB,IAQ6B,2BAR7B,GAQ4DnE,OAAO,CAAC6C,IAAD,EAAO,UAAUwB,GAAV,EAAeC,EAAf,EAAmB;AAChG,QAAIC,QAAQ,GAAG,OAAOF,GAAG,CAACvB,KAAX,KAAqB,QAArB,GAAgCuB,GAAG,CAACvB,KAAJ,GAAY,CAA5C,GAAiDwB,EAAE,GAAG,CAArE;AACA,WAAQ,yBAAyBC,QAAzB,GAAoC,6CAApC,IAAqFF,GAAG,CAACG,KAAJ,GAAa,oBAAqBH,GAAG,CAACG,KAAzB,GAAkC,IAA/C,GAAuD,EAA5I,IAAkJ,kBAAlJ,IAAwKH,GAAG,CAACI,MAAJ,KAAe,CAAf,GAAmB,YAAnB,GACpJJ,GAAG,CAACI,MAAJ,GAAc,UAAWC,QAAQ,CAACL,GAAG,CAACI,MAAL,CAAnB,GAAmC,uBAAjD,GAA4E,EADhG,IACsG,gBADtG,GAC0HzE,OAAO,CAACqE,GAAG,CAACxB,IAAL,EAAW,UAAU8B,IAAV,EAAgB;AAAE,aAAQ,2BAA4BA,IAAI,CAAC/D,GAAjC,GAAwC,KAAxC,IAAiD+D,IAAI,CAACC,KAAL,GAAc,SAAUD,IAAI,CAACC,KAAf,GAAwB,IAAtC,GAA8C,EAA/F,IAAqG,GAArG,IAA4GD,IAAI,CAAChG,IAAL,GAAa,SAAUgG,IAAI,CAAChG,IAAf,GAAuB,IAApC,GAA4C,EAAxJ,IAA8J,oBAA9J,IAAsLgG,IAAI,CAACE,OAAL,IAAgB,IAAhB,GAAuBC,YAAY,CAACH,IAAI,CAACE,OAAN,CAAnC,GAAoD,EAA1O,IAAgP,mBAAhP,IAAuQF,IAAI,CAACrC,KAAL,IAAc,IAAd,GAAsB,QAAS/C,GAAG,CAACoF,IAAI,CAACrC,KAAN,CAAZ,GAA4B,MAAlD,GAA4D,EAAnU,IAAyU,qBAAjV;AAA0W,KAAvY,CADjI,GAC6gB,4BADrhB;AACojB,GAH9e,CARnE,GAWsjB,0BAXtjB,IAWolBU,UAAU,GAAI,uBAAwBA,UAAU,CAACb,IAAnC,GAA2C,GAA3C,GAAkDa,UAAU,CAACZ,EAA7D,GAAmE,MAAvE,GACtlBa,MAAM,GAAG8B,kBAAkB,CAAC9B,MAAD,CAArB,GAAgC,EAZ9C,IAYoD,SAZpD,IAYiEF,UAAU,CAAC3C,MAAX,GAAqB,gCAAiC2C,UAAU,CAAC3C,MAA5C,GAAsD,cAAtD,GAAwEJ,OAAO,CAAC+C,UAAD,EAAa,UAAUnC,GAAV,EAAe;AAAE,WAAQ,sBAAsBA,GAAtB,GAA4B,MAApC;AAA8C,GAA5E,CAA/E,GAAgK,sBAArL,GAA+M,EAZhR,IAYsR,SAZtR,IAYmSwC,WAAW,CAAChD,MAAZ,GAAsB,sCAAuCJ,OAAO,CAACoD,WAAD,EAAc,UAAU5D,GAAV,EAAe;AAAE,WAAQ,wCAAyCA,GAAG,CAACwF,KAAJ,CAAUC,IAAV,CAAe,GAAf,CAAzC,GAAgE,kDAAhE,GAAsHzF,GAAG,CAAC0F,gBAA1H,GAA8I,sCAA9I,GAAwL3F,GAAG,CAACC,GAAG,CAACb,IAAL,CAA3L,GAAyM,+BAAzM,IAA4Oa,GAAG,CAACb,IAAJ,KAAa,MAAb,GAAuB,gBAAiBY,GAAG,CAACC,GAAG,CAAC2F,QAAL,CAApB,GAAsC,IAA7D,GAAqE,EAAjT,IAAuT,0CAAvT,GAAqW3F,GAAG,CAAC4F,UAAzW,GAAuX,8CAAvX,GAAya5F,GAAG,CAAC6F,YAA7a,GAA6b,+BAA7b,IAAge7F,GAAG,CAAC8F,KAAJ,GAAa,aAAc/F,GAAG,CAACC,GAAG,CAAC8F,KAAL,CAAjB,GAAgC,IAA7C,GAAqD,EAArhB,IAA2hB,6BAA3hB,IAA4jB9F,GAAG,CAAC+F,UAAJ,GAAkB,kBAAmBhG,GAAG,CAACC,GAAG,CAAC+F,UAAL,CAAtB,GAA0C,IAA5D,GAAoE,EAAhoB,IAAsoB,gBAAtoB,IAA0pB/F,GAAG,CAACgG,QAAJ,GAAgB,eAAgBjG,GAAG,CAACC,GAAG,CAACgG,QAAL,CAAnB,GAAqC,aAArD,GAAsE,EAAhuB,IAAsuB,eAAtuB,IAAyvBhG,GAAG,CAACiG,QAAJ,GAAgB,eAAgBlG,GAAG,CAACC,GAAG,CAACiG,QAAL,CAAnB,GAAqC,aAArD,GAAsE,EAA/zB,IAAq0B,8BAA70B;AAA+2B,GAA94B,CAA9C,GAAi8B,2BAAv9B,GAAs/B,EAZzxC,IAY+xC,SAZ/xC,IAY4yCtC,UAAU,CAAC/C,MAAX,GAAqB,iCAAkCJ,OAAO,CAACmD,UAAD,EAAa,UAAUuC,IAAV,EAAgB;AAAE,WAAQ,iCAAkCA,IAAI,CAAC9E,GAAvC,GAA8C,YAA9C,GAA8D8E,IAAI,CAACC,GAAnE,GAA0E,MAAlF;AAA4F,GAA3H,CAAzC,GAAyK,sBAA9L,GAAwN,EAZpgD,IAY0gD,mHAZ1gD,IAYioDnC,OAAO,GAAI,qBAAqBA,OAArB,GAA+B,MAAnC,GAA6C,EAZrrD,IAY2rD,OAZ3rD,IAYssDD,aAAa,GAAI,2BAA2BA,aAA3B,GAA2C,MAA/C,GAAyD,EAZ5wD,IAYkxD,gBAZ1xD;AAaD,CAjCD;;AAmCA,IAAIqC,aAAa,GAAG,UAAUhF,GAAV,EAAe;AACjC,MAAIhB,KAAK,GAAGgB,GAAG,CAAChB,KAAhB;AAEA,SAAQa,OAAO,GAAG,8FAAV,GAA4Gd,MAAM,CAACC,KAAD,EAAQ,UAAU8B,GAAV,EAAe;AAAE,WAAQ,kCAAkCA,GAAG,GAAG,CAAxC,IAA6C,qHAA7C,IAAsKA,GAAG,GAAG,CAA5K,IAAiL,WAAzL;AAAwM,GAAjO,CAAlH,GAAwV,4BAAxV,IAAwX9B,KAAK,GAAG,CAAhY,IAAqY,2IAArY,IAAohBA,KAAK,GAAG,CAA5hB,IAAiiB,iJAAziB;AACD,CAJD;;AAMA,IAAIiG,cAAc,GAAG,UAAUjF,GAAV,EAAe;AAClC,MAAIuC,UAAU,GAAGvC,GAAG,CAACuC,UAArB;AACA,MAAI2C,QAAQ,GAAGlF,GAAG,CAACkF,QAAnB;AACA,MAAIC,UAAU,GAAGnF,GAAG,CAACmF,UAArB;AACA,MAAIC,QAAQ,GAAGpF,GAAG,CAACoF,QAAnB;AAEA,SAAQvF,OAAO,GAAG,8FAAV,GAA4GT,OAAO,CAACmD,UAAD,EAAa,UAAUuC,IAAV,EAAgB;AAAE,WAAQ,8BAA+BA,IAAI,CAACC,GAApC,GAA2C,qGAA3C,GAAoJpG,GAAG,CAACmG,IAAI,CAACO,MAAN,CAAvJ,GAAwK,+BAAhL;AAAmN,GAAlP,CAAnH,GAA0W,MAA1W,IAAoX,CAACH,QAAQ,CAAC1F,MAAV,GAAmB,EAAnB,GAAyB,qCAAqC2F,UAArC,GAAkD,+GAAlD,GAAoKA,UAApK,GAAiL,sCAAjL,GAA0NA,UAA1N,GAAuO,4HAAvO,GAAsWA,UAAtW,GAAmX,UAAhwB,IAA+wB,MAA/wB,IAAyxB,CAACC,QAAQ,CAAC5F,MAAV,GAAmB,EAAnB,GAAyB,iCAAiC2F,UAAjC,GAA8C,sHAA9C,GAAuKA,UAAvK,GAAoL,UAAt+B,IAAq/B,oBAA7/B;AACD,CAPD;;AASA,IAAIG,YAAY,GAAG,UAAUtF,GAAV,EAAe;AAChC,MAAIkF,QAAQ,GAAGlF,GAAG,CAACkF,QAAnB;AAEA,SAAQrF,OAAO,GAAG,2JAAV,GAAyKT,OAAO,CAAC8F,QAAD,EAAW,UAAUK,OAAV,EAAmB;AAAE,WAAQ,4BAA6BA,OAAO,CAACvF,GAArC,GAA4C,4PAA5C,GAA4SrB,GAAG,CAAC4G,OAAO,CAACC,IAAT,CAA/S,GAAiU,yDAAzU;AAAsY,GAAta,CAAhL,GAA2lB,iCAAnmB;AACD,CAJD;;AAMA,IAAIC,cAAc,GAAG,UAAUzF,GAAV,EAAe;AAClC,MAAIkF,QAAQ,GAAGlF,GAAG,CAACkF,QAAnB;AAEA,SAAQ,+XAAgY9F,OAAO,CAAC8F,QAAD,EAAW,UAAUK,OAAV,EAAmB;AAAE,WAAQ,mSAAoSA,OAAO,CAACG,MAA5S,GAAsT,sEAAtT,GAAgYH,OAAO,CAAC9B,GAAxY,GAA+Y,8BAA/Y,GAAib8B,OAAO,CAACI,GAAzb,GAAgc,oDAAxc;AAAggB,GAAhiB,CAAvY,GAA46B,UAAp7B;AACD,CAJD;;AAMA,IAAIC,YAAY,GAAG,UAAUR,QAAV,EAAoB;AAAE,SAAQvF,OAAO,GAAG,4QAAV,GAA0RT,OAAO,CAACgG,QAAD,EAAW,UAAUxC,OAAV,EAAmBV,KAAnB,EAA0B;AAAE,WAAQ,sFAAuFU,OAAO,CAAC+C,GAA/F,GAAsG,kCAAtG,GAA4I/C,OAAO,CAACiD,SAApJ,GAAiK,kCAAjK,GAAuMjD,OAAO,CAACa,GAA/M,GAAsN,kCAAtN,GAA4Pb,OAAO,CAACkD,SAApQ,GAAiR,wDAAjR,GAA6UlD,OAAO,CAACW,KAArV,GAA8V,UAA9V,GAA4WX,OAAO,CAACiB,MAApX,GAA8X,2EAA9X,IAA6c3B,KAAK,GAAG,CAArd,IAA0d,oBAA1d,IAAkfA,KAAK,GAAG,CAA1f,IAA+f,+GAA/f,GAAknBU,OAAO,CAACmD,OAA1nB,GAAqoB,8SAA7oB;AAA+7B,GAAt+B,CAAjS,GAA4wC,eAApxC;AAAuyC,CAAh1C;;AAEA,IAAIC,iBAAiB,GAAG,UAAUC,IAAV,EAAgB;AAAE,SAAQpG,OAAO,GAAG,8FAAV,GAA4GT,OAAO,CAAC6G,IAAD,EAAO,UAAUC,GAAV,EAAe;AAAE,WAAQ,8BAA+BA,GAAG,CAACnB,GAAnC,GAA0C,iGAA1C,GAA+ImB,GAAG,CAACb,MAAnJ,GAA6J,MAArK;AAA+K,GAAvM,CAAnH,GAA+T,oBAAvU;AAA+V,CAAzY;;AAEA,IAAIc,cAAc,GAAG,UAAUnG,GAAV,EAAe;AAClC,MAAIhB,KAAK,GAAGgB,GAAG,CAAChB,KAAhB;AACA,MAAIoH,WAAW,GAAGpG,GAAG,CAACoG,WAAtB;AACA,MAAIC,OAAO,GAAGrG,GAAG,CAACqG,OAAlB;AAEA,SAAQxG,OAAO,GAAG,qFAAV,GAAkGb,KAAlG,GAA0G,mBAA1G,GAAgIoH,WAAhI,GAA8I,SAA9I,GAA2JhH,OAAO,CAACK,MAAM,CAACC,IAAP,CAAY2G,OAAZ,CAAD,EAAuB,UAAUnE,KAAV,EAAiB;AAAE,WAAQ,yCAA0CvD,GAAG,CAACuD,KAAK,CAACoE,SAAN,CAAgB,CAAhB,CAAD,CAA7C,GAAqE,WAA7E;AAA4F,GAAtI,CAAlK,GAA6S,UAArT;AACD,CAND;;AAQA,IAAIC,MAAM,GAAG,UAAUvG,GAAV,EAAe;AAC1B,MAAIwG,OAAO,GAAGxG,GAAG,CAACwG,OAAlB;AACA,MAAIC,KAAK,GAAGzG,GAAG,CAACyG,KAAhB;AACA,MAAIC,KAAK,GAAG1G,GAAG,CAAC0G,KAAhB;AACA,MAAIC,OAAO,GAAG3G,GAAG,CAAC2G,OAAlB;AACA,MAAIC,MAAM,GAAG5G,GAAG,CAAC4G,MAAjB;AAEA,SAAQ/G,OAAO,GAAG,ySAAV,GAAuT2G,OAAO,CAAChH,MAA/T,GAAyU,SAAzU,GAAsVJ,OAAO,CAACoH,OAAD,EAAU,UAAUK,MAAV,EAAkBC,EAAlB,EAAsB;AAAE,WAAQ,gCAAiCnI,GAAG,CAACkI,MAAM,CAACA,MAAR,CAApC,GAAuD,gBAAvD,IAA2E,MAAMC,EAAjF,IAAuF,OAA/F;AAA0G,GAA5I,CAA7V,GAA8e,mCAA9e,IAAqhBL,KAAK,CAACjH,MAAN,GAAe,CAApiB,IAAyiB,kNAAziB,GAA+vBJ,OAAO,CAACqH,KAAD,EAAQ,UAAUM,IAAV,EAAgB;AAAE,WAAQ,0BAA0BA,IAAI,CAACC,IAAL,GAAY,MAAZ,GAAqB,EAA/C,IAAqD,UAArD,IAAmED,IAAI,CAACE,MAAL,GAAc,MAAd,GAAuB,EAA1F,IAAgG,UAAhG,IAA8GF,IAAI,CAACG,SAAL,GAAiB,MAAjB,GAA0B,EAAxI,IAA8I,oBAA9I,IAAsKH,IAAI,CAACI,QAAL,IAAiB,EAAvL,IAA6L,eAA7L,IAAgNJ,IAAI,CAACK,KAAL,GAAc,kBAAmBzI,GAAG,CAACoI,IAAI,CAACK,KAAN,CAAtB,GAAsC,OAApD,GAA+D,qBAA/Q,IAAwS,UAAxS,IAAsTL,IAAI,CAACM,UAAL,GAAmB,2BAA4B1I,GAAG,CAACoI,IAAI,CAACM,UAAN,CAA/B,GAAoD,6CAAvE,GAAwH,4GAA9a,IAA8hB,eAAtiB;AAAyjB,GAAnlB,CAAtwB,GAA81C,iCAA91C,IAAm4CX,KAAK,CAAClH,MAAN,GAAe,CAAl5C,IAAu5C,8HAAv5C,GAAyhDJ,OAAO,CAACsH,KAAD,EAAQ,UAAUY,IAAV,EAAgB;AAAE,WAAQ,cAAcA,IAAI,CAACC,UAAL,GAAmB,mGAAoG5I,GAAG,CAAC2I,IAAI,CAACC,UAAN,CAAvG,GAA4H,yDAA/I,GAA4M,EAA1N,CAAR;AAAyO,GAAnQ,CAAhiD,GAAwyD,mCAAxyD,IAA+0DZ,OAAO,CAACnH,MAAR,GAAiB,CAAh2D,IAAq2D,2EAAr2D,GAAo7DJ,OAAO,CAACuH,OAAD,EAAUa,cAAV,CAA37D,GAAw9D,2IAAx9D,IAAumEZ,MAAM,CAACpH,MAAP,GAAgB,CAAvnE,IAA4nE,0FAA5nE,GAA0tEJ,OAAO,CAACwH,MAAD,EAAS,UAAU5C,KAAV,EAAiB;AAAE,WAAQ,wCAAwCA,KAAK,CAACyD,MAAN,GAAgB,cAAezD,KAAK,CAACyD,MAArB,GAA+B,oBAA/C,GAAuE,EAA/G,IAAqH,cAArH,IAAuIzD,KAAK,CAAC0D,MAAN,GAAgB,cAAe1D,KAAK,CAAC0D,MAArB,GAA+B,oBAA/C,GAAuE,EAA9M,IAAoN,cAApN,IAAsO1D,KAAK,CAAC2D,QAAN,GAAkB,gBAAiB3D,KAAK,CAAC2D,QAAvB,GAAmC,4BAArD,GAAqF,EAA3T,IAAiU,cAAjU,IAAmV3D,KAAK,CAAC4D,SAAN,IAAmB5D,KAAK,CAAC6D,aAAzB,IAA0C7D,KAAK,CAAC8D,IAAhD,GAAuD,oBAAvD,GAA8E,EAAja,IAAua,cAAva,IAAyb9D,KAAK,CAAC+D,QAAN,GAAkB,gBAAiB/D,KAAK,CAAC+D,QAAvB,GAAmC,sBAArD,GAA+E,EAAxgB,IAA8gB,aAA9gB,IAA+hB/D,KAAK,CAAC4D,SAAN,IAAmB5D,KAAK,CAAC6D,aAAzB,IAA0C7D,KAAK,CAAC8D,IAAhD,GAAwD,sCAAsC9D,KAAK,CAAC4D,SAAN,GAAmB,kBAAmBjJ,GAAG,CAACqF,KAAK,CAAC4D,SAAP,CAAtB,GAA2C,IAA9D,GAAsE,EAA5G,IAAkH,cAAlH,IAAoI5D,KAAK,CAAC6D,aAAN,GAAuB,gBAAiBlJ,GAAG,CAACqF,KAAK,CAAC6D,aAAP,CAApB,GAA6C,IAApE,GAA4E,EAAhN,IAAsN,cAAtN,IAAwO7D,KAAK,CAACgE,MAAN,GAAgB,cAAerJ,GAAG,CAACqF,KAAK,CAACgE,MAAP,CAAlB,GAAoC,IAApD,GAA4D,EAApS,IAA0S,cAA1S,IAA4ThE,KAAK,CAAC8D,IAAN,GAAa,cAAb,GAA8B,EAA1V,IAAgW,eAAxZ,GAA2a,EAA18B,IAAg9B,qBAAx9B;AAAi/B,GAA7gC,CAAjuE,GAAmvG,gRAA3vG;AACD,CARD;;AAUA,SAAS5D,YAAT,CAAsBD,OAAtB,EAA+B;AAC3B,MAAI,OAAOA,OAAP,IAAkB,QAAtB,EAAgC;AAC5B,WAAQ,QAAStF,GAAG,CAACsF,OAAD,CAAZ,GAAyB,MAAjC;AACH,GAH0B,CAI3B;;;AACA,SAAQ,0BAA2BA,OAAO,CAACjE,GAAnC,GAA0C,KAA1C,GAAmDrB,GAAG,CAACsF,OAAO,CAACgE,GAAT,CAAtD,GAAuE,MAA/E;AACH;;AAED,SAASC,OAAT,CAAiBC,QAAjB,EAA2B;AACxB,MAAIC,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWH,QAAQ,GAAG,EAAtB,IAA4B,CAAzC;AAEA,SAAO,CAACC,MAAM,IAAI,CAAV,GAAcF,OAAO,CAACE,MAAD,CAArB,GAAgC,EAAjC,IAAuCvJ,MAAM,CAACkE,YAAP,CAAoB,KAAMoF,QAAQ,GAAG,EAArC,CAA9C;AACF;;AAED,SAASnI,GAAT,CAAa2D,QAAb,EAAuBwE,QAAvB,EAAiC;AAC7B,SAAOD,OAAO,CAACC,QAAD,CAAP,IAAqBxE,QAAQ,GAAG,CAAhC,CAAP;AACH;;AAED,SAAS4E,IAAT,CAAc5E,QAAd,EAAwBwE,QAAxB,EAAkC;AAC9B,SAAO,MAAMD,OAAO,CAACC,QAAD,CAAb,GAA0B,GAA1B,IAAiCxE,QAAQ,GAAG,CAA5C,CAAP;AACH;;AAED,SAAS6E,cAAT,CAAwBhI,OAAxB,EAAiC;AAC7B,MAAIsB,UAAU,GAAGtB,OAAO,CAACsB,UAAR,IAAsB,CAACtB,OAAO,CAACiI,UAAR,IAAsB,EAAvB,EAA2BC,QAAjD,IAA6D,CAA9E;AACA,SAAO5G,UAAU,GAAG,CAApB;AACH;;AAED,SAASqB,OAAT,CAAiBwF,EAAjB,EAAqB;AACjB,MAAIC,iBAAiB,GAAG,CAAxB;AACA,SAAQD,EAAE,GAAGC,iBAAN,GAA4BP,IAAI,CAACC,KAAL,CAAW,MAAMM,iBAAjB,IAAsC,GAAzE;AACH;;AAED,SAAS9E,QAAT,CAAkB6E,EAAlB,EAAsB;AAClB,SAAOA,EAAE,GAAG,IAAZ;AACH;;AAED,SAASE,eAAT,CAAyBnH,KAAzB,EAAgC;AAC5B,SAAO7C,MAAM,CAAC6C,KAAD,CAAN,CACF5C,OADE,CACM,+BADN,EACuC,EADvC,EAC2C;AAD3C,GAEFA,OAFE,CAEM,QAFN,EAEgB,MAFhB,CAAP,CAD4B,CAGsB;AACrD;;AAED,IAAIgK,SAAS,GAAG,SAASA,SAAT,CAAmBtI,OAAnB,EAA4BuI,aAA5B,EAA2CnC,MAA3C,EAAmDD,OAAnD,EAA4D;AACtE,OAAKnG,OAAL,GAAeA,OAAf;AACA,OAAKwI,QAAL,GAAgBD,aAAhB;AACA,OAAKE,OAAL,GAAerC,MAAf;AACA,OAAKsC,QAAL,GAAgBvC,OAAhB;AACA,OAAKwC,YAAL,GAAoB,EAApB;AACA,OAAKC,SAAL,GAAiB,EAAjB;AACA,OAAKC,SAAL,GAAiB7I,OAAO,CAAC4E,QAAR,IAAoB,EAArC;AACA,OAAKkE,WAAL,GAAmB,CAAC,KAAK9I,OAAL,CAAa+B,UAAb,IAA2B,EAA5B,EAAgChF,GAAhC,CACf,UAAUuH,IAAV,EAAgB3F,CAAhB,EAAmB;AAAE,WAAOM,MAAM,CAAC8J,MAAP,CAAc,EAAd,EAAkBzE,IAAlB,EAAwB;AAAEC,MAAAA,GAAG,EAAG,SAAS5F;AAAjB,KAAxB,CAAP;AAAwD,GAD9D,CAAnB;AAEH,CAVH;;AAYE2J,SAAS,CAACU,SAAV,CAAoBC,SAApB,GAAgC,SAASA,SAAT,GAAsB;AAClD,MAAIlH,UAAU,GAAG,KAAK+G,WAAtB;AACA,MAAIpE,QAAQ,GAAG,KAAKkE,SAApB;AACA,MAAIhE,QAAQ,GAAG,KAAKiE,SAApB;;AAEA,MAAI9G,UAAU,CAAC/C,MAAX,IAAqB0F,QAAQ,CAAC1F,MAA9B,IAAwC4F,QAAQ,CAAC5F,MAArD,EAA6D;AACzD,WAAOyF,cAAc,CAAC;AAClB1C,MAAAA,UAAU,EAAGA,UADK;AAElB2C,MAAAA,QAAQ,EAAGA,QAFO;AAGlBC,MAAAA,UAAU,EAAG,KAAK3E,OAAL,CAAa2E,UAHR;AAIlBC,MAAAA,QAAQ,EAAGA;AAJO,KAAD,CAArB;AAMH;AACJ,CAbD;;AAeA0D,SAAS,CAACU,SAAV,CAAoBE,KAApB,GAA4B,SAASA,KAAT,CAAgBxH,KAAhB,EAAuB;AAC7C,MAAIyH,MAAM,GAAG,IAAb;AAEF,MAAIxH,UAAU,GAAG,KAAK3B,OAAL,CAAaoJ,WAAb,IAA4B,EAA7C;AACA,MAAIC,IAAI,GAAG,KAAKrJ,OAAL,CAAaqJ,IAAb,IAAqB,EAAhC;AACA,MAAI5H,IAAI,GAAG6H,OAAO,CAACD,IAAD,EAAO1H,UAAP,CAAlB;;AAEA,OAAK4H,UAAL,CAAgB9H,IAAhB;;AAEA,MAAIG,UAAU,GAAG,KAAK5B,OAAL,CAAa6B,MAA9B;AACA,MAAIA,MAAJ;;AACA,MAAID,UAAU,IAAK,OAAOA,UAAU,CAACb,IAAlB,KAA2B,QAA1C,IAAwD,OAAOa,UAAU,CAACZ,EAAlB,KAAyB,QAArF,EAAgG;AAC5F;AACAY,IAAAA,UAAU,GAAG;AACTb,MAAAA,IAAI,EAAEvB,GAAG,CAACwI,cAAc,CAAC,KAAKhI,OAAN,CAAf,EAA+B4B,UAAU,CAACb,IAA1C,CADA;AAETC,MAAAA,EAAE,EAAExB,GAAG,CAACwI,cAAc,CAAC,KAAKhI,OAAN,CAAf,EAA+B4B,UAAU,CAACZ,EAA1C;AAFE,KAAb;AAIH,GAND,MAMO,IAAIY,UAAU,IAAIA,UAAU,CAACpC,GAAzB,IAAgCoC,UAAU,CAACL,OAA/C,EAAwD;AAC3D;AACAM,IAAAA,MAAM,GAAGD,UAAT;AACAA,IAAAA,UAAU,GAAG,IAAb;AACH;;AAED,MAAII,WAAW,GAAG,EAAlB;;AACA,OAAK,IAAIrD,CAAT,IAAcwK,MAAM,CAACR,YAArB,EAAmC;AAC/B,QAAI1J,MAAM,CAAC+J,SAAP,CAAiBQ,cAAjB,CAAgCC,IAAhC,CAAqCN,MAAM,CAACR,YAA5C,EAA0DhK,CAA1D,CAAJ,EAAkE;AAC9DqD,MAAAA,WAAW,CAAC0H,IAAZ,CAAiBP,MAAM,CAACR,YAAP,CAAoBhK,CAApB,CAAjB;AACH;AACJ;;AAED,MAAIsD,kBAAkB,GAAG,IAAzB;;AACA,MAAI,KAAKjC,OAAL,CAAa2J,gBAAjB,EAAmC;AAC/B1H,IAAAA,kBAAkB,GAAG,KAAK2H,YAAL,CAAkB,KAAK5J,OAAL,CAAa2J,gBAA/B,CAArB;AACH;;AAED,MAAI1B,UAAU,GAAG,KAAKjI,OAAL,CAAaiI,UAAb,IAA2B,EAA5C;AACA,MAAIzG,QAAQ,GAAG,KAAKxB,OAAL,CAAawB,QAAb,IAAyB,EAAxC;AACA,MAAIa,OAAO,GAAG,KAAKrC,OAAL,CAAaqJ,IAAb,GAAoB,KAAKQ,WAAL,EAApB,GAAyC,CAAvD;AACA,MAAIvH,OAAO,GAAG,KAAKtC,OAAL,CAAaqJ,IAAb,GAAoB,KAAKS,WAAL,EAApB,GAAyC,CAAvD;AAEA,SAAO3I,SAAS,CAAC;AACbE,IAAAA,aAAa,EAAE,KAAKrB,OAAL,CAAaqB,aAAb,IAA8B4G,UAAU,CAAC8B,QAD3C;AAEbzI,IAAAA,UAAU,EAAE,KAAKtB,OAAL,CAAasB,UAAb,IAA2B2G,UAAU,CAACC,QAFrC;AAGb3G,IAAAA,OAAO,EAAE,KAAKvB,OAAL,CAAauB,OAHT;AAIbC,IAAAA,QAAQ,EAAEA,QAJG;AAKbC,IAAAA,IAAI,EAAEA,IALO;AAMbC,IAAAA,KAAK,EAAEA,KANM;AAObC,IAAAA,UAAU,EAAEA,UAPC;AAQbC,IAAAA,UAAU,EAAEA,UARC;AASbC,IAAAA,MAAM,EAAEA,MATK;AAUbC,IAAAA,aAAa,EAAE,KAAK9B,OAAL,CAAa8B,aAVf;AAWbC,IAAAA,UAAU,EAAE,KAAK+G,WAXJ;AAYb9G,IAAAA,WAAW,EAAEA,WAZA;AAabC,IAAAA,kBAAkB,EAAEA,kBAbP;AAcbC,IAAAA,GAAG,EAAE,KAAKlC,OAAL,CAAakC,GAAb,KAAqB8H,SAArB,GAAiC,KAAKhK,OAAL,CAAakC,GAA9C,GAAoDV,QAAQ,CAACU,GAdrD;AAebC,IAAAA,aAAa,EAAE,KAAKyG,SAAL,CAAe5J,MAAf,GAAyB,QAAS,KAAKgB,OAAL,CAAa2E,UAA/C,GAA8D,IAfhE;AAgBbvC,IAAAA,OAAO,EAAE,KAAKyG,SAAL,CAAe7J,MAAf,GAAyB,QAAS,KAAKgB,OAAL,CAAa2E,UAA/C,GAA8D,IAhB1D;AAiBbtC,IAAAA,OAAO,EAAEA,OAjBI;AAkBbC,IAAAA,OAAO,EAAEA;AAlBI,GAAD,CAAhB;AAoBH,CA5DD;;AA8DAgG,SAAS,CAACU,SAAV,CAAoBiB,WAApB,GAAkC,SAASA,WAAT,GAAwB;AACtD,MAAI,KAAKrB,SAAL,CAAe5J,MAAnB,EAA2B;AACvB,WAAO8F,YAAY,CAAC;AAAEJ,MAAAA,QAAQ,EAAE,KAAKkE;AAAjB,KAAD,CAAnB;AACH;AACJ,CAJD;;AAMAN,SAAS,CAACU,SAAV,CAAoBkB,WAApB,GAAkC,SAASA,WAAT,CAAsBC,MAAtB,EAA8B;AAC5D,MAAI,KAAKtB,SAAL,CAAe7J,MAAnB,EAA2B;AACvB,QAAIyG,IAAI,GAAG,EAAX;;AACA,QAAI2E,IAAI,GAAG,KAAKvB,SAAL,CAAe9L,GAAf,CAAmB,UAAUsN,GAAV,EAAe;AACzC,UAAI7K,GAAG,GAAG8K,QAAQ,CAACD,GAAG,CAACE,WAAL,CAAlB;AACA,UAAIC,GAAG,GAAG/E,IAAI,CAAC4E,GAAG,CAACI,KAAL,CAAd;;AACA,UAAI,CAACD,GAAL,EAAU;AACNA,QAAAA,GAAG,GAAG/E,IAAI,CAAC4E,GAAG,CAACI,KAAL,CAAJ,GAAkB;AACpBlG,UAAAA,GAAG,EAAG,QAAS8F,GAAG,CAACI,KADC;AAEpB5F,UAAAA,MAAM,EAAEsF,MAAM,CAACE,GAAG,CAACI,KAAL,CAAN,CAAkB5F;AAFN,SAAxB;AAIH;;AACD,aAAO;AACHM,QAAAA,GAAG,EAAO3F,GAAG,CAAC2F,GADX;AAEHE,QAAAA,SAAS,EAAGqF,aAAa,CAACL,GAAG,CAACM,OAAL,CAFtB;AAGH1H,QAAAA,GAAG,EAAOzD,GAAG,CAACyD,GAHX;AAIHqC,QAAAA,SAAS,EAAGoF,aAAa,CAACL,GAAG,CAACO,OAAL,CAJtB;AAKH7H,QAAAA,KAAK,EAAK2H,aAAa,CAACL,GAAG,CAACtH,KAAL,CALpB;AAMHM,QAAAA,MAAM,EAAIqH,aAAa,CAACL,GAAG,CAAChH,MAAL,CANpB;AAOHkC,QAAAA,OAAO,EAAGiF,GAAG,CAACjG;AAPX,OAAP;AASH,KAlBU,CAAX;;AAmBA,WAAO;AACH6F,MAAAA,IAAI,EAAEhF,YAAY,CAACgF,IAAD,CADf;AAEH3E,MAAAA,IAAI,EAAED,iBAAiB,CAACC,IAAD;AAFpB,KAAP;AAIH;AACJ,CA3BD;;AA6BA6C,SAAS,CAACU,SAAV,CAAoB7G,aAApB,GAAoC,SAASA,aAAT,GAA0B;AAC1D,MAAI,KAAKyG,SAAL,CAAe5J,MAAnB,EAA2B;AACvB,WAAOiG,cAAc,CAAC;AAAEP,MAAAA,QAAQ,EAAE,KAAKkE;AAAjB,KAAD,CAArB;AACH;AACJ,CAJD;;AAMAN,SAAS,CAACU,SAAV,CAAoB6B,aAApB,GAAoC,SAASA,aAAT,CAAwB3J,KAAxB,EAA+B;AAC/D,MAAI9B,GAAG,GAAG,MAAM8B,KAAhB;AACA,MAAIQ,KAAK,GAAG,KAAK8G,QAAL,CAAc3C,OAAd,CAAsBzG,GAAtB,CAAZ;AACA,MAAI0L,MAAJ;;AAEA,MAAIpJ,KAAK,KAAKsI,SAAd,EAAyB;AACrBc,IAAAA,MAAM,GAAGpJ,KAAT;AACH,GAFD,MAEO;AACHoJ,IAAAA,MAAM,GAAG,KAAKtC,QAAL,CAAc3C,OAAd,CAAsBzG,GAAtB,IAA6B,KAAKoJ,QAAL,CAAc5C,WAApD;AACA,SAAK4C,QAAL,CAAc5C,WAAd;AACH;;AAED,OAAK4C,QAAL,CAAchK,KAAd;AAEA,SAAOsM,MAAP;AACH,CAfD;;AAiBAxC,SAAS,CAACU,SAAV,CAAoBY,YAApB,GAAmC,SAASA,YAAT,CAAuBpG,KAAvB,EAA8B;AAC7D,MAAIuH,IAAI,GAAG/M,IAAI,CAACgN,SAAL,CAAexH,KAAf,CAAX;;AAEA,MAAIuH,IAAI,KAAK,IAAb,EAAmB;AACf,WAAO,CAAP;AACH;;AAED,MAAIrJ,KAAK,GAAG9D,OAAO,CAACmN,IAAD,EAAO,KAAKtC,OAAZ,CAAnB;;AAEA,MAAI/G,KAAK,GAAG,CAAZ,EAAe;AACXA,IAAAA,KAAK,GAAG,KAAK+G,OAAL,CAAaiB,IAAb,CAAkBqB,IAAlB,IAA0B,CAAlC;AACH,GAX4D,CAa7D;;;AACA,SAAOrJ,KAAK,GAAG,CAAf;AACH,CAfD;;AAiBA4G,SAAS,CAACU,SAAV,CAAoBiC,aAApB,GAAoC,SAASA,aAAT,CAAwBC,MAAxB,EAAgC;AAChE,MAAIH,IAAI,GAAG/M,IAAI,CAACgN,SAAL,CAAeE,MAAf,CAAX;;AACA,MAAIH,IAAI,KAAK,IAAb,EAAmB;AACf;AACH;;AAED,MAAIrJ,KAAK,GAAG9D,OAAO,CAACmN,IAAD,EAAO,KAAKrC,QAAZ,CAAnB;;AACA,MAAIhH,KAAK,GAAG,CAAZ,EAAe;AACXA,IAAAA,KAAK,GAAG,KAAKgH,QAAL,CAAcgB,IAAd,CAAmBqB,IAAnB,IAA2B,CAAnC;AACH,GAT+D,CAWhE;;;AACA,SAAOrJ,KAAK,GAAG,CAAf;AACH,CAbD;;AAeA4G,SAAS,CAACU,SAAV,CAAoBO,UAApB,GAAiC,SAASA,UAAT,CAAqB4B,OAArB,EAA8B;AACzD,MAAIhC,MAAM,GAAG,IAAb;;AAEF,OAAK,IAAIxK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwM,OAAO,CAACnM,MAA5B,EAAoCL,CAAC,EAArC,EAAyC;AACrC,QAAIsE,GAAG,GAAGkI,OAAO,CAACxM,CAAD,CAAjB;AACA,QAAIyM,KAAK,GAAGnI,GAAG,CAACmI,KAAhB;AAEAnI,IAAAA,GAAG,CAACxB,IAAJ,GAAW,EAAX;;AAEA,SAAK,IAAI4J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACpM,MAA1B,EAAkCqM,CAAC,EAAnC,EAAuC;AACnC,UAAIC,QAAQ,GAAGnC,MAAM,CAACoC,KAAP,CAAaH,KAAK,CAACC,CAAD,CAAlB,EAAuBpI,GAAG,CAACvB,KAA3B,EAAkC2J,CAAlC,CAAf;;AACA,UAAIC,QAAJ,EAAc;AACVrI,QAAAA,GAAG,CAACxB,IAAJ,CAASiI,IAAT,CAAc4B,QAAd;AACH;AACJ;AACJ;AACJ,CAhBD;;AAkBAhD,SAAS,CAACU,SAAV,CAAoBuC,KAApB,GAA4B,SAASA,KAAT,CAAgB9J,IAAhB,EAAsB0B,QAAtB,EAAgCqI,SAAhC,EAA2C;AACnE,MAAI,CAAC/J,IAAD,IAASA,IAAI,KAAKgK,UAAtB,EAAkC;AAC9B,WAAO,IAAP;AACH;;AAED,MAAIvK,KAAK,GAAGO,IAAI,CAACP,KAAjB;AAEA,MAAIgK,MAAM,GAAG,EAAb;;AAEA,MAAIzJ,IAAI,CAACiK,UAAT,EAAqB;AACjBR,IAAAA,MAAM,CAACS,IAAP,GAAclK,IAAI,CAACiK,UAAnB;AACH;;AAED,MAAIjK,IAAI,CAACmK,WAAT,EAAsB;AAClBV,IAAAA,MAAM,CAACW,KAAP,GAAepK,IAAI,CAACmK,WAApB;AACH;;AAED,MAAInK,IAAI,CAACqK,SAAT,EAAoB;AAChBZ,IAAAA,MAAM,CAACa,GAAP,GAAatK,IAAI,CAACqK,SAAlB;AACH;;AAED,MAAIrK,IAAI,CAACuK,YAAT,EAAuB;AACnBd,IAAAA,MAAM,CAACe,MAAP,GAAgBxK,IAAI,CAACuK,YAArB;AACH;;AAEDd,EAAAA,MAAM,GAAG,KAAKD,aAAL,CAAmBC,MAAnB,CAAT;AAEA,MAAIgB,QAAQ,GAAG,KAAKlM,OAAL,CAAa2J,gBAAb,IAAiC,EAAhD;AACA,MAAInG,KAAK,GAAG;AAAE+D,IAAAA,QAAQ,EAAE2D;AAAZ,GAAZ;;AAEA,GAAC,UAASiB,GAAT,EAAc;AACXA,IAAAA,GAAG,CAAC,OAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,YAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,MAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,WAAD,CAAH;;AACA,QAAI,CAACA,GAAG,CAAC,YAAD,CAAR,EAAwB;AAAEA,MAAAA,GAAG,CAAC,UAAD,EAAa,YAAb,CAAH;AAAgC;;AAC1DA,IAAAA,GAAG,CAAC,UAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,CAAH;;AACA,QAAI,CAACA,GAAG,CAAC,WAAD,CAAR,EAAuB;AAAEA,MAAAA,GAAG,CAAC,QAAD,EAAW,WAAX,CAAH;AAA6B;;AACtD,QAAI,CAACA,GAAG,CAAC,eAAD,CAAR,EAA2B;AAAEA,MAAAA,GAAG,CAAC,QAAD,EAAW,eAAX,CAAH;AAAiC;;AAC9DA,IAAAA,GAAG,CAAC,MAAD,CAAH;AACAA,IAAAA,GAAG,CAAC,QAAD,CAAH;AACH,GAbD,EAcI,UAASC,IAAT,EAAevH,MAAf,EAAuB;AACnB,QAAIzG,GAAG,GAAGqD,IAAI,CAAC2K,IAAD,CAAd;;AACA,QAAIhO,GAAG,KAAK4L,SAAZ,EAAuB;AACnB5L,MAAAA,GAAG,GAAG8N,QAAQ,CAACE,IAAD,CAAd;AACH;;AACD,QAAIhO,GAAG,KAAK4L,SAAZ,EAAuB;AACnBxG,MAAAA,KAAK,CAACqB,MAAM,IAAIuH,IAAX,CAAL,GAAwBhO,GAAxB;AACA,aAAO,IAAP;AACH;AACJ,GAvBL;;AA0BA,MAAImD,OAAO,GAAG,KAAKvB,OAAL,CAAauB,OAAb,IAAwB,EAAtC;AAEA,MAAIqB,MAAM,GAAGrB,OAAO,CAACiK,SAAD,CAApB;AACA,MAAIjO,IAAI,GAAG,OAAO2D,KAAlB;;AAEA,MAAI0B,MAAM,IAAIA,MAAM,CAACI,SAAjB,KAA+B,CAACvB,IAAI,CAAC4K,OAAN,IAAiB5K,IAAI,CAAC4K,OAAL,KAAiB,CAAjE,CAAJ,EAAyE;AACrE,QAAIC,YAAY,GAAGpL,KAAnB,CADqE,CAGrE;AACA;AACA;AACA;;AACA,QAAI3D,IAAI,KAAK,QAAb,EAAuB;AACnB;AACA;AACA+O,MAAAA,YAAY,GAAGrP,WAAW,CAACsP,QAAZ,CAAqBrL,KAArB,EAA4BO,IAAI,CAAC4E,MAAjC,CAAf;AACH;;AAEDzD,IAAAA,MAAM,CAACG,KAAP,GAAe8E,IAAI,CAAC2E,GAAL,CAAS5J,MAAM,CAACG,KAAP,IAAgB,CAAzB,EAA4B1E,MAAM,CAACiO,YAAD,CAAN,CAAqBtN,MAAjD,CAAf;AACH;;AAED,MAAIzB,IAAI,KAAK,QAAb,EAAuB;AACnB2D,IAAAA,KAAK,GAAGmH,eAAe,CAACnH,KAAD,CAAvB;AACAA,IAAAA,KAAK,GAAG,KAAK2J,aAAL,CAAmB3J,KAAnB,CAAR;AACA3D,IAAAA,IAAI,GAAG,GAAP;AACH,GAJD,MAIO,IAAIA,IAAI,KAAK,QAAb,EAAuB;AAC1BA,IAAAA,IAAI,GAAG,GAAP;AACH,GAFM,MAEA,IAAIA,IAAI,KAAK,SAAb,EAAwB;AAC3BA,IAAAA,IAAI,GAAG,GAAP;AACA2D,IAAAA,KAAK,GAAGuL,MAAM,CAACvL,KAAD,CAAd;AACH,GAHM,MAGA,IAAIA,KAAK,IAAIA,KAAK,CAACwL,OAAnB,EAA4B;AAC/BnP,IAAAA,IAAI,GAAG,IAAP;AACA2D,IAAAA,KAAK,GAAGhE,YAAY,CAACgE,KAAD,CAApB;;AACA,QAAI,CAACsC,KAAK,CAAC6C,MAAX,EAAmB;AACf7C,MAAAA,KAAK,CAAC6C,MAAN,GAAe,UAAf;AACH;AACJ,GANM,MAMA;AACH9I,IAAAA,IAAI,GAAG,IAAP;AACA2D,IAAAA,KAAK,GAAG,IAAR;AACH;;AAEDsC,EAAAA,KAAK,GAAG,KAAKoG,YAAL,CAAkBpG,KAAlB,CAAR;AAEA,MAAImJ,QAAQ,GAAGnN,GAAG,CAAC2D,QAAD,EAAWqI,SAAX,CAAlB;;AAEA,MAAI/J,IAAI,CAACmL,UAAT,EAAqB;AACjB,SAAKC,cAAL,CAAoBpL,IAAI,CAACmL,UAAzB,EAAqCD,QAArC;AACH;;AAED,MAAIlL,IAAI,CAACsD,OAAT,EAAkB;AACd,QAAIG,MAAM,GAAG,CACTsG,SAAS,GAAG,CADH,EACK;AACd,MAFS,EAEK;AACdrI,IAAAA,QAHS,EAGK;AACd,MAJS,EAIK;AACdqI,IAAAA,SAAS,GAAG,CALH,EAKK;AACd,MANS,EAMK;AACdrI,IAAAA,QAAQ,GAAG,CAPF,EAOK;AACd,KARS,CAQK;AARL,KAAb;;AAUA,SAAKyF,SAAL,CAAec,IAAf,CAAoB;AAChBlK,MAAAA,GAAG,EAAImN,QADS;AAEhB3H,MAAAA,IAAI,EAAGvD,IAAI,CAACsD,OAFI;AAGhB9B,MAAAA,GAAG,EAAIE,QAHS;AAIhBgC,MAAAA,GAAG,EAAIqG,SAJS;AAKhBtG,MAAAA,MAAM,EAAGA,MAAM,CAACrB,IAAP,CAAY,IAAZ;AALO,KAApB;AAOH;;AAED,SAAO;AACH3C,IAAAA,KAAK,EAAEA,KADJ;AAEHuC,IAAAA,OAAO,EAAEhC,IAAI,CAACgC,OAFX;AAGHlG,IAAAA,IAAI,EAAEA,IAHH;AAIHiG,IAAAA,KAAK,EAAEA,KAJJ;AAKHhE,IAAAA,GAAG,EAAEmN;AALF,GAAP;AAOH,CApID;;AAsIArE,SAAS,CAACU,SAAV,CAAoB6D,cAApB,GAAqC,SAASA,cAAT,CAAyBC,CAAzB,EAA4BtN,GAA5B,EAAiC;AAClE,MAAIuN,GAAG,GAAG;AACNjJ,IAAAA,gBAAgB,EAAGgJ,CAAC,CAACvP,IAAF,KAAW,QAAX,GAAsB,CAAtB,GAA0B,CADvC;AAEN6G,IAAAA,QAAQ,EAAS0I,CAAC,CAAC/L,IAFb;AAGNsD,IAAAA,QAAQ,EAASyI,CAAC,CAAC9L,EAHb;AAINzD,IAAAA,IAAI,EAAayP,cAAc,CAACF,CAAC,CAACG,QAAH,CAAd,IAA8BH,CAAC,CAACG,QAJ3C;AAKNlJ,IAAAA,QAAQ,EAASmJ,kBAAkB,CAACJ,CAAC,CAACK,YAAH,CAAlB,IAAsCL,CAAC,CAACK,YALnD;AAMNnJ,IAAAA,UAAU,EAAO8I,CAAC,CAACM,UAAF,GAAe,CAAf,GAAmB,CAN9B;AAONnJ,IAAAA,YAAY,EAAK6I,CAAC,CAACO,UAAF,GAAe,CAAf,GAAmB,CAP9B;AAOiC;AACvCnJ,IAAAA,KAAK,EAAY4I,CAAC,CAACQ,eARb;AASNnJ,IAAAA,UAAU,EAAO2I,CAAC,CAACS;AATb,GAAV;AAWA,MAAIxC,IAAI,GAAG/M,IAAI,CAACgN,SAAL,CAAe+B,GAAf,CAAX;;AACA,MAAI,CAAC,KAAKpE,YAAL,CAAkBoC,IAAlB,CAAL,EAA8B;AAC1B,SAAKpC,YAAL,CAAkBoC,IAAlB,IAA0BgC,GAA1B;AACAA,IAAAA,GAAG,CAACnJ,KAAJ,GAAY,EAAZ;AACH;;AACD,OAAK+E,YAAL,CAAkBoC,IAAlB,EAAwBnH,KAAxB,CAA8B8F,IAA9B,CAAmClK,GAAnC;AACH,CAlBD;;AAoBA8I,SAAS,CAACU,SAAV,CAAoBa,WAApB,GAAkC,SAASA,WAAT,GAAwB;AACtD,SAAO2D,SAAS,CAAC,KAAKxN,OAAL,CAAaqJ,IAAd,CAAhB;AACH,CAFD;;AAIAf,SAAS,CAACU,SAAV,CAAoBc,WAApB,GAAkC,SAASA,WAAT,GAAwB;AACtD,MAAI2D,IAAI,GAAG,CAAX;AACA,OAAKzN,OAAL,CAAaqJ,IAAb,CAAkBlK,OAAlB,CAA0B,UAAS8D,GAAT,EAAc;AACpC,QAAIA,GAAG,CAACmI,KAAR,EAAe;AACXqC,MAAAA,IAAI,GAAG5F,IAAI,CAAC2E,GAAL,CAASiB,IAAT,EAAeD,SAAS,CAACvK,GAAG,CAACmI,KAAL,CAAxB,CAAP;AACH;AACJ,GAJD;AAKA,SAAOqC,IAAP;AACH,CARD;;AAUF,SAASD,SAAT,CAAmB/L,IAAnB,EAAyB;AACrB,MAAIgM,IAAI,GAAGhM,IAAI,CAACzC,MAAhB;AACAyC,EAAAA,IAAI,CAACtC,OAAL,CAAa,UAASuO,EAAT,EAAa;AACtB,QAAIA,EAAE,CAAChM,KAAH,IAAYgM,EAAE,CAAChM,KAAH,IAAY+L,IAA5B,EAAkC;AAC9BA,MAAAA,IAAI,GAAGC,EAAE,CAAChM,KAAH,GAAW,CAAlB;AACH;AACJ,GAJD;AAKA,SAAO+L,IAAP;AACH;;AAED,IAAIP,kBAAkB,GAAG;AACrB;AACA;AACAS,EAAAA,oBAAoB,EAAG,oBAHF;AAIrBC,EAAAA,iBAAiB,EAAM;AAJF,CAAzB;AAOA,IAAIZ,cAAc,GAAG;AACjBa,EAAAA,MAAM,EAAE;AADS,CAArB;AAIA,IAAIC,cAAc,GAAG;AACjB,aAAW,CADM;AAEjB,OAAK,CAFY;AAGjB,UAAQ,CAHS;AAIjB,WAAS,CAJQ;AAKjB,cAAY,CALK;AAMjB,QAAM,CANW;AAOjB,WAAS,EAPQ;AAQjB,cAAY,EARK;AASjB,WAAS,EATQ;AAUjB,aAAW,EAVM;AAWjB,cAAY,EAXK;AAYjB,cAAY,EAZK;AAajB,WAAS,EAbQ;AAcjB,YAAU,EAdO;AAejB,gBAAc,EAfG;AAgBjB,mBAAiB,EAhBA;AAiBjB,UAAQ,EAjBS;AAkBjB,aAAW,EAlBM;AAmBjB,iBAAe,EAnBE;AAoBjB,oBAAkB,EApBD;AAqBjB,yBAAuB,EArBN;AAsBjB,yBAAuB,EAtBN;AAuBjB,8BAA4B,EAvBX;AAwBjB,WAAS,EAxBQ;AAyBjB,eAAa,EAzBI;AA0BjB,YAAU,EA1BO;AA2BjB,cAAY,EA3BK;AA4BjB,OAAK,EA5BY;AA6BjB,kBAAgB,EA7BC;AA8BjB,YAAU,EA9BO;AA+BjB,QAAM,EA/BW;AAgCjB,WAAS,EAhCQ;AAiCjB,YAAU,EAjCO;AAkCjB,eAAa,EAlCI;AAmCjB,SAAO,EAnCU;AAoCjB,YAAU,EApCO;AAqCjB,YAAU,EArCO;AAsCjB,cAAY;AAtCK,CAArB;;AAyCA,SAASC,YAAT,CAAsB7M,KAAtB,EAA6B;AACzB,MAAI0F,KAAK,GAAG1F,KAAZ;;AACA,MAAI0F,KAAK,CAAC5H,MAAN,GAAe,CAAnB,EAAsB;AAClB4H,IAAAA,KAAK,GAAGA,KAAK,CAACtI,OAAN,CAAc,OAAd,EAAuB,UAAS0P,EAAT,EAAaC,EAAb,EAAiB;AAC5C,aAAOA,EAAE,GAAGA,EAAZ;AACH,KAFO,CAAR;AAGH;;AAEDrH,EAAAA,KAAK,GAAGA,KAAK,CAACd,SAAN,CAAgB,CAAhB,EAAmBoI,WAAnB,EAAR;;AAEA,MAAItH,KAAK,CAAC5H,MAAN,GAAe,CAAnB,EAAsB;AAClB4H,IAAAA,KAAK,GAAG,OAAOA,KAAf;AACH;;AAED,SAAOA,KAAP;AACH;;AAED,IAAIuH,QAAQ,GAAG,SAASA,QAAT,CAAkBnO,OAAlB,EAA2B;AACpC,MAAImJ,MAAM,GAAG,IAAb;AAEA,OAAKnJ,OAAL,GAAeA,OAAO,IAAI,EAA1B;AACA,OAAKwI,QAAL,GAAgB;AACZ3C,IAAAA,OAAO,EAAE,EADG;AAEZrH,IAAAA,KAAK,EAAE,CAFK;AAGZoH,IAAAA,WAAW,EAAE;AAHD,GAAhB;AAKA,OAAK6C,OAAL,GAAe,EAAf;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA,OAAK0F,OAAL,GAAe,KAAKpO,OAAL,CAAamK,MAA5B;AACA,OAAKkE,MAAL,GAAc,CAAd;AAEA,OAAKC,OAAL,GAAevR,GAAG,CAAC,KAAKiD,OAAL,CAAaF,MAAb,IAAuB,EAAxB,EAA4B,UAAUE,OAAV,EAAmBrB,CAAnB,EAAsB;AAChEqB,IAAAA,OAAO,CAACwB,QAAR,GAAmB2H,MAAM,CAACnJ,OAA1B;AACAA,IAAAA,OAAO,CAAC2E,UAAR,GAAqBhG,CAAC,GAAG,CAAzB;AACA,WAAO,IAAI2J,SAAJ,CAActI,OAAd,EAAuBmJ,MAAM,CAACX,QAA9B,EAAwCW,MAAM,CAACV,OAA/C,EAAwDU,MAAM,CAACT,QAA/D,CAAP;AACH,GAJiB,CAAlB;AAKH,CAnBH;;AAqBEyF,QAAQ,CAACnF,SAAT,CAAmBuF,aAAnB,GAAmC,SAASA,aAAT,CAAwBC,QAAxB,EAAkC;AACjE,MAAIC,EAAE,GAAG,EAAE,KAAKJ,MAAhB;;AACA,UAAQG,QAAR;AACE,SAAK,WAAL;AACA,SAAK,YAAL;AACE,aAAQ,UAAUC,EAAV,GAAe,MAAvB;;AACF,SAAK,WAAL;AACE,aAAQ,UAAUA,EAAV,GAAe,MAAvB;;AACF,SAAK,WAAL;AACE,aAAQ,UAAUA,EAAV,GAAe,MAAvB;;AACF;AACE,aAAQ,UAAUA,EAAV,GAAe,MAAvB;AAAgC;AATpC;AAWH,CAbD;;AAeAN,QAAQ,CAACnF,SAAT,CAAmB0F,KAAnB,GAA2B,SAASA,KAAT,GAAkB;AACvC,MAAIvF,MAAM,GAAG,IAAb;AAEF,MAAIwF,GAAG,GAAG3R,SAAS,EAAnB;AAEA,MAAI4R,QAAQ,GAAGD,GAAG,CAACE,MAAJ,CAAW,UAAX,CAAf;AAEAD,EAAAA,QAAQ,CAACE,IAAT,CAAc,UAAd,EAA0BvP,IAAI,CAAC;AAC3BE,IAAAA,OAAO,EAAE,KAAKO,OAAL,CAAaP,OAAb,IAAwB,UADN;AAE3BC,IAAAA,cAAc,EAAE,KAAKM,OAAL,CAAaP,OAAb,IAAwB,UAFb;AAG3BE,IAAAA,OAAO,EAAE,KAAKK,OAAL,CAAa+O,IAAb,IAAqB,IAAIC,IAAJ,GAAWC,MAAX,EAHH;AAI3BrP,IAAAA,QAAQ,EAAE,KAAKI,OAAL,CAAa+O,IAAb,IAAqB,IAAIC,IAAJ,GAAWC,MAAX;AAJJ,GAAD,CAA9B;AAOA,MAAI9O,UAAU,GAAG,KAAKmO,OAAL,CAAatP,MAA9B;AAEA4P,EAAAA,QAAQ,CAACE,IAAT,CAAc,SAAd,EAAyBjP,GAAG,CAAC;AAAEC,IAAAA,MAAM,EAAE,KAAKwO;AAAf,GAAD,CAA5B;AAEA,MAAI7I,IAAI,GAAGkJ,GAAG,CAACE,MAAJ,CAAW,OAAX,CAAX;AACApJ,EAAAA,IAAI,CAACqJ,IAAL,CAAU,OAAV,EAAmBxP,IAAnB;AAEA,MAAI4P,EAAE,GAAGP,GAAG,CAACE,MAAJ,CAAW,IAAX,CAAT;AAEA,MAAIM,MAAM,GAAGD,EAAE,CAACL,MAAH,CAAU,OAAV,CAAb;AACAM,EAAAA,MAAM,CAACL,IAAP,CAAY,mBAAZ,EAAiCtK,aAAa,CAAC;AAAEhG,IAAAA,KAAK,EAAE2B;AAAT,GAAD,CAA9C;;AAEA,MAAI,KAAKiO,OAAT,EAAkB;AACd,QAAIgB,KAAK,GAAGF,EAAE,CAACL,MAAH,CAAU,OAAV,CAAZ;AACA5P,IAAAA,MAAM,CAACC,IAAP,CAAY,KAAKkP,OAAjB,EAA0BjP,OAA1B,CAAkC,UAAUsP,EAAV,EAAc;AAC5C,UAAIjE,GAAG,GAAGrB,MAAM,CAACiF,OAAP,CAAeK,EAAf,CAAV;AACA,UAAIlO,QAAQ,GAAG4I,MAAM,CAACoF,aAAP,CAAqB/D,GAAG,CAACjN,IAAzB,CAAf;AACA6R,MAAAA,KAAK,CAACN,IAAN,CAAWvO,QAAX,EAAqBiK,GAAG,CAAC/I,IAAzB;AACA+I,MAAAA,GAAG,CAAC3F,MAAJ,GAAa,cAActE,QAA3B;AACH,KALD;AAMH;;AAED,MAAI8O,QAAQ,GAAG,EAAf;AACAH,EAAAA,EAAE,CAACJ,IAAH,CAAQ,cAAR,EAAwBtO,QAAQ,CAAC;AAC7BV,IAAAA,MAAM,EAAE,KAAKwO,OADgB;AAE7B7N,IAAAA,WAAW,EAAE1D,GAAG,CAAC,KAAKuR,OAAN,EAAe,UAASvO,KAAT,EAAgB2B,KAAhB,EAAuB;AAClD,UAAI1B,OAAO,GAAGD,KAAK,CAACC,OAApB;AACA,UAAIsP,SAAS,GAAItP,OAAO,CAACW,IAAR,IAAgBX,OAAO,CAACC,KAAxB,IAAiC,WAAWyB,KAAK,GAAG,CAAnB,CAAlD;AACA2N,MAAAA,QAAQ,CAACC,SAAS,CAACC,WAAV,EAAD,CAAR,GAAoC7N,KAApC;AACA,UAAIG,MAAM,GAAG7B,OAAO,CAAC6B,MAArB;;AACA,UAAIA,MAAJ,EAAY;AACR,YAAIA,MAAM,CAACrC,GAAX,EAAgB;AACZ;AACA,cAAIgQ,CAAC,GAAG3N,MAAM,CAACrC,GAAP,CAAWiQ,KAAX,CAAiB,GAAjB,CAAR;AACA,cAAI1O,IAAI,GAAGuJ,QAAQ,CAACkF,CAAC,CAAC,CAAD,CAAF,CAAnB;AACA,cAAIxO,EAAE,GAAGsJ,QAAQ,CAACkF,CAAC,CAAC,CAAD,CAAF,CAAjB;AACA,iBAAO;AACH3O,YAAAA,YAAY,EAAEa,KADX;AAEHf,YAAAA,IAAI,EAAE2O,SAFH;AAGHvO,YAAAA,IAAI,EAAEgH,IAAI,CAAChH,IAAI,CAACkC,GAAN,EAAWlC,IAAI,CAACoE,GAAhB,CAHP;AAIHnE,YAAAA,EAAE,EAAE+G,IAAI,CAAC/G,EAAE,CAACiC,GAAJ,EAASjC,EAAE,CAACmE,GAAZ;AAJL,WAAP;AAMH,SAXD,MAWO,IAAI,OAAOtD,MAAM,CAACd,IAAd,KAAuB,WAAvB,IAAsC,OAAOc,MAAM,CAACb,EAAd,KAAqB,WAA/D,EAA4E;AAC/E;AACA,iBAAO;AACHH,YAAAA,YAAY,EAAEa,KADX;AAEHf,YAAAA,IAAI,EAAE2O,SAFH;AAGHvO,YAAAA,IAAI,EAAEgH,IAAI,CAACC,cAAc,CAAChI,OAAD,CAAf,EAA0B6B,MAAM,CAACd,IAAjC,CAHP;AAIHC,YAAAA,EAAE,EAAE+G,IAAI,CAACC,cAAc,CAAChI,OAAD,CAAf,EAA0B6B,MAAM,CAACb,EAAjC;AAJL,WAAP;AAMH;AACJ;AACJ,KA3Be,CAFa;AA8B7BN,IAAAA,SAAS,EAAE3D,GAAG,CAAC,KAAKiD,OAAL,CAAa0P,KAAb,IAAsB,EAAvB,EAA2B,UAASC,GAAT,EAAc;AACnD,aAAO;AACHhP,QAAAA,IAAI,EAAEgP,GAAG,CAACC,SADP;AAEH/O,QAAAA,YAAY,EAAE8O,GAAG,CAAC5P,KAAJ,GAAYsP,QAAQ,CAACM,GAAG,CAAC5P,KAAJ,CAAUwP,WAAV,EAAD,CAApB,GAAgD,IAF3D;AAGHrO,QAAAA,KAAK,EAAEyO,GAAG,CAACzO,KAHR;AAIHD,QAAAA,MAAM,EAAE0O,GAAG,CAAC1O;AAJT,OAAP;AAMH,KAPa;AA9Be,GAAD,CAAhC;AAwCA,MAAI4O,UAAU,GAAGX,EAAE,CAACL,MAAH,CAAU,YAAV,CAAjB;AACA,MAAIjK,QAAQ,GAAGsK,EAAE,CAACL,MAAH,CAAU,UAAV,CAAf;AACA,MAAIiB,YAAY,GAAGlL,QAAQ,CAACiK,MAAT,CAAgB,OAAhB,CAAnB;AACA,MAAIkB,SAAS,GAAGF,UAAU,CAAChB,MAAX,CAAkB,OAAlB,CAAhB;AACA,MAAIzO,YAAY,GAAG,EAAnB;AACA,MAAIC,YAAY,GAAG,EAAnB;;AAEA,OAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGH,UAAxB,EAAoCG,GAAG,EAAvC,EAA2C;AACvC,QAAIP,KAAK,GAAGoJ,MAAM,CAACmF,OAAP,CAAehO,GAAf,CAAZ;AACA,QAAIgP,SAAS,GAAG,WAAWhP,GAAG,GAAG,CAAjB,IAAsB,MAAtC;AACA,QAAI0P,QAAQ,GAAGjQ,KAAK,CAACmJ,KAAN,CAAY5I,GAAZ,CAAf,CAHuC,CAGN;;AACjC,QAAI2P,OAAO,GAAGlQ,KAAK,CAACkJ,SAAN,EAAd;AACA,QAAIgB,WAAW,GAAGlK,KAAK,CAACkK,WAAN,EAAlB;AACA,QAAI9H,aAAa,GAAGpC,KAAK,CAACoC,aAAN,EAApB;AACA,QAAI+H,WAAW,GAAGnK,KAAK,CAACmK,WAAN,CAAkBf,MAAM,CAACiF,OAAzB,CAAlB;;AAEA,QAAI6B,OAAJ,EAAa;AACTF,MAAAA,SAAS,CAACjB,IAAV,CAAeQ,SAAS,GAAG,OAA3B,EAAoCW,OAApC;AACH;;AACD,QAAIhG,WAAJ,EAAiB;AACb,UAAItJ,IAAI,GAAG,aAAcZ,KAAK,CAACC,OAAN,CAAc2E,UAA5B,GAA0C,MAArD;AACAuK,MAAAA,EAAE,CAACJ,IAAH,CAAQnO,IAAR,EAAcsJ,WAAd;AACA7J,MAAAA,YAAY,CAACsJ,IAAb,CAAkB/I,IAAlB;AACH;;AACD,QAAIwB,aAAJ,EAAmB;AACfyC,MAAAA,QAAQ,CAACkK,IAAT,CAAe,eAAgB/O,KAAK,CAACC,OAAN,CAAc2E,UAA9B,GAA4C,MAA3D,EAAoExC,aAApE;AACH;;AACD,QAAI+H,WAAJ,EAAiB;AACb,UAAIgG,MAAM,GAAG,YAAanQ,KAAK,CAACC,OAAN,CAAc2E,UAA3B,GAAyC,MAAtD;AACAC,MAAAA,QAAQ,CAACkK,IAAT,CAAcoB,MAAd,EAAsBhG,WAAW,CAACE,IAAlC;AACA0F,MAAAA,YAAY,CAAChB,IAAb,CAAmBoB,MAAM,GAAG,OAA5B,EAAsChG,WAAW,CAACzE,IAAlD;AACApF,MAAAA,YAAY,CAACqJ,IAAb,CAAkBwG,MAAlB;AACH;;AAEDL,IAAAA,UAAU,CAACf,IAAX,CAAgBQ,SAAhB,EAA2BU,QAA3B;AACH;;AAED,MAAI7J,OAAO,GAAGpJ,GAAG,CAAC,KAAK2L,QAAN,EAAgB3K,SAAhB,CAAjB;AAEA,MAAIqI,MAAM,GAAGrJ,GAAG,CAAC,KAAK0L,OAAN,EAAe1K,SAAf,CAAhB;;AAEA,MAAIoS,OAAO,GAAG,UAAS3M,KAAT,EAAgB;AAC1B,WAAOA,KAAK,CAACkD,SAAN,IAAmBlD,KAAK,CAACgD,IAAzB,IAAiChD,KAAK,CAACiD,MAAvC,IAAiDjD,KAAK,CAACoD,KAAvD,IAAgEpD,KAAK,CAACqD,UAAtE,IAAoFrD,KAAK,CAACmD,QAAjG;AACH,GAFD;;AAIA,MAAIyJ,eAAe,GAAG,UAASlP,KAAT,EAAgB;AAClC,QAAImP,QAAQ,GAAG5D,MAAM,CAACvL,KAAD,CAArB;AACA,QAAIoP,QAAJ;;AAEA,QAAID,QAAJ,EAAc;AACVC,MAAAA,QAAQ,GAAGD,QAAQ,GAAG,CAAX,GAAe,CAA1B;AACH;;AAED,WAAOC,QAAP;AACH,GATD;;AAWA,MAAIrK,KAAK,GAAGlJ,GAAG,CAACqJ,MAAD,EAAS,UAAS5C,KAAT,EAAgB;AACpC,QAAIA,KAAK,CAACmD,QAAV,EAAoB;AAChBnD,MAAAA,KAAK,CAACmD,QAAN,GAAiByJ,eAAe,CAAC5M,KAAK,CAACmD,QAAP,CAAhC;AACH;;AAED,QAAInD,KAAK,CAACoD,KAAV,EAAiB;AACbpD,MAAAA,KAAK,CAACoD,KAAN,GAAcmH,YAAY,CAACvK,KAAK,CAACoD,KAAP,CAA1B;AACH;;AAED,QAAIuJ,OAAO,CAAC3M,KAAD,CAAX,EAAoB;AAChB,aAAOA,KAAP;AACH;AACJ,GAZc,CAAf;AAcA,MAAIwC,OAAO,GAAGjJ,GAAG,CAACqJ,MAAD,EAAS,UAAS5C,KAAT,EAAgB;AACtC,QAAIA,KAAK,CAAC6C,MAAN,IAAgByH,cAAc,CAACtK,KAAK,CAAC6C,MAAP,CAAd,KAAiC2D,SAArD,EAAgE;AAC5D,aAAOxG,KAAP;AACH;AACJ,GAJgB,CAAjB;AAMA,MAAI0C,KAAK,GAAGnJ,GAAG,CAACqJ,MAAD,EAAS,UAAS5C,KAAT,EAAgB;AACpC,QAAIA,KAAK,CAACuD,UAAV,EAAsB;AAClBvD,MAAAA,KAAK,CAACuD,UAAN,GAAmBgH,YAAY,CAACvK,KAAK,CAACuD,UAAP,CAA/B;AACA,aAAOvD,KAAP;AACH;AACJ,GALc,CAAf;AAOA0L,EAAAA,EAAE,CAACJ,IAAH,CAAQ,YAAR,EAAsB/I,MAAM,CAAC;AACzBE,IAAAA,KAAK,EAAEA,KADkB;AAEzBC,IAAAA,KAAK,EAAEA,KAFkB;AAGzBF,IAAAA,OAAO,EAAEA,OAHgB;AAIzBG,IAAAA,OAAO,EAAEA,OAJgB;AAKzBC,IAAAA,MAAM,EAAErJ,GAAG,CAACqJ,MAAD,EAAS,UAAS5C,KAAT,EAAgB;AAChC,UAAIsH,MAAM,GAAG,EAAb;;AAEA,UAAIqF,OAAO,CAAC3M,KAAD,CAAX,EAAoB;AAChBsH,QAAAA,MAAM,CAAC7D,MAAP,GAAgBrJ,OAAO,CAAC4F,KAAD,EAAQyC,KAAR,CAAP,GAAwB,CAAxC;AACH;;AAED,UAAIzC,KAAK,CAACuD,UAAV,EAAsB;AAClB+D,QAAAA,MAAM,CAAC5D,MAAP,GAAgBtJ,OAAO,CAAC4F,KAAD,EAAQ0C,KAAR,CAAP,GAAwB,CAAxC;AACH;;AAED4E,MAAAA,MAAM,CAAC1D,SAAP,GAAmB5D,KAAK,CAAC4D,SAAzB;AACA0D,MAAAA,MAAM,CAACtD,MAAP,GAAgBhE,KAAK,CAACgE,MAAtB;AACAsD,MAAAA,MAAM,CAACzD,aAAP,GAAuB7D,KAAK,CAAC6D,aAA7B;AACAyD,MAAAA,MAAM,CAACxD,IAAP,GAAc9D,KAAK,CAAC8D,IAApB;AACAwD,MAAAA,MAAM,CAACvD,QAAP,GAAkB/D,KAAK,CAAC+D,QAAxB;;AAEA,UAAI/D,KAAK,CAAC6C,MAAV,EAAkB;AACd,YAAIyH,cAAc,CAACtK,KAAK,CAAC6C,MAAP,CAAd,KAAiC2D,SAArC,EAAgD;AAC5Cc,UAAAA,MAAM,CAAC3D,QAAP,GAAkB2G,cAAc,CAACtK,KAAK,CAAC6C,MAAP,CAAhC;AACH,SAFD,MAEO;AACHyE,UAAAA,MAAM,CAAC3D,QAAP,GAAkB,MAAMvJ,OAAO,CAAC4F,KAAD,EAAQwC,OAAR,CAA/B;AACH;AACJ;;AAED,aAAO8E,MAAP;AACH,KA1BU;AALc,GAAD,CAA5B;AAkCAoE,EAAAA,EAAE,CAACJ,IAAH,CAAQ,mBAAR,EAA6BnJ,cAAc,CAAC,KAAK6C,QAAN,CAA3C;AAEAmG,EAAAA,GAAG,CAACG,IAAJ,CAAS,qBAAT,EAAgC5O,aAAa,CAAC;AAC1CC,IAAAA,UAAU,EAAEA,UAD8B;AAE1CC,IAAAA,YAAY,EAAEA,YAF4B;AAG1CC,IAAAA,YAAY,EAAEA;AAH4B,GAAD,CAA7C;AAMA,SAAOsO,GAAP;AACH,CA3MD;;AA6MAR,QAAQ,CAACnF,SAAT,CAAmBuH,SAAnB,GAA+B,SAASA,SAAT,GAAsB;AACjD,MAAI5B,GAAG,GAAG,KAAKD,KAAL,EAAV;AAEA,SAAOC,GAAG,CAAC6B,aAAJ,GAAoB7B,GAAG,CAAC6B,aAAJ,CAAkBnT,gBAAlB,EAAoCoT,IAApC,CAAyC/S,SAAzC,CAApB,GAA0EA,SAAS,CAACiR,GAAG,CAAC+B,QAAJ,CAAarT,gBAAb,CAAD,CAA1F;AACH,CAJD;;AAMA8Q,QAAQ,CAACnF,SAAT,CAAmB2H,MAAnB,GAA4B,SAASA,MAAT,GAAmB;AAC3C,MAAIhC,GAAG,GAAG,KAAKD,KAAL,EAAV;;AACA,MAAIC,GAAG,CAAC6B,aAAR,EAAuB;AACnB,WAAO7B,GAAG,CAAC6B,aAAJ,CAAkBhT,YAAlB,CAAP;AACH;;AACD,SAAO,IAAIoT,IAAJ,CAAS,CAAEjC,GAAG,CAAC+B,QAAJ,CAAajT,mBAAb,CAAF,CAAT,EAAgD;AAAEF,IAAAA,IAAI,EAAEJ;AAAR,GAAhD,CAAP;AACH,CAND;;AAQF,SAAS0T,WAAT,CAAqB9N,KAArB,EAA4B;AACxB,MAAI+N,KAAK,GAAG,MAAZ;;AAEA,MAAI/N,KAAK,KAAK,CAAd,EAAiB;AACb+N,IAAAA,KAAK,GAAG,QAAR;AACH,GAFD,MAEO,IAAI/N,KAAK,KAAK,CAAd,EAAiB;AACpB+N,IAAAA,KAAK,GAAG,OAAR;AACH;;AAED,SAAOA,KAAP;AACH;;AAED,SAASC,kBAAT,CAA4BpQ,IAA5B,EAAkC6C,KAAlC,EAAyC;AACrC,MAAIsH,MAAM,GAAG,EAAb;;AAEA,MAAItH,KAAJ,EAAW;AACPsH,IAAAA,MAAM,IAAI,MAAMnK,IAAN,GAAa,WAAb,GAA2BkQ,WAAW,CAACrN,KAAK,CAACwN,IAAP,CAAtC,GAAqD,KAA/D;;AACA,QAAIxN,KAAK,CAACoD,KAAV,EAAiB;AACbkE,MAAAA,MAAM,IAAI,kBAAkBiD,YAAY,CAACvK,KAAK,CAACoD,KAAP,CAA9B,GAA8C,MAAxD;AACH;;AACDkE,IAAAA,MAAM,IAAI,OAAOnK,IAAP,GAAc,GAAxB;AACH;;AAED,SAAOmK,MAAP;AACH;;AAED,SAAS9D,cAAT,CAAwBkE,MAAxB,EAAgC;AAC5B,SAAO,aACJ6F,kBAAkB,CAAC,MAAD,EAAS7F,MAAM,CAACS,IAAhB,CADd,GAEJoF,kBAAkB,CAAC,OAAD,EAAU7F,MAAM,CAACW,KAAjB,CAFd,GAGJkF,kBAAkB,CAAC,KAAD,EAAQ7F,MAAM,CAACa,GAAf,CAHd,GAIJgF,kBAAkB,CAAC,QAAD,EAAW7F,MAAM,CAACe,MAAlB,CAJd,GAKR,WALC;AAMH;;AAED,IAAIR,UAAU,GAAG,EAAjB;;AACA,SAASnC,OAAT,CAAiBD,IAAjB,EAAuBD,WAAvB,EAAoC;AAChC,MAAI+B,OAAO,GAAG,EAAd;AACA,MAAI8F,WAAW,GAAG,EAAlB;AAEAC,EAAAA,SAAS,CAAC7H,IAAD,EAAO,UAASpG,GAAT,EAAcvB,KAAd,EAAqB;AACjC,QAAID,IAAI,GAAG;AACP0P,MAAAA,OAAO,EAAElO,GADF;AAEPvB,MAAAA,KAAK,EAAEA,KAFA;AAGP2B,MAAAA,MAAM,EAAEJ,GAAG,CAACI,MAHL;AAIPD,MAAAA,KAAK,EAAEH,GAAG,CAACG,KAJJ;AAKPgI,MAAAA,KAAK,EAAE;AALA,KAAX;AAQAD,IAAAA,OAAO,CAACzB,IAAR,CAAajI,IAAb;AACAwP,IAAAA,WAAW,CAACvP,KAAD,CAAX,GAAqBD,IAArB;AACH,GAXQ,CAAT;AAaA,MAAI2P,MAAM,GAAGC,WAAW,CAAClG,OAAD,CAAX,CAAqBmG,KAArB,CAA2B,CAA3B,CAAb;AACA,MAAIC,GAAG,GAAG;AACNpG,IAAAA,OAAO,EAAEA,OADH;AAEN8F,IAAAA,WAAW,EAAEA,WAFP;AAGN7H,IAAAA,WAAW,EAAEA;AAHP,GAAV;;AAMA,OAAK,IAAIzK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyS,MAAM,CAACpS,MAA3B,EAAmCL,CAAC,EAApC,EAAwC;AACpC6S,IAAAA,SAAS,CAACJ,MAAM,CAACzS,CAAD,CAAP,EAAY4S,GAAZ,CAAT;AACA,WAAOH,MAAM,CAACzS,CAAD,CAAN,CAAUwS,OAAjB;AACH;;AAED,SAAOE,WAAW,CAAClG,OAAD,CAAlB;AACH;;AAED,SAAS+F,SAAT,CAAmB7H,IAAnB,EAAyBoI,QAAzB,EAAmC;AAC/B,OAAK,IAAI9S,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0K,IAAI,CAACrK,MAAzB,EAAiCL,CAAC,EAAlC,EAAsC;AAClC,QAAIsE,GAAG,GAAGoG,IAAI,CAAC1K,CAAD,CAAd;;AACA,QAAI,CAACsE,GAAL,EAAU;AACN;AACH;;AAED,QAAIvB,KAAK,GAAGuB,GAAG,CAACvB,KAAhB;;AACA,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC3BA,MAAAA,KAAK,GAAG/C,CAAR;AACH;;AAED8S,IAAAA,QAAQ,CAACxO,GAAD,EAAMvB,KAAN,CAAR;AACH;AACJ;;AAED,SAAS2P,WAAT,CAAqBK,KAArB,EAA4B;AACxB,SAAOA,KAAK,CAACC,IAAN,CAAW,UAASnC,CAAT,EAAYoC,CAAZ,EAAe;AAC7B,WAAOpC,CAAC,CAAC9N,KAAF,GAAUkQ,CAAC,CAAClQ,KAAnB;AACH,GAFM,CAAP;AAGH;;AAED,SAASmQ,UAAT,CAAoB/T,KAApB,EAA2B4P,EAA3B,EAA+B;AAC3B,MAAI5P,KAAK,CAACF,OAAN,CAAc8P,EAAd,IAAoB,CAAxB,EAA2B;AACvB5P,IAAAA,KAAK,CAAC4L,IAAN,CAAWgE,EAAX;AACH;AACJ;;AAED,SAASoE,OAAT,CAAiB1I,WAAjB,EAA8B5J,GAA9B,EAAmC;AAC/B,OAAK,IAAIb,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyK,WAAW,CAACpK,MAAhC,EAAwC,EAAEL,CAA1C,EAA6C;AACzC,QAAIoT,KAAK,GAAG3I,WAAW,CAACzK,CAAD,CAAvB;AACA,QAAI6Q,CAAC,GAAGuC,KAAK,CAACtC,KAAN,CAAY,GAAZ,CAAR;AACA,QAAIuC,OAAO,GAAGxC,CAAC,CAAC,CAAD,CAAf;;AACA,QAAIwC,OAAO,KAAKxS,GAAhB,EAAqB;AACjB,UAAIyS,WAAW,GAAGzC,CAAC,CAAC,CAAD,CAAnB;AACAwC,MAAAA,OAAO,GAAG1H,QAAQ,CAAC0H,OAAD,CAAlB;AACAC,MAAAA,WAAW,GAAG3H,QAAQ,CAAC2H,WAAD,CAAtB;AACA,aAAO;AACHC,QAAAA,OAAO,EAAED,WAAW,CAAChP,GAAZ,GAAkB+O,OAAO,CAAC/O,GAA1B,GAAgC,CADtC;AAEHoJ,QAAAA,OAAO,EAAE4F,WAAW,CAAC9M,GAAZ,GAAkB6M,OAAO,CAAC7M,GAA1B,GAAgC;AAFtC,OAAP;AAIH;AACJ;AACJ;;AAED,SAASmF,QAAT,CAAkB9K,GAAlB,EAAuB;AACnB,WAAS2S,MAAT,CAAgBzT,GAAhB,EAAqB;AACjB,QAAI0T,QAAQ,GAAG1T,GAAG,CAACwP,WAAJ,EAAf;AACA,QAAI/I,GAAG,GAAG,CAAV;;AACA,SAAK,IAAIxG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyT,QAAQ,CAACpT,MAA7B,EAAqC,EAAEL,CAAvC,EAA0C;AACtCwG,MAAAA,GAAG,GAAGA,GAAG,GAAG,EAAN,GAAWiN,QAAQ,CAACC,UAAT,CAAoB1T,CAApB,CAAX,GAAoC,EAA1C;AACH;;AACD,WAAOwG,GAAG,GAAG,CAAb;AACH;;AAED,WAASmN,MAAT,CAAgB5T,GAAhB,EAAqB;AACjB,WAAO6T,QAAQ,CAAC7T,GAAD,EAAM,EAAN,CAAR,GAAoB,CAA3B;AACH;;AAED,MAAI8T,CAAC,GAAG,mBAAmBC,IAAnB,CAAwBjT,GAAxB,CAAR;AACA,SAAO;AACHyD,IAAAA,GAAG,EAAEqP,MAAM,CAACE,CAAC,CAAC,CAAD,CAAF,CADR;AAEHrN,IAAAA,GAAG,EAAEgN,MAAM,CAACK,CAAC,CAAC,CAAD,CAAF;AAFR,GAAP;AAIH;;AAED,SAAS9H,aAAT,CAAuBvC,EAAvB,EAA2B;AACvB,SAAON,IAAI,CAAC6K,KAAL,CAAWvK,EAAE,GAAG,IAAhB,CAAP;AACH;;AAED,SAASqJ,SAAT,CAAmB/P,IAAnB,EAAyB8P,GAAzB,EAA8B;AAC1B,MAAItO,GAAG,GAAGxB,IAAI,CAAC0P,OAAf;AACA,MAAIhO,QAAQ,GAAG1B,IAAI,CAACC,KAApB;AACA,MAAI0J,KAAK,GAAGnI,GAAG,CAACmI,KAAhB;AACA,MAAIE,QAAQ,GAAG7J,IAAI,CAAC2J,KAApB;;AAEA,MAAI,CAACA,KAAL,EAAY;AACR;AACH;;AAED,OAAK,IAAIzM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyM,KAAK,CAACpM,MAA1B,EAAkCL,CAAC,EAAnC,EAAuC;AACnC,QAAI4E,IAAI,GAAG6H,KAAK,CAACzM,CAAD,CAAL,IAAY8M,UAAvB;AAEA,QAAIyG,OAAO,GAAG3O,IAAI,CAAC2O,OAAL,IAAgB,CAA9B;AACA,QAAI7F,OAAO,GAAG9I,IAAI,CAAC8I,OAAL,IAAgB,CAA9B;AAEA,QAAIb,SAAS,GAAGmH,UAAU,CAACrH,QAAD,EAAW/H,IAAX,CAA1B;AACA,QAAIqP,UAAU,GAAGpT,GAAG,CAAC2D,QAAD,EAAWqI,SAAX,CAApB;;AAEA,QAAI0G,OAAO,KAAK,CAAZ,IAAiB7F,OAAO,KAAK,CAAjC,EAAoC;AAChC;AACA;AACA;AACA,UAAIU,GAAG,GAAG+E,OAAO,CAACP,GAAG,CAACnI,WAAL,EAAkBwJ,UAAlB,CAAjB;;AACA,UAAI7F,GAAJ,EAAS;AACLV,QAAAA,OAAO,GAAGU,GAAG,CAACV,OAAd;AACA6F,QAAAA,OAAO,GAAGnF,GAAG,CAACmF,OAAd;AACH;AACJ;;AAEDW,IAAAA,QAAQ,CAACtP,IAAD,EAAO+H,QAAP,EAAiBE,SAAjB,EAA4Ba,OAA5B,CAAR;;AAEA,QAAI6F,OAAO,GAAG,CAAV,IAAe7F,OAAO,GAAG,CAA7B,EAAgC;AAC5BwF,MAAAA,UAAU,CAACN,GAAG,CAACnI,WAAL,EACCwJ,UAAU,GAAG,GAAb,GAAmBpT,GAAG,CAAC2D,QAAQ,GAAG+O,OAAX,GAAqB,CAAtB,EACC1G,SAAS,GAAGa,OAAZ,GAAsB,CADvB,CADvB,CAAV;AAGH;;AAED,QAAI6F,OAAO,GAAG,CAAd,EAAiB;AACb,WAAK,IAAIhP,EAAE,GAAGC,QAAQ,GAAG,CAAzB,EAA4BD,EAAE,GAAGC,QAAQ,GAAG+O,OAA5C,EAAqDhP,EAAE,EAAvD,EAA2D;AACvD,YAAI4P,OAAO,GAAGvB,GAAG,CAACN,WAAJ,CAAgB/N,EAAhB,CAAd;;AACA,YAAI,CAAC4P,OAAL,EAAc;AACVA,UAAAA,OAAO,GAAGvB,GAAG,CAACN,WAAJ,CAAgB/N,EAAhB,IAAsB;AAAExB,YAAAA,KAAK,EAAEwB,EAAT;AAAakI,YAAAA,KAAK,EAAE;AAApB,WAAhC;AACAmG,UAAAA,GAAG,CAACpG,OAAJ,CAAYzB,IAAZ,CAAiBoJ,OAAjB;AACH;;AAEDD,QAAAA,QAAQ,CAACtP,IAAD,EAAOuP,OAAO,CAAC1H,KAAf,EAAsBI,SAAS,GAAG,CAAlC,EAAqCa,OAAO,GAAG,CAA/C,CAAR;AACH;AACJ;AACJ;AACJ;;AAED,SAASsG,UAAT,CAAoBlR,IAApB,EAA0B8B,IAA1B,EAAgC;AAC5B,MAAI7B,KAAJ;;AAEA,MAAI,OAAO6B,IAAI,CAAC7B,KAAZ,KAAsB,QAA1B,EAAoC;AAChCA,IAAAA,KAAK,GAAG6B,IAAI,CAAC7B,KAAb;AACAqR,IAAAA,YAAY,CAACtR,IAAD,EAAO8B,IAAP,EAAaA,IAAI,CAAC7B,KAAlB,CAAZ;AACH,GAHD,MAGO;AACHA,IAAAA,KAAK,GAAGsR,UAAU,CAACvR,IAAD,EAAO8B,IAAP,CAAlB;AACH;;AAED,SAAO7B,KAAP;AACH;;AAED,SAASqR,YAAT,CAAsBtR,IAAtB,EAA4B8B,IAA5B,EAAkC7B,KAAlC,EAAyC;AACrCD,EAAAA,IAAI,CAACC,KAAD,CAAJ,GAAc6B,IAAd;AACH;;AAED,SAASyP,UAAT,CAAoBvR,IAApB,EAA0B8B,IAA1B,EAAgC;AAC5B,MAAI7B,KAAK,GAAGD,IAAI,CAACzC,MAAjB;;AAEA,OAAK,IAAIL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8C,IAAI,CAACzC,MAAL,GAAc,CAAlC,EAAqCL,CAAC,EAAtC,EAA0C;AACtC,QAAI,CAAC8C,IAAI,CAAC9C,CAAD,CAAT,EAAc;AACV8C,MAAAA,IAAI,CAAC9C,CAAD,CAAJ,GAAU4E,IAAV;AACA7B,MAAAA,KAAK,GAAG/C,CAAR;AACA;AACH;AACJ;;AAED,SAAO+C,KAAP;AACH;;AAED,SAASmR,QAAT,CAAkBtP,IAAlB,EAAwBN,GAAxB,EAA6BgQ,UAA7B,EAAyC5G,OAAzC,EAAkD;AAC9C,OAAK,IAAI1N,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0N,OAApB,EAA6B1N,CAAC,EAA9B,EAAkC;AAC9B,QAAIoO,GAAG,GAAG;AACNjB,MAAAA,SAAS,EAAMvI,IAAI,CAACuI,SADd;AAENF,MAAAA,WAAW,EAAIrI,IAAI,CAACqI,WAFd;AAGNI,MAAAA,YAAY,EAAGzI,IAAI,CAACyI,YAHd;AAINN,MAAAA,UAAU,EAAKnI,IAAI,CAACmI;AAJd,KAAV;AAMAqH,IAAAA,YAAY,CAAC9P,GAAD,EAAM8J,GAAN,EAAWkG,UAAU,GAAGtU,CAAxB,CAAZ;AACH;AACJ;;AAED,IAAIuU,mBAAmB,GAAG,UAAU9R,KAAV,EAAiB;AACzC,MAAI5B,GAAG,GAAG4B,KAAK,CAAC5B,GAAhB;AACA,MAAI+B,OAAO,GAAGH,KAAK,CAACG,OAApB;AACA,MAAI4R,UAAU,GAAG/R,KAAK,CAAC+R,UAAvB;AAEA,SAAQ,yBAAyB3T,GAAzB,GAA+B,SAA/B,GAA4CZ,OAAO,CAAC2C,OAAD,EAAU,UAAU4D,GAAV,EAAe;AAAE,WAAQ,iCAAkCA,GAAG,CAACzD,KAAtC,GAA+C,aAA/C,GAAgEyR,UAAU,CAAChO,GAAG,CAACtD,MAAL,CAAV,CAAuBsD,GAAvB,CAAhE,GAA+F,2BAAvG;AAAsI,GAAjK,CAAnD,GAAyN,iBAAjO;AACD,CAND;;AAQA,IAAIiO,yBAAyB,GAAG,UAAU5T,GAAV,EAAe;AAC7C,MAAI6T,KAAK,GAAG7T,GAAG,CAAC6T,KAAhB;AACA,MAAIC,QAAQ,GAAG9T,GAAG,CAAC8T,QAAnB;AAEA,SAAQ,uBAAuBD,KAAK,KAAK,KAAV,GAAkB,SAAlB,GAA8B,EAArD,IAA2D,KAA3D,GAAoEzU,OAAO,CAAC0U,QAAD,EAAW,UAAU1S,CAAV,EAAa;AACzG,QAAI2S,EAAE,GAAG5P,kBAAkB,CAAC6P,cAAnB,CAAkC5S,CAAlC,CAAT;AACA,QAAIxC,GAAG,GAAGuF,kBAAkB,CAAC8P,WAAnB,CAA+B7S,CAA/B,CAAV;AACA,WAAQ,oBAAoB2S,EAAE,GAAI,gBAAgBA,EAAhB,GAAqB,IAAzB,GAAiC,EAAvD,IAA6D,SAA7D,GAAyEnV,GAAzE,GAA+E,MAAvF;AACH,GAJoF,CAA3E,GAIJ,oBAJJ;AAKD,CATD;;AAWA,IAAIsV,0BAA0B,GAAG,UAAUlU,GAAV,EAAe;AAC9C,MAAIjC,IAAI,GAAGiC,GAAG,CAACjC,IAAf;AAEA,SAAQ,2BAA4BoG,kBAAkB,CAACgQ,iBAAnB,CAAqCpW,IAArC,CAA5B,GAA0E,OAAlF;AACD,CAJD;;AAMA,IAAIqW,sBAAsB,GAAG,UAAUpU,GAAV,EAAe;AAC1C,MAAIjC,IAAI,GAAGiC,GAAG,CAACjC,IAAf;AACA,MAAI2D,KAAK,GAAG1B,GAAG,CAAC0B,KAAhB;AAEA,SAAQ,uBAAuB,YAAY2S,IAAZ,CAAiBtW,IAAjB,IAAyB,CAAzB,GAA6B,CAApD,IAAyD,mBAAzD,IAAgF,QAAQsW,IAAR,CAAatW,IAAb,IAAqB,CAArB,GAAyB,CAAzG,IAA8G,mBAA9G,GAAoI2D,KAApI,GAA4I,OAApJ;AACD,CALD;;AAOA,IAAI4S,wBAAwB,GAAG,UAAUtU,GAAV,EAAe;AAC1C,MAAIuU,MAAM,GAAGvU,GAAG,CAACuU,MAAjB;AACA,MAAIC,MAAM,GAAGxU,GAAG,CAACwU,MAAjB;AAEA,SAAQ,eAAeD,MAAM,GAAG,WAAH,GAAiB,EAAtC,IAA4C,SAA5C,GAAyDnV,OAAO,CAACoV,MAAD,EAAS,UAAU9S,KAAV,EAAiB;AAAE,WAAQ,2BAA2BA,KAA3B,GAAmC,OAA3C;AAAsD,GAAlF,CAAhE,GAAuJ,gBAA/J;AACH,CALD;;AAOA,SAASyC,kBAAT,CAA4B9B,MAA5B,EAAoC;AAChC,SAAOqR,mBAAmB,CAAC;AACvB1T,IAAAA,GAAG,EAAEqC,MAAM,CAACrC,GADW;AAEvB+B,IAAAA,OAAO,EAAEM,MAAM,CAACN,OAFO;AAGvB4R,IAAAA,UAAU,EAAE;AACRc,MAAAA,MAAM,EAAIb,yBADF;AAERc,MAAAA,OAAO,EAAGR,0BAFF;AAGR3H,MAAAA,GAAG,EAAO6H,sBAHF;AAIR1S,MAAAA,KAAK,EAAK4S;AAJF;AAHW,GAAD,CAA1B;AAUH;;AAEDnQ,kBAAkB,CAAC6P,cAAnB,GAAoC,UAAS5S,CAAT,EAAY;AAC5C,SAAO;AACHuT,IAAAA,EAAE,EAAI,OADH;AAEHC,IAAAA,EAAE,EAAI,aAFH;AAGHC,IAAAA,GAAG,EAAG,oBAHH;AAIHC,IAAAA,EAAE,EAAI,UAJH;AAKHC,IAAAA,GAAG,EAAG,iBALH;AAMHC,IAAAA,EAAE,EAAI,UANH;AAQH;AACA;AACA;AACAC,IAAAA,gBAAgB,EAAE,UAXf;AAYHC,IAAAA,cAAc,EAAE,UAZb;AAaHC,IAAAA,cAAc,EAAE,UAbb;AAcHC,IAAAA,YAAY,EAAE;AAdX,IAeLhU,CAAC,CAACmD,QAAF,CAAWwL,WAAX,EAfK,CAAP;AAgBH,CAjBD;;AAmBA,SAASzO,UAAT,CAAoBH,IAApB,EAA0B;AACtB,MAAI,MAAMkT,IAAN,CAAWlT,IAAX,CAAJ,EAAsB;AAAE;AACpB,WAAOA,IAAP;AACH;;AACD,MAAI,sBAAsBkT,IAAtB,CAA2BlT,IAA3B,CAAJ,EAAsC;AAClC,WAAOA,IAAP,CADkC,CACd;AACvB;;AACD,SAAO,MAAMA,IAAI,CAACrC,OAAL,CAAa,OAAb,EAAsB,KAAtB,CAAN,GAAqC,GAA5C;AACH;;AAEDqF,kBAAkB,CAAC8P,WAAnB,GAAiC,UAAS7S,CAAT,EAAY;AACzC,WAASiU,GAAT,CAAanW,GAAb,EAAkB;AACd,WAAOA,GAAG,CAACJ,OAAJ,CAAY,SAAZ,EAAuB,KAAvB,CAAP;AACH;;AAED,UAAQsC,CAAC,CAACmD,QAAF,CAAWwL,WAAX,EAAR;AACI,SAAK,YAAL;AACA,SAAK,kBAAL;AACI,aAAOsF,GAAG,CAACjU,CAAC,CAACM,KAAH,CAAH,GAAe,GAAtB;;AAEJ,SAAK,UAAL;AACA,SAAK,gBAAL;AACI,aAAO,MAAM2T,GAAG,CAACjU,CAAC,CAACM,KAAH,CAAhB;;AAEJ,SAAK,UAAL;AACA,SAAK,gBAAL;AACI,aAAO,MAAM2T,GAAG,CAACjU,CAAC,CAACM,KAAH,CAAT,GAAqB,GAA5B;;AAEJ;AACI,aAAON,CAAC,CAACM,KAAT;AAdR;AAgBH,CArBD;;AAuBAyC,kBAAkB,CAACgQ,iBAAnB,GAAuC,UAASpW,IAAT,EAAe;AAClD,SAAO;AACHuX,IAAAA,QAAQ,EAAI,IADT;AAEHC,IAAAA,QAAQ,EAAI,IAFT;AAGHC,IAAAA,QAAQ,EAAI,IAHT;AAIHC,IAAAA,QAAQ,EAAI,IAJT;AAKHC,IAAAA,OAAO,EAAK,IALT;AAMHC,IAAAA,QAAQ,EAAI,IANT;AAOHC,IAAAA,KAAK,EAAO,IAPT;AAQHC,IAAAA,KAAK,EAAO,IART;AASHC,IAAAA,GAAG,EAAS,IATT;AAUHC,IAAAA,IAAI,EAAQ,IAVT;AAWHC,IAAAA,IAAI,EAAQ,IAXT;AAYHC,IAAAA,MAAM,EAAM,IAZT;AAaHC,IAAAA,SAAS,EAAG,IAbT;AAcHC,IAAAA,OAAO,EAAK,KAdT;AAeHC,IAAAA,QAAQ,EAAI,KAfT;AAgBHC,IAAAA,QAAQ,EAAI;AAhBT,IAiBLtY,IAAI,CAACgS,WAAL,EAjBK,KAiBkBhS,IAjBzB;AAkBH,CAnBD;;AAqBA,SACI4Q,QADJ,EAEI7F,SAFJ","sourcesContent":["import map from './utils/map';\nimport createZip from './utils/create-zip';\nimport IntlService from './services/intl-service';\nimport dateToSerial from './utils/time';\n\nvar MIME_TYPE = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\nvar DATA_URL_PREFIX = \"data:\" + MIME_TYPE + \";base64,\";\nvar DATA_URL_OPTIONS = { compression: \"DEFLATE\", type: \"base64\" };\nvar BLOB_OPTIONS = { compression: \"DEFLATE\", type: \"blob\" };\nvar ARRAYBUFFER_OPTIONS = { compression: \"DEFLATE\", type: \"arraybuffer\" };\n\n/* eslint-disable key-spacing, no-arrow-condition, indent, no-nested-ternary, consistent-return */\n\nfunction toDataURI(content) {\n    return DATA_URL_PREFIX + content;\n}\n\nfunction indexOf(thing, array) {\n    return array.indexOf(thing);\n}\n\nvar parseJSON = JSON.parse.bind(JSON);\n\nfunction ESC(val) {\n    return String(val)\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\\\"/g, \"&quot;\")\n        .replace(/\\'/g, \"&#39;\");\n}\n\nfunction repeat(count, func) {\n    var str = \"\";\n    for (var i = 0; i < count; ++i) {\n        str += func(i);\n    }\n    return str;\n}\n\nfunction foreach(arr, func) {\n    var str = \"\";\n    if (arr != null) {\n        if (Array.isArray(arr)) {\n            for (var i = 0; i < arr.length; ++i) {\n                str += func(arr[i], i);\n            }\n        } else if (typeof arr == \"object\") {\n            Object.keys(arr).forEach(function (key, i) {\n                str += func(arr[key], key, i);\n            });\n        }\n    }\n    return str;\n}\n\nvar XMLHEAD = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r';\n\nvar RELS = XMLHEAD + \"\\n            <Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n               <Relationship Id=\\\"rId3\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\\\" Target=\\\"docProps/app.xml\\\"/>\\n               <Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\\\" Target=\\\"docProps/core.xml\\\"/>\\n               <Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\\\" Target=\\\"xl/workbook.xml\\\"/>\\n            </Relationships>\";\n\nvar CORE = function (ref) {\n  var creator = ref.creator;\n  var lastModifiedBy = ref.lastModifiedBy;\n  var created = ref.created;\n  var modified = ref.modified;\n\n  return (XMLHEAD + \"\\n <cp:coreProperties xmlns:cp=\\\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\\\"\\n   xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:dcterms=\\\"http://purl.org/dc/terms/\\\"\\n   xmlns:dcmitype=\\\"http://purl.org/dc/dcmitype/\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\n   <dc:creator>\" + (ESC(creator)) + \"</dc:creator>\\n   <cp:lastModifiedBy>\" + (ESC(lastModifiedBy)) + \"</cp:lastModifiedBy>\\n   <dcterms:created xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(created)) + \"</dcterms:created>\\n   <dcterms:modified xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(modified)) + \"</dcterms:modified>\\n</cp:coreProperties>\");\n};\n\nvar APP = function (ref) {\n  var sheets = ref.sheets;\n\n  return (XMLHEAD + \"\\n<Properties xmlns=\\\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\\\" xmlns:vt=\\\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\\\">\\n  <Application>Microsoft Excel</Application>\\n  <DocSecurity>0</DocSecurity>\\n  <ScaleCrop>false</ScaleCrop>\\n  <HeadingPairs>\\n    <vt:vector size=\\\"2\\\" baseType=\\\"variant\\\">\\n      <vt:variant>\\n        <vt:lpstr>Worksheets</vt:lpstr>\\n      </vt:variant>\\n      <vt:variant>\\n        <vt:i4>\" + (sheets.length) + \"</vt:i4>\\n      </vt:variant>\\n    </vt:vector>\\n  </HeadingPairs>\\n  <TitlesOfParts>\\n    <vt:vector size=\\\"\" + (sheets.length) + \"\\\" baseType=\\\"lpstr\\\">\" + (foreach(sheets, function (sheet, i) { return sheet.options.title\n          ? (\"<vt:lpstr>\" + (ESC(sheet.options.title)) + \"</vt:lpstr>\")\n          : (\"<vt:lpstr>Sheet\" + (i + 1) + \"</vt:lpstr>\"); }\n      )) + \"</vt:vector>\\n  </TitlesOfParts>\\n  <LinksUpToDate>false</LinksUpToDate>\\n  <SharedDoc>false</SharedDoc>\\n  <HyperlinksChanged>false</HyperlinksChanged>\\n  <AppVersion>14.0300</AppVersion>\\n</Properties>\");\n};\n\nvar CONTENT_TYPES = function (ref) {\n  var sheetCount = ref.sheetCount;\n  var commentFiles = ref.commentFiles;\n  var drawingFiles = ref.drawingFiles;\n\n  return (XMLHEAD + \"\\n<Types xmlns=\\\"http://schemas.openxmlformats.org/package/2006/content-types\\\">\\n  <Default Extension=\\\"png\\\" ContentType=\\\"image/png\\\"/>\\n  <Default Extension=\\\"gif\\\" ContentType=\\\"image/gif\\\"/>\\n  <Default Extension=\\\"jpg\\\" ContentType=\\\"image/jpeg\\\"/>\\n  <Default Extension=\\\"rels\\\" ContentType=\\\"application/vnd.openxmlformats-package.relationships+xml\\\" />\\n  <Default Extension=\\\"xml\\\" ContentType=\\\"application/xml\\\" />\\n  <Default Extension=\\\"vml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.vmlDrawing\\\"/>\\n  <Override PartName=\\\"/xl/workbook.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\\\" />\\n  <Override PartName=\\\"/xl/styles.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\\\"/>\\n  <Override PartName=\\\"/xl/sharedStrings.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\\\"/>\\n  \" + (repeat(sheetCount, function (idx) { return (\"<Override PartName=\\\"/xl/worksheets/sheet\" + (idx + 1) + \".xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\\\" />\"); })) + \"\\n  \" + (foreach(commentFiles, function (filename) { return (\"<Override PartName=\\\"/xl/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\\\"/>\"); })) + \"\\n  \" + (foreach(drawingFiles, function (filename) { return (\"<Override PartName=\\\"/xl/drawings/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.drawing+xml\\\"/>\"); })) + \"\\n  <Override PartName=\\\"/docProps/core.xml\\\" ContentType=\\\"application/vnd.openxmlformats-package.core-properties+xml\\\" />\\n  <Override PartName=\\\"/docProps/app.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.extended-properties+xml\\\" />\\n</Types>\");\n};\n\nvar WORKBOOK = function (ref) {\n  var sheets = ref.sheets;\n  var filterNames = ref.filterNames;\n  var userNames = ref.userNames;\n\n  return (XMLHEAD + \"\\n<workbook xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  <fileVersion appName=\\\"xl\\\" lastEdited=\\\"5\\\" lowestEdited=\\\"5\\\" rupBuild=\\\"9303\\\" />\\n  <workbookPr defaultThemeVersion=\\\"124226\\\" />\\n  <bookViews>\\n    <workbookView xWindow=\\\"240\\\" yWindow=\\\"45\\\" windowWidth=\\\"18195\\\" windowHeight=\\\"7995\\\" />\\n  </bookViews>\\n  <sheets>\\n  \" + (foreach(sheets, function (ref, i) {\n    var options = ref.options;\n\n    var name = options.name || options.title || (\"Sheet\" + (i + 1));\n    return (\"<sheet name=\\\"\" + (ESC(name)) + \"\\\" sheetId=\\\"\" + (i + 1) + \"\\\" r:id=\\\"rId\" + (i + 1) + \"\\\" />\");\n  })) + \"\\n  </sheets>\\n  \" + (filterNames.length || userNames.length ? (\"\\n    <definedNames>\\n      \" + (foreach(filterNames, function (f) { return (\"\\n         <definedName name=\\\"_xlnm._FilterDatabase\\\" hidden=\\\"1\\\" localSheetId=\\\"\" + (f.localSheetId) + \"\\\">\" + (ESC(quoteSheet(f.name))) + \"!\" + (ESC(f.from)) + \":\" + (ESC(f.to)) + \"</definedName>\"); })) + \"\\n      \" + (foreach(userNames, function (f) { return (\"\\n         <definedName name=\\\"\" + (f.name) + \"\\\" hidden=\\\"\" + (f.hidden ? 1 : 0) + \"\\\" \" + (f.localSheetId != null ? (\"localSheetId=\\\"\" + (f.localSheetId) + \"\\\"\") : '') + \">\" + (ESC(f.value)) + \"</definedName>\"); })) + \"\\n    </definedNames>\") : '') + \"\\n  <calcPr fullCalcOnLoad=\\\"1\\\" calcId=\\\"145621\\\" />\\n</workbook>\");\n};\n\nvar WORKSHEET = function (ref$1) {\n  var frozenColumns = ref$1.frozenColumns;\n  var frozenRows = ref$1.frozenRows;\n  var columns = ref$1.columns;\n  var defaults = ref$1.defaults;\n  var data = ref$1.data;\n  var index = ref$1.index;\n  var mergeCells = ref$1.mergeCells;\n  var autoFilter = ref$1.autoFilter;\n  var filter = ref$1.filter;\n  var showGridLines = ref$1.showGridLines;\n  var hyperlinks = ref$1.hyperlinks;\n  var validations = ref$1.validations;\n  var defaultCellStyleId = ref$1.defaultCellStyleId;\n  var rtl = ref$1.rtl;\n  var legacyDrawing = ref$1.legacyDrawing;\n  var drawing = ref$1.drawing;\n  var lastRow = ref$1.lastRow;\n  var lastCol = ref$1.lastCol;\n\n  return (XMLHEAD + \"\\n<worksheet xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\" mc:Ignorable=\\\"x14ac\\\">\\n   \" + (lastRow && lastCol ? (\"<dimension ref=\\\"A1:\" + (ref(lastRow - 1, lastCol - 1)) + \"\\\" />\") : \"\") + \"\\n\\n   <sheetViews>\\n     <sheetView \" + (rtl ? 'rightToLeft=\"1\"' : '') + \" \" + (index === 0 ? 'tabSelected=\"1\"' : '') + \" workbookViewId=\\\"0\\\" \" + (showGridLines === false ? 'showGridLines=\"0\"' : '') + \">\\n     \" + (frozenRows || frozenColumns ? (\"\\n       <pane state=\\\"frozen\\\"\\n         \" + (frozenColumns ? (\"xSplit=\\\"\" + frozenColumns + \"\\\"\") : '') + \"\\n         \" + (frozenRows ? (\"ySplit=\\\"\" + frozenRows + \"\\\"\") : '') + \"\\n         topLeftCell=\\\"\" + (String.fromCharCode(65 + (frozenColumns || 0)) + ((frozenRows || 0) + 1)) + \"\\\"\\n       />\") : '') + \"\\n     </sheetView>\\n   </sheetViews>\\n\\n   <sheetFormatPr x14ac:dyDescent=\\\"0.25\\\" \" + (!defaults.skipCustomHeight ? 'customHeight=\"1\"' : '') + \" defaultRowHeight=\\\"\" + (defaults.rowHeight ? defaults.rowHeight * 0.75 : 15) + \"\\\"\\n     \" + (defaults.columnWidth ? (\"defaultColWidth=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" />\\n\\n   \" + (defaultCellStyleId != null || (columns && columns.length > 0) ? (\"\\n     <cols>\\n       \" + (!columns || !columns.length ? (\"\\n         <col min=\\\"1\\\" max=\\\"16384\\\" style=\\\"\" + defaultCellStyleId + \"\\\"\\n              \" + (defaults.columnWidth ? (\"width=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" /> \") : '') + \"\\n       \" + (foreach(columns, function (column, ci) {\n         var columnIndex = typeof column.index === \"number\" ? column.index + 1 : (ci + 1);\n         if (column.width === 0) {\n           return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                        min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" hidden=\\\"1\\\" customWidth=\\\"1\\\" />\");\n         }\n         return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                      min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" customWidth=\\\"1\\\"\\n                      \" + (column.autoWidth\n                          ? (\"width=\\\"\" + (((column.width * 7 + 5) / 7 * 256) / 256) + \"\\\" bestFit=\\\"1\\\"\")\n                          : (\"width=\\\"\" + (toWidth(column.width)) + \"\\\"\")) + \" />\");\n       })) + \"\\n     </cols>\") : '') + \"\\n\\n   <sheetData>\\n     \" + (foreach(data, function (row, ri) {\n       var rowIndex = typeof row.index === \"number\" ? row.index + 1 : (ri + 1);\n       return (\"\\n         <row r=\\\"\" + rowIndex + \"\\\" x14ac:dyDescent=\\\"0.25\\\"\\n              \" + (row.level ? (\"outlineLevel=\\\"\" + (row.level) + \"\\\"\") : '') + \"\\n              \" + (row.height === 0 ? 'hidden=\"1\"'\n                                 : row.height ? (\"ht=\\\"\" + (toHeight(row.height)) + \"\\\" customHeight=\\\"1\\\"\") : \"\") + \">\\n           \" + (foreach(row.data, function (cell) { return (\"\\n             <c r=\\\"\" + (cell.ref) + \"\\\" \" + (cell.style ? (\"s=\\\"\" + (cell.style) + \"\\\"\") : '') + \" \" + (cell.type ? (\"t=\\\"\" + (cell.type) + \"\\\"\") : '') + \">\\n               \" + (cell.formula != null ? writeFormula(cell.formula) : '') + \"\\n               \" + (cell.value != null ? (\"<v>\" + (ESC(cell.value)) + \"</v>\") : '') + \"\\n             </c>\"); })) + \"\\n         </row>\\n       \");})) + \"\\n   </sheetData>\\n\\n   \" + (autoFilter ? (\"<autoFilter ref=\\\"\" + (autoFilter.from) + \":\" + (autoFilter.to) + \"\\\"/>\")\n                : filter ? spreadsheetFilters(filter) : '') + \"\\n\\n   \" + (mergeCells.length ? (\"\\n     <mergeCells count=\\\"\" + (mergeCells.length) + \"\\\">\\n       \" + (foreach(mergeCells, function (ref) { return (\"<mergeCell ref=\\\"\" + ref + \"\\\"/>\"); })) + \"\\n     </mergeCells>\") : '') + \"\\n\\n   \" + (validations.length ? (\"\\n     <dataValidations>\\n       \" + (foreach(validations, function (val) { return (\"\\n         <dataValidation sqref=\\\"\" + (val.sqref.join(\" \")) + \"\\\"\\n                         showErrorMessage=\\\"\" + (val.showErrorMessage) + \"\\\"\\n                         type=\\\"\" + (ESC(val.type)) + \"\\\"\\n                         \" + (val.type !== \"list\" ? (\"operator=\\\"\" + (ESC(val.operator)) + \"\\\"\") : '') + \"\\n                         allowBlank=\\\"\" + (val.allowBlank) + \"\\\"\\n                         showDropDown=\\\"\" + (val.showDropDown) + \"\\\"\\n                         \" + (val.error ? (\"error=\\\"\" + (ESC(val.error)) + \"\\\"\") : '') + \"\\n                         \" + (val.errorTitle ? (\"errorTitle=\\\"\" + (ESC(val.errorTitle)) + \"\\\"\") : '') + \">\\n           \" + (val.formula1 ? (\"<formula1>\" + (ESC(val.formula1)) + \"</formula1>\") : '') + \"\\n           \" + (val.formula2 ? (\"<formula2>\" + (ESC(val.formula2)) + \"</formula2>\") : '') + \"\\n         </dataValidation>\"); })) + \"\\n     </dataValidations>\") : '') + \"\\n\\n   \" + (hyperlinks.length ? (\"\\n     <hyperlinks>\\n       \" + (foreach(hyperlinks, function (link) { return (\"\\n         <hyperlink ref=\\\"\" + (link.ref) + \"\\\" r:id=\\\"\" + (link.rId) + \"\\\"/>\"); })) + \"\\n     </hyperlinks>\") : '') + \"\\n\\n   <pageMargins left=\\\"0.7\\\" right=\\\"0.7\\\" top=\\\"0.75\\\" bottom=\\\"0.75\\\" header=\\\"0.3\\\" footer=\\\"0.3\\\" />\\n   \" + (drawing ? (\"<drawing r:id=\\\"\" + drawing + \"\\\"/>\") : '') + \"\\n   \" + (legacyDrawing ? (\"<legacyDrawing r:id=\\\"\" + legacyDrawing + \"\\\"/>\") : '') + \"\\n</worksheet>\");\n};\n\nvar WORKBOOK_RELS = function (ref) {\n  var count = ref.count;\n\n  return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (repeat(count, function (idx) { return (\"\\n    <Relationship Id=\\\"rId\" + (idx + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\\\" Target=\\\"worksheets/sheet\" + (idx + 1) + \".xml\\\" />\"); })) + \"\\n  <Relationship Id=\\\"rId\" + (count + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\\\" Target=\\\"styles.xml\\\" />\\n  <Relationship Id=\\\"rId\" + (count + 2) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\\\" Target=\\\"sharedStrings.xml\\\" />\\n</Relationships>\");\n};\n\nvar WORKSHEET_RELS = function (ref) {\n  var hyperlinks = ref.hyperlinks;\n  var comments = ref.comments;\n  var sheetIndex = ref.sheetIndex;\n  var drawings = ref.drawings;\n\n  return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(hyperlinks, function (link) { return (\"\\n    <Relationship Id=\\\"\" + (link.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\\\" Target=\\\"\" + (ESC(link.target)) + \"\\\" TargetMode=\\\"External\\\" />\"); })) + \"\\n  \" + (!comments.length ? '' : (\"\\n    <Relationship Id=\\\"comment\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\\\" Target=\\\"../comments\" + sheetIndex + \".xml\\\"/>\\n    <Relationship Id=\\\"vml\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\\\" Target=\\\"../drawings/vmlDrawing\" + sheetIndex + \".vml\\\"/>\")) + \"\\n  \" + (!drawings.length ? '' : (\"\\n    <Relationship Id=\\\"drw\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\\\" Target=\\\"../drawings/drawing\" + sheetIndex + \".xml\\\"/>\")) + \"\\n</Relationships>\");\n};\n\nvar COMMENTS_XML = function (ref) {\n  var comments = ref.comments;\n\n  return (XMLHEAD + \"\\n<comments xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\">\\n  <authors>\\n    <author></author>\\n  </authors>\\n  <commentList>\\n    \" + (foreach(comments, function (comment) { return (\"\\n      <comment ref=\\\"\" + (comment.ref) + \"\\\" authorId=\\\"0\\\">\\n        <text>\\n          <r>\\n            <rPr>\\n              <sz val=\\\"8\\\"/>\\n              <color indexed=\\\"81\\\"/>\\n              <rFont val=\\\"Tahoma\\\"/>\\n              <charset val=\\\"1\\\"/>\\n            </rPr>\\n            <t>\" + (ESC(comment.text)) + \"</t>\\n          </r>\\n        </text>\\n      </comment>\"); })) + \"\\n  </commentList>\\n</comments>\");\n};\n\nvar LEGACY_DRAWING = function (ref) {\n  var comments = ref.comments;\n\n  return (\"<xml xmlns:v=\\\"urn:schemas-microsoft-com:vml\\\"\\n     xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\"\\n     xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\">\\n  <v:shapetype coordsize=\\\"21600,21600\\\" id=\\\"_x0000_t202\\\" path=\\\"m,l,21600r21600,l21600,xe\\\">\\n    <v:stroke joinstyle=\\\"miter\\\"/>\\n    <v:path gradientshapeok=\\\"t\\\" o:connecttype=\\\"rect\\\"/>\\n  </v:shapetype>\\n  \" + (foreach(comments, function (comment) { return (\"\\n    <v:shape type=\\\"#_x0000_t202\\\" style=\\\"visibility: hidden\\\" fillcolor=\\\"#ffffe1\\\" o:insetmode=\\\"auto\\\">\\n      <v:shadow on=\\\"t\\\" color=\\\"black\\\" obscured=\\\"t\\\"/>\\n      <x:ClientData ObjectType=\\\"Note\\\">\\n        <x:MoveWithCells/>\\n        <x:SizeWithCells/>\\n        <x:Anchor>\" + (comment.anchor) + \"</x:Anchor>\\n        <x:AutoFill>False</x:AutoFill>\\n        <x:Row>\" + (comment.row) + \"</x:Row>\\n        <x:Column>\" + (comment.col) + \"</x:Column>\\n      </x:ClientData>\\n    </v:shape>\"); })) + \"\\n</xml>\");\n};\n\nvar DRAWINGS_XML = function (drawings) { return (XMLHEAD + \"\\n<xdr:wsDr xmlns:xdr=\\\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\\\"\\n          xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\"\\n          xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  \" + (foreach(drawings, function (drawing, index) { return (\"\\n    <xdr:oneCellAnchor editAs=\\\"oneCell\\\">\\n      <xdr:from>\\n        <xdr:col>\" + (drawing.col) + \"</xdr:col>\\n        <xdr:colOff>\" + (drawing.colOffset) + \"</xdr:colOff>\\n        <xdr:row>\" + (drawing.row) + \"</xdr:row>\\n        <xdr:rowOff>\" + (drawing.rowOffset) + \"</xdr:rowOff>\\n      </xdr:from>\\n      <xdr:ext cx=\\\"\" + (drawing.width) + \"\\\" cy=\\\"\" + (drawing.height) + \"\\\" />\\n      <xdr:pic>\\n        <xdr:nvPicPr>\\n          <xdr:cNvPr id=\\\"\" + (index + 1) + \"\\\" name=\\\"Picture \" + (index + 1) + \"\\\"/>\\n          <xdr:cNvPicPr/>\\n        </xdr:nvPicPr>\\n        <xdr:blipFill>\\n          <a:blip r:embed=\\\"\" + (drawing.imageId) + \"\\\"/>\\n          <a:stretch>\\n            <a:fillRect/>\\n          </a:stretch>\\n        </xdr:blipFill>\\n        <xdr:spPr>\\n          <a:prstGeom prst=\\\"rect\\\">\\n            <a:avLst/>\\n          </a:prstGeom>\\n        </xdr:spPr>\\n      </xdr:pic>\\n      <xdr:clientData/>\\n    </xdr:oneCellAnchor>\"); })) + \"\\n</xdr:wsDr>\"); };\n\nvar DRAWINGS_RELS_XML = function (rels) { return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(rels, function (rel) { return (\"\\n    <Relationship Id=\\\"\" + (rel.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\\\" Target=\\\"\" + (rel.target) + \"\\\"/>\"); })) + \"\\n</Relationships>\"); };\n\nvar SHARED_STRINGS = function (ref) {\n  var count = ref.count;\n  var uniqueCount = ref.uniqueCount;\n  var indexes = ref.indexes;\n\n  return (XMLHEAD + \"\\n<sst xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" count=\\\"\" + count + \"\\\" uniqueCount=\\\"\" + uniqueCount + \"\\\">\\n  \" + (foreach(Object.keys(indexes), function (index) { return (\"\\n    <si><t xml:space=\\\"preserve\\\">\" + (ESC(index.substring(1))) + \"</t></si>\"); })) + \"\\n</sst>\");\n};\n\nvar STYLES = function (ref) {\n  var formats = ref.formats;\n  var fonts = ref.fonts;\n  var fills = ref.fills;\n  var borders = ref.borders;\n  var styles = ref.styles;\n\n  return (XMLHEAD + \"\\n<styleSheet\\n    xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\"\\n    xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\"\\n    mc:Ignorable=\\\"x14ac\\\"\\n    xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\">\\n  <numFmts count=\\\"\" + (formats.length) + \"\\\">\\n  \" + (foreach(formats, function (format, fi) { return (\"\\n    <numFmt formatCode=\\\"\" + (ESC(format.format)) + \"\\\" numFmtId=\\\"\" + (165 + fi) + \"\\\" />\"); })) + \"\\n  </numFmts>\\n  <fonts count=\\\"\" + (fonts.length + 1) + \"\\\" x14ac:knownFonts=\\\"1\\\">\\n    <font>\\n       <sz val=\\\"11\\\" />\\n       <color theme=\\\"1\\\" />\\n       <name val=\\\"Calibri\\\" />\\n       <family val=\\\"2\\\" />\\n       <scheme val=\\\"minor\\\" />\\n    </font>\\n    \" + (foreach(fonts, function (font) { return (\"\\n    <font>\\n      \" + (font.bold ? '<b/>' : '') + \"\\n      \" + (font.italic ? '<i/>' : '') + \"\\n      \" + (font.underline ? '<u/>' : '') + \"\\n      <sz val=\\\"\" + (font.fontSize || 11) + \"\\\" />\\n      \" + (font.color ? (\"<color rgb=\\\"\" + (ESC(font.color)) + \"\\\" />\") : '<color theme=\"1\" />') + \"\\n      \" + (font.fontFamily ? (\"\\n        <name val=\\\"\" + (ESC(font.fontFamily)) + \"\\\" />\\n        <family val=\\\"2\\\" />\\n      \") : \"\\n        <name val=\\\"Calibri\\\" />\\n        <family val=\\\"2\\\" />\\n        <scheme val=\\\"minor\\\" />\\n      \") + \"\\n    </font>\"); })) + \"\\n  </fonts>\\n  <fills count=\\\"\" + (fills.length + 2) + \"\\\">\\n      <fill><patternFill patternType=\\\"none\\\"/></fill>\\n      <fill><patternFill patternType=\\\"gray125\\\"/></fill>\\n    \" + (foreach(fills, function (fill) { return (\"\\n      \" + (fill.background ? (\"\\n        <fill>\\n          <patternFill patternType=\\\"solid\\\">\\n              <fgColor rgb=\\\"\" + (ESC(fill.background)) + \"\\\"/>\\n          </patternFill>\\n        </fill>\\n      \") : '')); })) + \"\\n  </fills>\\n  <borders count=\\\"\" + (borders.length + 1) + \"\\\">\\n    <border><left/><right/><top/><bottom/><diagonal/></border>\\n    \" + (foreach(borders, borderTemplate)) + \"\\n  </borders>\\n  <cellStyleXfs count=\\\"1\\\">\\n    <xf borderId=\\\"0\\\" fillId=\\\"0\\\" fontId=\\\"0\\\" />\\n  </cellStyleXfs>\\n  <cellXfs count=\\\"\" + (styles.length + 1) + \"\\\">\\n    <xf numFmtId=\\\"0\\\" fontId=\\\"0\\\" fillId=\\\"0\\\" borderId=\\\"0\\\" xfId=\\\"0\\\" />\\n    \" + (foreach(styles, function (style) { return (\"\\n      <xf xfId=\\\"0\\\"\\n          \" + (style.fontId ? (\"fontId=\\\"\" + (style.fontId) + \"\\\" applyFont=\\\"1\\\"\") : '') + \"\\n          \" + (style.fillId ? (\"fillId=\\\"\" + (style.fillId) + \"\\\" applyFill=\\\"1\\\"\") : '') + \"\\n          \" + (style.numFmtId ? (\"numFmtId=\\\"\" + (style.numFmtId) + \"\\\" applyNumberFormat=\\\"1\\\"\") : '') + \"\\n          \" + (style.textAlign || style.verticalAlign || style.wrap ? 'applyAlignment=\"1\"' : '') + \"\\n          \" + (style.borderId ? (\"borderId=\\\"\" + (style.borderId) + \"\\\" applyBorder=\\\"1\\\"\") : '') + \">\\n        \" + (style.textAlign || style.verticalAlign || style.wrap ? (\"\\n        <alignment\\n          \" + (style.textAlign ? (\"horizontal=\\\"\" + (ESC(style.textAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.verticalAlign ? (\"vertical=\\\"\" + (ESC(style.verticalAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.indent ? (\"indent=\\\"\" + (ESC(style.indent)) + \"\\\"\") : '') + \"\\n          \" + (style.wrap ? 'wrapText=\"1\"' : '') + \" />\\n        \") : '') + \"\\n      </xf>\\n    \"); })) + \"\\n  </cellXfs>\\n  <cellStyles count=\\\"1\\\">\\n    <cellStyle name=\\\"Normal\\\" xfId=\\\"0\\\" builtinId=\\\"0\\\"/>\\n  </cellStyles>\\n  <dxfs count=\\\"0\\\" />\\n  <tableStyles count=\\\"0\\\" defaultTableStyle=\\\"TableStyleMedium2\\\" defaultPivotStyle=\\\"PivotStyleMedium9\\\" />\\n</styleSheet>\");\n};\n\nfunction writeFormula(formula) {\n    if (typeof formula == \"string\") {\n        return (\"<f>\" + (ESC(formula)) + \"</f>\");\n    }\n    // array formulas\n    return (\"<f t=\\\"array\\\" ref=\\\"\" + (formula.ref) + \"\\\">\" + (ESC(formula.src)) + \"</f>\");\n}\n\nfunction numChar(colIndex) {\n   var letter = Math.floor(colIndex / 26) - 1;\n\n   return (letter >= 0 ? numChar(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n}\n\nfunction ref(rowIndex, colIndex) {\n    return numChar(colIndex) + (rowIndex + 1);\n}\n\nfunction $ref(rowIndex, colIndex) {\n    return \"$\" + numChar(colIndex) + \"$\" + (rowIndex + 1);\n}\n\nfunction filterRowIndex(options) {\n    var frozenRows = options.frozenRows || (options.freezePane || {}).rowSplit || 1;\n    return frozenRows - 1;\n}\n\nfunction toWidth(px) {\n    var maximumDigitWidth = 7;\n    return (px / maximumDigitWidth) - (Math.floor(128 / maximumDigitWidth) / 256);\n}\n\nfunction toHeight(px) {\n    return px * 0.75;\n}\n\nfunction stripFunnyChars(value) {\n    return String(value)\n        .replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g, \"\") // leave CRLF in\n        .replace(/\\r?\\n/g, \"\\r\\n\");                   // make sure LF is preceded by CR\n}\n\nvar Worksheet = function Worksheet(options, sharedStrings, styles, borders) {\n      this.options = options;\n      this._strings = sharedStrings;\n      this._styles = styles;\n      this._borders = borders;\n      this._validations = {};\n      this._comments = [];\n      this._drawings = options.drawings || [];\n      this._hyperlinks = (this.options.hyperlinks || []).map(\n          function (link, i) { return Object.assign({}, link, { rId: (\"link\" + i) }); });\n  };\n\n  Worksheet.prototype.relsToXML = function relsToXML () {\n      var hyperlinks = this._hyperlinks;\n      var comments = this._comments;\n      var drawings = this._drawings;\n\n      if (hyperlinks.length || comments.length || drawings.length) {\n          return WORKSHEET_RELS({\n              hyperlinks : hyperlinks,\n              comments : comments,\n              sheetIndex : this.options.sheetIndex,\n              drawings : drawings\n          });\n      }\n  };\n\n  Worksheet.prototype.toXML = function toXML (index) {\n        var this$1 = this;\n\n      var mergeCells = this.options.mergedCells || [];\n      var rows = this.options.rows || [];\n      var data = inflate(rows, mergeCells);\n\n      this._readCells(data);\n\n      var autoFilter = this.options.filter;\n      var filter;\n      if (autoFilter && (typeof autoFilter.from === \"number\") && (typeof autoFilter.to === \"number\")) {\n          // Grid enables auto filter\n          autoFilter = {\n              from: ref(filterRowIndex(this.options), autoFilter.from),\n              to: ref(filterRowIndex(this.options), autoFilter.to)\n          };\n      } else if (autoFilter && autoFilter.ref && autoFilter.columns) {\n          // this is probably from the Spreadsheet\n          filter = autoFilter;\n          autoFilter = null;\n      }\n\n      var validations = [];\n      for (var i in this$1._validations) {\n          if (Object.prototype.hasOwnProperty.call(this$1._validations, i)) {\n              validations.push(this$1._validations[i]);\n          }\n      }\n\n      var defaultCellStyleId = null;\n      if (this.options.defaultCellStyle) {\n          defaultCellStyleId = this._lookupStyle(this.options.defaultCellStyle);\n      }\n\n      var freezePane = this.options.freezePane || {};\n      var defaults = this.options.defaults || {};\n      var lastRow = this.options.rows ? this._getLastRow() : 1;\n      var lastCol = this.options.rows ? this._getLastCol() : 1;\n\n      return WORKSHEET({\n          frozenColumns: this.options.frozenColumns || freezePane.colSplit,\n          frozenRows: this.options.frozenRows || freezePane.rowSplit,\n          columns: this.options.columns,\n          defaults: defaults,\n          data: data,\n          index: index,\n          mergeCells: mergeCells,\n          autoFilter: autoFilter,\n          filter: filter,\n          showGridLines: this.options.showGridLines,\n          hyperlinks: this._hyperlinks,\n          validations: validations,\n          defaultCellStyleId: defaultCellStyleId,\n          rtl: this.options.rtl !== undefined ? this.options.rtl : defaults.rtl,\n          legacyDrawing: this._comments.length ? (\"vml\" + (this.options.sheetIndex)) : null,\n          drawing: this._drawings.length ? (\"drw\" + (this.options.sheetIndex)) : null,\n          lastRow: lastRow,\n          lastCol: lastCol\n      });\n  };\n\n  Worksheet.prototype.commentsXML = function commentsXML () {\n      if (this._comments.length) {\n          return COMMENTS_XML({ comments: this._comments });\n      }\n  };\n\n  Worksheet.prototype.drawingsXML = function drawingsXML (images) {\n      if (this._drawings.length) {\n          var rels = {};\n          var main = this._drawings.map(function (drw) {\n              var ref = parseRef(drw.topLeftCell);\n              var img = rels[drw.image];\n              if (!img) {\n                  img = rels[drw.image] = {\n                      rId: (\"img\" + (drw.image)),\n                      target: images[drw.image].target\n                  };\n              }\n              return {\n                  col     : ref.col,\n                  colOffset : pixelsToExcel(drw.offsetX),\n                  row     : ref.row,\n                  rowOffset : pixelsToExcel(drw.offsetY),\n                  width   : pixelsToExcel(drw.width),\n                  height  : pixelsToExcel(drw.height),\n                  imageId : img.rId\n              };\n          });\n          return {\n              main: DRAWINGS_XML(main),\n              rels: DRAWINGS_RELS_XML(rels)\n          };\n      }\n  };\n\n  Worksheet.prototype.legacyDrawing = function legacyDrawing () {\n      if (this._comments.length) {\n          return LEGACY_DRAWING({ comments: this._comments });\n      }\n  };\n\n  Worksheet.prototype._lookupString = function _lookupString (value) {\n      var key = \"$\" + value;\n      var index = this._strings.indexes[key];\n      var result;\n\n      if (index !== undefined) {\n          result = index;\n      } else {\n          result = this._strings.indexes[key] = this._strings.uniqueCount;\n          this._strings.uniqueCount ++;\n      }\n\n      this._strings.count ++;\n\n      return result;\n  };\n\n  Worksheet.prototype._lookupStyle = function _lookupStyle (style) {\n      var json = JSON.stringify(style);\n\n      if (json === \"{}\") {\n          return 0;\n      }\n\n      var index = indexOf(json, this._styles);\n\n      if (index < 0) {\n          index = this._styles.push(json) - 1;\n      }\n\n      // There is one default style\n      return index + 1;\n  };\n\n  Worksheet.prototype._lookupBorder = function _lookupBorder (border) {\n      var json = JSON.stringify(border);\n      if (json === \"{}\") {\n          return;\n      }\n\n      var index = indexOf(json, this._borders);\n      if (index < 0) {\n          index = this._borders.push(json) - 1;\n      }\n\n      // There is one default border\n      return index + 1;\n  };\n\n  Worksheet.prototype._readCells = function _readCells (rowData) {\n        var this$1 = this;\n\n      for (var i = 0; i < rowData.length; i++) {\n          var row = rowData[i];\n          var cells = row.cells;\n\n          row.data = [];\n\n          for (var j = 0; j < cells.length; j++) {\n              var cellData = this$1._cell(cells[j], row.index, j);\n              if (cellData) {\n                  row.data.push(cellData);\n              }\n          }\n      }\n  };\n\n  Worksheet.prototype._cell = function _cell (data, rowIndex, cellIndex) {\n      if (!data || data === EMPTY_CELL) {\n          return null;\n      }\n\n      var value = data.value;\n\n      var border = {};\n\n      if (data.borderLeft) {\n          border.left = data.borderLeft;\n      }\n\n      if (data.borderRight) {\n          border.right = data.borderRight;\n      }\n\n      if (data.borderTop) {\n          border.top = data.borderTop;\n      }\n\n      if (data.borderBottom) {\n          border.bottom = data.borderBottom;\n      }\n\n      border = this._lookupBorder(border);\n\n      var defStyle = this.options.defaultCellStyle || {};\n      var style = { borderId: border };\n\n      (function(add) {\n          add(\"color\");\n          add(\"background\");\n          add(\"bold\");\n          add(\"italic\");\n          add(\"underline\");\n          if (!add(\"fontFamily\")) { add(\"fontName\", \"fontFamily\"); }\n          add(\"fontSize\");\n          add(\"format\");\n          if (!add(\"textAlign\")) { add(\"hAlign\", \"textAlign\"); }\n          if (!add(\"verticalAlign\")) { add(\"vAlign\", \"verticalAlign\"); }\n          add(\"wrap\");\n          add(\"indent\");\n      })(\n          function(prop, target) {\n              var val = data[prop];\n              if (val === undefined) {\n                  val = defStyle[prop];\n              }\n              if (val !== undefined) {\n                  style[target || prop] = val;\n                  return true;\n              }\n          }\n      );\n\n      var columns = this.options.columns || [];\n\n      var column = columns[cellIndex];\n      var type = typeof value;\n\n      if (column && column.autoWidth && (!data.colSpan || data.colSpan === 1)) {\n          var displayValue = value;\n\n          // XXX: let's not bring kendo.toString in only for this.\n          //    better wait until the spreadsheet engine is available as a separate\n          //    component, then we can use a real Excel-like formatter.\n          //\n          if (type === \"number\") {\n              // kendo.toString will not behave exactly like the Excel format\n              // Still, it's the best we have available for estimating the character count.\n              displayValue = IntlService.toString(value, data.format);\n          }\n\n          column.width = Math.max(column.width || 0, String(displayValue).length);\n      }\n\n      if (type === \"string\") {\n          value = stripFunnyChars(value);\n          value = this._lookupString(value);\n          type = \"s\";\n      } else if (type === \"number\") {\n          type = \"n\";\n      } else if (type === \"boolean\") {\n          type = \"b\";\n          value = Number(value);\n      } else if (value && value.getTime) {\n          type = null;\n          value = dateToSerial(value);\n          if (!style.format) {\n              style.format = \"mm-dd-yy\";\n          }\n      } else {\n          type = null;\n          value = null;\n      }\n\n      style = this._lookupStyle(style);\n\n      var cellName = ref(rowIndex, cellIndex);\n\n      if (data.validation) {\n          this._addValidation(data.validation, cellName);\n      }\n\n      if (data.comment) {\n          var anchor = [\n              cellIndex + 1,// start column\n              15,           // start column offset\n              rowIndex,     // start row\n              10,           // start row offset\n              cellIndex + 3,// end column\n              15,           // end column offset\n              rowIndex + 3, // end row\n              4             // end row offset\n          ];\n          this._comments.push({\n              ref  : cellName,\n              text : data.comment,\n              row  : rowIndex,\n              col  : cellIndex,\n              anchor : anchor.join(\", \")\n          });\n      }\n\n      return {\n          value: value,\n          formula: data.formula,\n          type: type,\n          style: style,\n          ref: cellName\n      };\n  };\n\n  Worksheet.prototype._addValidation = function _addValidation (v, ref) {\n      var tmp = {\n          showErrorMessage : v.type === \"reject\" ? 1 : 0,\n          formula1       : v.from,\n          formula2       : v.to,\n          type           : MAP_EXCEL_TYPE[v.dataType] || v.dataType,\n          operator       : MAP_EXCEL_OPERATOR[v.comparerType] || v.comparerType,\n          allowBlank     : v.allowNulls ? 1 : 0,\n          showDropDown   : v.showButton ? 0 : 1, // LOL, Excel!\n          error          : v.messageTemplate,\n          errorTitle     : v.titleTemplate\n      };\n      var json = JSON.stringify(tmp);\n      if (!this._validations[json]) {\n          this._validations[json] = tmp;\n          tmp.sqref = [];\n      }\n      this._validations[json].sqref.push(ref);\n  };\n\n  Worksheet.prototype._getLastRow = function _getLastRow () {\n      return countData(this.options.rows);\n  };\n\n  Worksheet.prototype._getLastCol = function _getLastCol () {\n      var last = 0;\n      this.options.rows.forEach(function(row) {\n          if (row.cells) {\n              last = Math.max(last, countData(row.cells));\n          }\n      });\n      return last;\n  };\n\nfunction countData(data) {\n    var last = data.length;\n    data.forEach(function(el) {\n        if (el.index && el.index >= last) {\n            last = el.index + 1;\n        }\n    });\n    return last;\n}\n\nvar MAP_EXCEL_OPERATOR = {\n    // includes only what differs; key is our operator, value is Excel\n    // operator.\n    greaterThanOrEqualTo : \"greaterThanOrEqual\",\n    lessThanOrEqualTo    : \"lessThanOrEqual\"\n};\n\nvar MAP_EXCEL_TYPE = {\n    number: \"decimal\"\n};\n\nvar defaultFormats = {\n    \"General\": 0,\n    \"0\": 1,\n    \"0.00\": 2,\n    \"#,##0\": 3,\n    \"#,##0.00\": 4,\n    \"0%\": 9,\n    \"0.00%\": 10,\n    \"0.00E+00\": 11,\n    \"# ?/?\": 12,\n    \"# ??/??\": 13,\n    \"mm-dd-yy\": 14,\n    \"d-mmm-yy\": 15,\n    \"d-mmm\": 16,\n    \"mmm-yy\": 17,\n    \"h:mm AM/PM\": 18,\n    \"h:mm:ss AM/PM\": 19,\n    \"h:mm\": 20,\n    \"h:mm:ss\": 21,\n    \"m/d/yy h:mm\": 22,\n    \"#,##0 ;(#,##0)\": 37,\n    \"#,##0 ;[Red](#,##0)\": 38,\n    \"#,##0.00;(#,##0.00)\": 39,\n    \"#,##0.00;[Red](#,##0.00)\": 40,\n    \"mm:ss\": 45,\n    \"[h]:mm:ss\": 46,\n    \"mmss.0\": 47,\n    \"##0.0E+0\": 48,\n    \"@\": 49,\n    \"[$-404]e/m/d\": 27,\n    \"m/d/yy\": 30,\n    \"t0\": 59,\n    \"t0.00\": 60,\n    \"t#,##0\": 61,\n    \"t#,##0.00\": 62,\n    \"t0%\": 67,\n    \"t0.00%\": 68,\n    \"t# ?/?\": 69,\n    \"t# ??/??\": 70\n};\n\nfunction convertColor(value) {\n    var color = value;\n    if (color.length < 6) {\n        color = color.replace(/(\\w)/g, function($0, $1) {\n            return $1 + $1;\n        });\n    }\n\n    color = color.substring(1).toUpperCase();\n\n    if (color.length < 8) {\n        color = \"FF\" + color;\n    }\n\n    return color;\n}\n\nvar Workbook = function Workbook(options) {\n      var this$1 = this;\n\n      this.options = options || {};\n      this._strings = {\n          indexes: {},\n          count: 0,\n          uniqueCount: 0\n      };\n      this._styles = [];\n      this._borders = [];\n      this._images = this.options.images;\n      this._imgId = 0;\n\n      this._sheets = map(this.options.sheets || [], function (options, i) {\n          options.defaults = this$1.options;\n          options.sheetIndex = i + 1;\n          return new Worksheet(options, this$1._strings, this$1._styles, this$1._borders);\n      });\n  };\n\n  Workbook.prototype.imageFilename = function imageFilename (mimeType) {\n      var id = ++this._imgId;\n      switch (mimeType) {\n        case \"image/jpg\":\n        case \"image/jpeg\":\n          return (\"image\" + id + \".jpg\");\n        case \"image/png\":\n          return (\"image\" + id + \".png\");\n        case \"image/gif\":\n          return (\"image\" + id + \".gif\");\n        default:\n          return (\"image\" + id + \".bin\"); // XXX: anything better to do here?\n      }\n  };\n\n  Workbook.prototype.toZIP = function toZIP () {\n        var this$1 = this;\n\n      var zip = createZip();\n\n      var docProps = zip.folder(\"docProps\");\n\n      docProps.file(\"core.xml\", CORE({\n          creator: this.options.creator || \"Kendo UI\",\n          lastModifiedBy: this.options.creator || \"Kendo UI\",\n          created: this.options.date || new Date().toJSON(),\n          modified: this.options.date || new Date().toJSON()\n      }));\n\n      var sheetCount = this._sheets.length;\n\n      docProps.file(\"app.xml\", APP({ sheets: this._sheets }));\n\n      var rels = zip.folder(\"_rels\");\n      rels.file(\".rels\", RELS);\n\n      var xl = zip.folder(\"xl\");\n\n      var xlRels = xl.folder(\"_rels\");\n      xlRels.file(\"workbook.xml.rels\", WORKBOOK_RELS({ count: sheetCount }));\n\n      if (this._images) {\n          var media = xl.folder(\"media\");\n          Object.keys(this._images).forEach(function (id) {\n              var img = this$1._images[id];\n              var filename = this$1.imageFilename(img.type);\n              media.file(filename, img.data);\n              img.target = \"../media/\" + filename;\n          });\n      }\n\n      var sheetIds = {};\n      xl.file(\"workbook.xml\", WORKBOOK({\n          sheets: this._sheets,\n          filterNames: map(this._sheets, function(sheet, index) {\n              var options = sheet.options;\n              var sheetName = (options.name || options.title || \"Sheet\" + (index + 1));\n              sheetIds[sheetName.toLowerCase()] = index;\n              var filter = options.filter;\n              if (filter) {\n                  if (filter.ref) {\n                      // spreadsheet provides `ref`\n                      var a = filter.ref.split(\":\");\n                      var from = parseRef(a[0]);\n                      var to = parseRef(a[1]);\n                      return {\n                          localSheetId: index,\n                          name: sheetName,\n                          from: $ref(from.row, from.col),\n                          to: $ref(to.row, to.col)\n                      };\n                  } else if (typeof filter.from !== \"undefined\" && typeof filter.to !== \"undefined\") {\n                      // grid does this\n                      return {\n                          localSheetId: index,\n                          name: sheetName,\n                          from: $ref(filterRowIndex(options), filter.from),\n                          to: $ref(filterRowIndex(options), filter.to)\n                      };\n                  }\n              }\n          }),\n          userNames: map(this.options.names || [], function(def) {\n              return {\n                  name: def.localName,\n                  localSheetId: def.sheet ? sheetIds[def.sheet.toLowerCase()] : null,\n                  value: def.value,\n                  hidden: def.hidden\n              };\n          })\n      }));\n\n      var worksheets = xl.folder(\"worksheets\");\n      var drawings = xl.folder(\"drawings\");\n      var drawingsRels = drawings.folder(\"_rels\");\n      var sheetRels = worksheets.folder(\"_rels\");\n      var commentFiles = [];\n      var drawingFiles = [];\n\n      for (var idx = 0; idx < sheetCount; idx++) {\n          var sheet = this$1._sheets[idx];\n          var sheetName = \"sheet\" + (idx + 1) + \".xml\";\n          var sheetXML = sheet.toXML(idx); // must be called before relsToXML\n          var relsXML = sheet.relsToXML();\n          var commentsXML = sheet.commentsXML();\n          var legacyDrawing = sheet.legacyDrawing();\n          var drawingsXML = sheet.drawingsXML(this$1._images);\n\n          if (relsXML) {\n              sheetRels.file(sheetName + \".rels\", relsXML);\n          }\n          if (commentsXML) {\n              var name = \"comments\" + (sheet.options.sheetIndex) + \".xml\";\n              xl.file(name, commentsXML);\n              commentFiles.push(name);\n          }\n          if (legacyDrawing) {\n              drawings.file((\"vmlDrawing\" + (sheet.options.sheetIndex) + \".vml\"), legacyDrawing);\n          }\n          if (drawingsXML) {\n              var name$1 = \"drawing\" + (sheet.options.sheetIndex) + \".xml\";\n              drawings.file(name$1, drawingsXML.main);\n              drawingsRels.file((name$1 + \".rels\"), drawingsXML.rels);\n              drawingFiles.push(name$1);\n          }\n\n          worksheets.file(sheetName, sheetXML);\n      }\n\n      var borders = map(this._borders, parseJSON);\n\n      var styles = map(this._styles, parseJSON);\n\n      var hasFont = function(style) {\n          return style.underline || style.bold || style.italic || style.color || style.fontFamily || style.fontSize;\n      };\n\n      var convertFontSize = function(value) {\n          var fontInPx = Number(value);\n          var fontInPt;\n\n          if (fontInPx) {\n              fontInPt = fontInPx * 3 / 4;\n          }\n\n          return fontInPt;\n      };\n\n      var fonts = map(styles, function(style) {\n          if (style.fontSize) {\n              style.fontSize = convertFontSize(style.fontSize);\n          }\n\n          if (style.color) {\n              style.color = convertColor(style.color);\n          }\n\n          if (hasFont(style)) {\n              return style;\n          }\n      });\n\n      var formats = map(styles, function(style) {\n          if (style.format && defaultFormats[style.format] === undefined) {\n              return style;\n          }\n      });\n\n      var fills = map(styles, function(style) {\n          if (style.background) {\n              style.background = convertColor(style.background);\n              return style;\n          }\n      });\n\n      xl.file(\"styles.xml\", STYLES({\n          fonts: fonts,\n          fills: fills,\n          formats: formats,\n          borders: borders,\n          styles: map(styles, function(style) {\n              var result = {};\n\n              if (hasFont(style)) {\n                  result.fontId = indexOf(style, fonts) + 1;\n              }\n\n              if (style.background) {\n                  result.fillId = indexOf(style, fills) + 2;\n              }\n\n              result.textAlign = style.textAlign;\n              result.indent = style.indent;\n              result.verticalAlign = style.verticalAlign;\n              result.wrap = style.wrap;\n              result.borderId = style.borderId;\n\n              if (style.format) {\n                  if (defaultFormats[style.format] !== undefined) {\n                      result.numFmtId = defaultFormats[style.format];\n                  } else {\n                      result.numFmtId = 165 + indexOf(style, formats);\n                  }\n              }\n\n              return result;\n          })\n      }));\n\n      xl.file(\"sharedStrings.xml\", SHARED_STRINGS(this._strings));\n\n      zip.file(\"[Content_Types].xml\", CONTENT_TYPES({\n          sheetCount: sheetCount,\n          commentFiles: commentFiles,\n          drawingFiles: drawingFiles\n      }));\n\n      return zip;\n  };\n\n  Workbook.prototype.toDataURL = function toDataURL () {\n      var zip = this.toZIP();\n\n      return zip.generateAsync ? zip.generateAsync(DATA_URL_OPTIONS).then(toDataURI) : toDataURI(zip.generate(DATA_URL_OPTIONS));\n  };\n\n  Workbook.prototype.toBlob = function toBlob () {\n      var zip = this.toZIP();\n      if (zip.generateAsync) {\n          return zip.generateAsync(BLOB_OPTIONS);\n      }\n      return new Blob([ zip.generate(ARRAYBUFFER_OPTIONS) ], { type: MIME_TYPE });\n  };\n\nfunction borderStyle(width) {\n    var alias = \"thin\";\n\n    if (width === 2) {\n        alias = \"medium\";\n    } else if (width === 3) {\n        alias = \"thick\";\n    }\n\n    return alias;\n}\n\nfunction borderSideTemplate(name, style) {\n    var result = \"\";\n\n    if (style) {\n        result += \"<\" + name + \" style=\\\"\" + borderStyle(style.size) + \"\\\">\";\n        if (style.color) {\n            result += \"<color rgb=\\\"\" + convertColor(style.color) + \"\\\"/>\";\n        }\n        result += \"</\" + name + \">\";\n    }\n\n    return result;\n}\n\nfunction borderTemplate(border) {\n    return \"<border>\" +\n       borderSideTemplate(\"left\", border.left) +\n       borderSideTemplate(\"right\", border.right) +\n       borderSideTemplate(\"top\", border.top) +\n       borderSideTemplate(\"bottom\", border.bottom) +\n   \"</border>\";\n}\n\nvar EMPTY_CELL = {};\nfunction inflate(rows, mergedCells) {\n    var rowData = [];\n    var rowsByIndex = [];\n\n    indexRows(rows, function(row, index) {\n        var data = {\n            _source: row,\n            index: index,\n            height: row.height,\n            level: row.level,\n            cells: []\n        };\n\n        rowData.push(data);\n        rowsByIndex[index] = data;\n    });\n\n    var sorted = sortByIndex(rowData).slice(0);\n    var ctx = {\n        rowData: rowData,\n        rowsByIndex: rowsByIndex,\n        mergedCells: mergedCells\n    };\n\n    for (var i = 0; i < sorted.length; i++) {\n        fillCells(sorted[i], ctx);\n        delete sorted[i]._source;\n    }\n\n    return sortByIndex(rowData);\n}\n\nfunction indexRows(rows, callback) {\n    for (var i = 0; i < rows.length; i++) {\n        var row = rows[i];\n        if (!row) {\n            continue;\n        }\n\n        var index = row.index;\n        if (typeof index !== \"number\") {\n            index = i;\n        }\n\n        callback(row, index);\n    }\n}\n\nfunction sortByIndex(items) {\n    return items.sort(function(a, b) {\n        return a.index - b.index;\n    });\n}\n\nfunction pushUnique(array, el) {\n    if (array.indexOf(el) < 0) {\n        array.push(el);\n    }\n}\n\nfunction getSpan(mergedCells, ref) {\n    for (var i = 0; i < mergedCells.length; ++i) {\n        var range = mergedCells[i];\n        var a = range.split(\":\");\n        var topLeft = a[0];\n        if (topLeft === ref) {\n            var bottomRight = a[1];\n            topLeft = parseRef(topLeft);\n            bottomRight = parseRef(bottomRight);\n            return {\n                rowSpan: bottomRight.row - topLeft.row + 1,\n                colSpan: bottomRight.col - topLeft.col + 1\n            };\n        }\n    }\n}\n\nfunction parseRef(ref) {\n    function getcol(str) {\n        var upperStr = str.toUpperCase();\n        var col = 0;\n        for (var i = 0; i < upperStr.length; ++i) {\n            col = col * 26 + upperStr.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n\n    var m = /^([a-z]+)(\\d+)$/i.exec(ref);\n    return {\n        row: getrow(m[2]),\n        col: getcol(m[1])\n    };\n}\n\nfunction pixelsToExcel(px) {\n    return Math.round(px * 9525);\n}\n\nfunction fillCells(data, ctx) {\n    var row = data._source;\n    var rowIndex = data.index;\n    var cells = row.cells;\n    var cellData = data.cells;\n\n    if (!cells) {\n        return;\n    }\n\n    for (var i = 0; i < cells.length; i++) {\n        var cell = cells[i] || EMPTY_CELL;\n\n        var rowSpan = cell.rowSpan || 1;\n        var colSpan = cell.colSpan || 1;\n\n        var cellIndex = insertCell(cellData, cell);\n        var topLeftRef = ref(rowIndex, cellIndex);\n\n        if (rowSpan === 1 && colSpan === 1) {\n            // could still be merged: the spreadsheet does not send\n            // rowSpan/colSpan, but mergedCells is already populated.\n            // https://github.com/telerik/kendo-ui-core/issues/2401\n            var tmp = getSpan(ctx.mergedCells, topLeftRef);\n            if (tmp) {\n                colSpan = tmp.colSpan;\n                rowSpan = tmp.rowSpan;\n            }\n        }\n\n        spanCell(cell, cellData, cellIndex, colSpan);\n\n        if (rowSpan > 1 || colSpan > 1) {\n            pushUnique(ctx.mergedCells,\n                       topLeftRef + \":\" + ref(rowIndex + rowSpan - 1,\n                                              cellIndex + colSpan - 1));\n        }\n\n        if (rowSpan > 1) {\n            for (var ri = rowIndex + 1; ri < rowIndex + rowSpan; ri++) {\n                var nextRow = ctx.rowsByIndex[ri];\n                if (!nextRow) {\n                    nextRow = ctx.rowsByIndex[ri] = { index: ri, cells: [] };\n                    ctx.rowData.push(nextRow);\n                }\n\n                spanCell(cell, nextRow.cells, cellIndex - 1, colSpan + 1);\n            }\n        }\n    }\n}\n\nfunction insertCell(data, cell) {\n    var index;\n\n    if (typeof cell.index === \"number\") {\n        index = cell.index;\n        insertCellAt(data, cell, cell.index);\n    } else {\n        index = appendCell(data, cell);\n    }\n\n    return index;\n}\n\nfunction insertCellAt(data, cell, index) {\n    data[index] = cell;\n}\n\nfunction appendCell(data, cell) {\n    var index = data.length;\n\n    for (var i = 0; i < data.length + 1; i++) {\n        if (!data[i]) {\n            data[i] = cell;\n            index = i;\n            break;\n        }\n    }\n\n    return index;\n}\n\nfunction spanCell(cell, row, startIndex, colSpan) {\n    for (var i = 1; i < colSpan; i++) {\n        var tmp = {\n            borderTop    : cell.borderTop,\n            borderRight  : cell.borderRight,\n            borderBottom : cell.borderBottom,\n            borderLeft   : cell.borderLeft\n        };\n        insertCellAt(row, tmp, startIndex + i);\n    }\n}\n\nvar SPREADSHEET_FILTERS = function (ref$1) {\n  var ref = ref$1.ref;\n  var columns = ref$1.columns;\n  var generators = ref$1.generators;\n\n  return (\"\\n<autoFilter ref=\\\"\" + ref + \"\\\">\\n  \" + (foreach(columns, function (col) { return (\"\\n    <filterColumn colId=\\\"\" + (col.index) + \"\\\">\\n      \" + (generators[col.filter](col)) + \"\\n    </filterColumn>\\n  \"); })) + \"\\n</autoFilter>\");\n};\n\nvar SPREADSHEET_CUSTOM_FILTER = function (ref) {\n  var logic = ref.logic;\n  var criteria = ref.criteria;\n\n  return (\"\\n<customFilters \" + (logic === 'and' ? 'and=\"1\"' : '') + \">\\n\" + (foreach(criteria, function (f) {\n    var op = spreadsheetFilters.customOperator(f);\n    var val = spreadsheetFilters.customValue(f);\n    return (\"<customFilter \" + (op ? (\"operator=\\\"\" + op + \"\\\"\") : '') + \" val=\\\"\" + val + \"\\\"/>\");\n})) + \"\\n</customFilters>\");\n};\n\nvar SPREADSHEET_DYNAMIC_FILTER = function (ref) {\n  var type = ref.type;\n\n  return (\"<dynamicFilter type=\\\"\" + (spreadsheetFilters.dynamicFilterType(type)) + \"\\\" />\");\n};\n\nvar SPREADSHEET_TOP_FILTER = function (ref) {\n  var type = ref.type;\n  var value = ref.value;\n\n  return (\"<top10 percent=\\\"\" + (/percent$/i.test(type) ? 1 : 0) + \"\\\"\\n       top=\\\"\" + (/^top/i.test(type) ? 1 : 0) + \"\\\"\\n       val=\\\"\" + value + \"\\\" />\");\n};\n\nvar SPREADSHEET_VALUE_FILTER = function (ref) {\n    var blanks = ref.blanks;\n    var values = ref.values;\n\n    return (\"<filters \" + (blanks ? 'blank=\"1\"' : '') + \">\\n    \" + (foreach(values, function (value) { return (\"\\n      <filter val=\\\"\" + value + \"\\\" />\"); })) + \"\\n  </filters>\");\n};\n\nfunction spreadsheetFilters(filter) {\n    return SPREADSHEET_FILTERS({\n        ref: filter.ref,\n        columns: filter.columns,\n        generators: {\n            custom  : SPREADSHEET_CUSTOM_FILTER,\n            dynamic : SPREADSHEET_DYNAMIC_FILTER,\n            top     : SPREADSHEET_TOP_FILTER,\n            value   : SPREADSHEET_VALUE_FILTER\n        }\n    });\n}\n\nspreadsheetFilters.customOperator = function(f) {\n    return {\n        eq  : \"equal\",\n        gt  : \"greaterThan\",\n        gte : \"greaterThanOrEqual\",\n        lt  : \"lessThan\",\n        lte : \"lessThanOrEqual\",\n        ne  : \"notEqual\",\n\n        // These are not in the spec, but seems to be how Excel does\n        // it (see customValue below).  For the non-negated versions,\n        // the operator attribute is missing completely.\n        doesnotstartwith: \"notEqual\",\n        doesnotendwith: \"notEqual\",\n        doesnotcontain: \"notEqual\",\n        doesnotmatch: \"notEqual\"\n    }[f.operator.toLowerCase()];\n};\n\nfunction quoteSheet(name) {\n    if (/^\\'/.test(name)) { // assume already quoted, the Spreadsheet does it.\n        return name;\n    }\n    if (/^[a-z_][a-z0-9_]*$/i.test(name)) {\n        return name;        // no need to quote it\n    }\n    return \"'\" + name.replace(/\\x27/g, \"\\\\'\") + \"'\";\n}\n\nspreadsheetFilters.customValue = function(f) {\n    function esc(str) {\n        return str.replace(/([*?])/g, \"~$1\");\n    }\n\n    switch (f.operator.toLowerCase()) {\n        case \"startswith\":\n        case \"doesnotstartwith\":\n            return esc(f.value) + \"*\";\n\n        case \"endswith\":\n        case \"doesnotendwith\":\n            return \"*\" + esc(f.value);\n\n        case \"contains\":\n        case \"doesnotcontain\":\n            return \"*\" + esc(f.value) + \"*\";\n\n        default:\n            return f.value;\n    }\n};\n\nspreadsheetFilters.dynamicFilterType = function(type) {\n    return {\n        quarter1  : \"Q1\",\n        quarter2  : \"Q2\",\n        quarter3  : \"Q3\",\n        quarter4  : \"Q4\",\n        january   : \"M1\",\n        february  : \"M2\",\n        march     : \"M3\",\n        april     : \"M4\",\n        may       : \"M5\",\n        june      : \"M6\",\n        july      : \"M7\",\n        august    : \"M8\",\n        september : \"M9\",\n        october   : \"M10\",\n        november  : \"M11\",\n        december  : \"M12\"\n    }[type.toLowerCase()] || type;\n};\n\nexport {\n    Workbook,\n    Worksheet\n};\n"]},"metadata":{},"sourceType":"module"}