{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { saveAs } from '@progress/kendo-file-saver';\nimport { workbookOptions, toDataURL, isWorkbookOptions } from './ooxml/workbook';\nimport * as licensing from '@progress/kendo-licensing';\nimport { packageMetadata } from './package-metadata';\n\nvar ExcelExport =\n/** @class */\nfunction (_super) {\n  __extends(ExcelExport, _super);\n\n  function ExcelExport(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.saveFile = function (dataURL) {\n      saveAs(dataURL, _this.props.fileName, {\n        forceProxy: _this.props.forceProxy,\n        proxyURL: _this.props.proxyURL\n      });\n    };\n\n    _this.extractColumns = function (children, level) {\n      if (level === void 0) {\n        level = 0;\n      }\n\n      return Array.isArray(children) ? children.map(function (child) {\n        return _this.extractChild(child, level);\n      }) : [children, _this.extractChild(children, level)];\n    };\n\n    _this.extractChild = function (child, level) {\n      if (level === void 0) {\n        level = 0;\n      }\n\n      return React.isValidElement(child) ? __assign({}, child.props, {\n        width: child.props.width && parseInt(\"\" + child.props.width, 10),\n        level: level,\n        children: child.props.children && _this.extractColumns(child.props.children, level + 1)\n      }) : __assign({}, child, {\n        level: level,\n        children: child.children && _this.extractColumns(child.children, level + 1)\n      });\n    };\n\n    _this.getExportData = function (exportData) {\n      var result;\n\n      if (exportData) {\n        if (Array.isArray(exportData)) {\n          result = {\n            data: exportData\n          };\n        } else {\n          result = exportData;\n        }\n      } else {\n        result = {\n          data: _this.props.data,\n          group: _this.props.group\n        };\n      }\n\n      return result;\n    };\n\n    if (typeof licensing !== 'undefined') {\n      licensing.validatePackage(packageMetadata);\n    } else {\n      var message = \"License activation failed for \" + packageMetadata.name + \"\\n\";\n      message += 'The @progress/kendo-licensing script is not loaded.\\n';\n      message += \"See \" + packageMetadata.licensingDocsUrl + \" for more information.\\n\";\n      console.warn(message);\n    }\n\n    _this.save = _this.save.bind(_this);\n    _this.toDataURL = _this.toDataURL.bind(_this);\n    _this.workbookOptions = _this.workbookOptions.bind(_this);\n    return _this;\n  }\n  /**\n   * Saves the data to Excel.\n   *\n   * @param exportData - An optional parameter. Can be the data that will be exported or the [`WorkbookOptions`]({% slug api_excel-export_workbookoptions %}).\n   * @param columns - An optional parameter. If present, it will be used instead of the columns prop or the child column components.\n   */\n\n\n  ExcelExport.prototype.save = function (exportData, columns) {\n    var _this = this;\n\n    this.toDataURL(exportData, columns).then(function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (_this.props.onExportComplete) {\n        _this.props.onExportComplete.call(undefined, {\n          target: _this\n        });\n      }\n\n      _this.saveFile.apply(_this, args);\n    });\n  };\n  /**\n   * Returns a promise which will be resolved with the file data URI.\n   *\n   * @param exportData - The optional data or the [`WorkbookOptions`]({% slug api_excel-export_workbookoptions %}) that will be used to generate the data URI.\n   * @param externalColumns - The optional columns that will be used.\n   * @returns {Promise<string>} - The promise that will be resolved by the file data URI.\n   */\n\n\n  ExcelExport.prototype.toDataURL = function (exportData, columns) {\n    var options = isWorkbookOptions(exportData) ? exportData : this.workbookOptions(exportData, columns);\n    return toDataURL(options);\n  };\n  /**\n   * Based on the specified columns and data, returns [`WorkbookOptions`]({% slug api_excel-export_workbookoptions %}).\n   *\n   * @param exportData - The optional data that will be exported.\n   * @param externalColumns - The optional columns that will be used.\n   * @returns {WorkbookOptions} - The workbook options.\n   */\n  // tslint:enable:max-line-length\n\n\n  ExcelExport.prototype.workbookOptions = function (exportData, externalColumns) {\n    var currentData = this.getExportData(exportData);\n    var children = this.props.children;\n    var gridColumns = children && children.type && children.type.displayName === 'KendoReactGrid' && children.props && React.Children.toArray(children.props.children);\n    var columns = this.extractColumns(gridColumns || externalColumns || this.props.columns || React.Children.toArray(children));\n    var options = workbookOptions({\n      columns: columns,\n      data: currentData.data,\n      group: currentData.group,\n      filterable: this.props.filterable,\n      creator: this.props.creator,\n      date: this.props.date,\n      dir: this.props.dir,\n      hierarchy: this.props.hierarchy,\n      paddingCellOptions: this.props.paddingCellOptions,\n      headerPaddingCellOptions: this.props.headerPaddingCellOptions\n    });\n    return options;\n  };\n  /**\n   * @hidden\n   */\n\n\n  ExcelExport.prototype.render = function () {\n    return this.props.children || null;\n  };\n  /**\n   * @hidden\n   */\n\n\n  ExcelExport.propTypes = {\n    children: PropTypes.any,\n    columns: PropTypes.arrayOf(PropTypes.any),\n    creator: PropTypes.string,\n    data: PropTypes.any,\n    date: PropTypes.any,\n    filterable: PropTypes.bool,\n    fileName: PropTypes.string,\n    forceProxy: PropTypes.bool,\n    group: PropTypes.any,\n    headerPaddingCellOptions: PropTypes.any,\n    paddingCellOptions: PropTypes.any,\n    proxyURL: PropTypes.string,\n    dir: PropTypes.string,\n    hierarchy: PropTypes.bool,\n    collapsible: PropTypes.bool\n  };\n  /**\n   * @hidden\n   */\n\n  ExcelExport.defaultProps = {\n    fileName: 'Export.xlsx',\n    forceProxy: false,\n    collapsible: false\n  };\n  return ExcelExport;\n}(React.Component);\n\nexport default ExcelExport;","map":{"version":3,"sources":["C:/Users/pramod.katiyar/Documents/Project-git-download/nodeReactfrontend-main/node_modules/@progress/kendo-react-excel-export/dist/es/ExcelExport.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","React","PropTypes","saveAs","workbookOptions","toDataURL","isWorkbookOptions","licensing","packageMetadata","ExcelExport","_super","props","_this","saveFile","dataURL","fileName","forceProxy","proxyURL","extractColumns","children","level","isArray","map","child","extractChild","isValidElement","width","parseInt","getExportData","exportData","result","data","group","validatePackage","message","name","licensingDocsUrl","console","warn","save","bind","columns","then","args","_i","onExportComplete","undefined","target","options","externalColumns","currentData","gridColumns","type","displayName","Children","toArray","filterable","creator","date","dir","hierarchy","paddingCellOptions","headerPaddingCellOptions","render","propTypes","any","arrayOf","string","bool","collapsible","defaultProps","Component"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { saveAs } from '@progress/kendo-file-saver';\nimport { workbookOptions, toDataURL, isWorkbookOptions } from './ooxml/workbook';\nimport * as licensing from '@progress/kendo-licensing';\nimport { packageMetadata } from './package-metadata';\nvar ExcelExport = /** @class */ (function (_super) {\n    __extends(ExcelExport, _super);\n    function ExcelExport(props) {\n        var _this = _super.call(this, props) || this;\n        _this.saveFile = function (dataURL) {\n            saveAs(dataURL, _this.props.fileName, {\n                forceProxy: _this.props.forceProxy,\n                proxyURL: _this.props.proxyURL\n            });\n        };\n        _this.extractColumns = function (children, level) {\n            if (level === void 0) { level = 0; }\n            return Array.isArray(children)\n                ? children.map(function (child) {\n                    return _this.extractChild(child, level);\n                })\n                : [children, _this.extractChild(children, level)];\n        };\n        _this.extractChild = function (child, level) {\n            if (level === void 0) { level = 0; }\n            return React.isValidElement(child)\n                ? __assign({}, child.props, { width: child.props.width && parseInt(\"\" + child.props.width, 10), level: level, children: child.props.children\n                        && _this.extractColumns(child.props.children, level + 1) }) : __assign({}, child, { level: level, children: child.children && _this.extractColumns(child.children, level + 1) });\n        };\n        _this.getExportData = function (exportData) {\n            var result;\n            if (exportData) {\n                if (Array.isArray(exportData)) {\n                    result = {\n                        data: exportData\n                    };\n                }\n                else {\n                    result = exportData;\n                }\n            }\n            else {\n                result = {\n                    data: _this.props.data,\n                    group: _this.props.group\n                };\n            }\n            return result;\n        };\n        if (typeof licensing !== 'undefined') {\n            licensing.validatePackage(packageMetadata);\n        }\n        else {\n            var message = \"License activation failed for \" + packageMetadata.name + \"\\n\";\n            message += 'The @progress/kendo-licensing script is not loaded.\\n';\n            message += \"See \" + packageMetadata.licensingDocsUrl + \" for more information.\\n\";\n            console.warn(message);\n        }\n        _this.save = _this.save.bind(_this);\n        _this.toDataURL = _this.toDataURL.bind(_this);\n        _this.workbookOptions = _this.workbookOptions.bind(_this);\n        return _this;\n    }\n    /**\n     * Saves the data to Excel.\n     *\n     * @param exportData - An optional parameter. Can be the data that will be exported or the [`WorkbookOptions`]({% slug api_excel-export_workbookoptions %}).\n     * @param columns - An optional parameter. If present, it will be used instead of the columns prop or the child column components.\n     */\n    ExcelExport.prototype.save = function (exportData, columns) {\n        var _this = this;\n        this.toDataURL(exportData, columns)\n            .then(function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            if (_this.props.onExportComplete) {\n                _this.props.onExportComplete.call(undefined, { target: _this });\n            }\n            _this.saveFile.apply(_this, args);\n        });\n    };\n    /**\n     * Returns a promise which will be resolved with the file data URI.\n     *\n     * @param exportData - The optional data or the [`WorkbookOptions`]({% slug api_excel-export_workbookoptions %}) that will be used to generate the data URI.\n     * @param externalColumns - The optional columns that will be used.\n     * @returns {Promise<string>} - The promise that will be resolved by the file data URI.\n     */\n    ExcelExport.prototype.toDataURL = function (exportData, columns) {\n        var options = isWorkbookOptions(exportData)\n            ? exportData\n            : this.workbookOptions(exportData, columns);\n        return toDataURL(options);\n    };\n    /**\n     * Based on the specified columns and data, returns [`WorkbookOptions`]({% slug api_excel-export_workbookoptions %}).\n     *\n     * @param exportData - The optional data that will be exported.\n     * @param externalColumns - The optional columns that will be used.\n     * @returns {WorkbookOptions} - The workbook options.\n     */\n    // tslint:enable:max-line-length\n    ExcelExport.prototype.workbookOptions = function (exportData, externalColumns) {\n        var currentData = this.getExportData(exportData);\n        var children = this.props.children;\n        var gridColumns = children && children.type &&\n            children.type.displayName === 'KendoReactGrid' &&\n            children.props && React.Children.toArray(children.props.children);\n        var columns = this.extractColumns(gridColumns ||\n            externalColumns ||\n            this.props.columns ||\n            React.Children.toArray(children));\n        var options = workbookOptions({\n            columns: columns,\n            data: currentData.data,\n            group: currentData.group,\n            filterable: this.props.filterable,\n            creator: this.props.creator,\n            date: this.props.date,\n            dir: this.props.dir,\n            hierarchy: this.props.hierarchy,\n            paddingCellOptions: this.props.paddingCellOptions,\n            headerPaddingCellOptions: this.props.headerPaddingCellOptions\n        });\n        return options;\n    };\n    /**\n     * @hidden\n     */\n    ExcelExport.prototype.render = function () {\n        return this.props.children || null;\n    };\n    /**\n     * @hidden\n     */\n    ExcelExport.propTypes = {\n        children: PropTypes.any,\n        columns: PropTypes.arrayOf(PropTypes.any),\n        creator: PropTypes.string,\n        data: PropTypes.any,\n        date: PropTypes.any,\n        filterable: PropTypes.bool,\n        fileName: PropTypes.string,\n        forceProxy: PropTypes.bool,\n        group: PropTypes.any,\n        headerPaddingCellOptions: PropTypes.any,\n        paddingCellOptions: PropTypes.any,\n        proxyURL: PropTypes.string,\n        dir: PropTypes.string,\n        hierarchy: PropTypes.bool,\n        collapsible: PropTypes.bool\n    };\n    /**\n     * @hidden\n     */\n    ExcelExport.defaultProps = {\n        fileName: 'Export.xlsx',\n        forceProxy: false,\n        collapsible: false\n    };\n    return ExcelExport;\n}(React.Component));\nexport default ExcelExport;\n"]},"metadata":{},"sourceType":"module"}